/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */
!function(e,t,n){e[t]=n()}(this,"bowser",function(){function t(t){function n(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}function r(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}function N(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return undefined}}var i=n(/(ipod|iphone|ipad)/i).toLowerCase(),s=/like android/i.test(t),o=!s&&/android/i.test(t),u=/nexus\s*[0-6]\s*/i.test(t),a=!u&&/nexus\s*[0-9]+/i.test(t),f=/CrOS/.test(t),l=/silk/i.test(t),c=/sailfish/i.test(t),h=/tizen/i.test(t),p=/(web|hpw)os/i.test(t),d=/windows phone/i.test(t),v=/SamsungBrowser/i.test(t),m=!d&&/windows/i.test(t),g=!i&&!l&&/macintosh/i.test(t),y=!o&&!c&&!h&&!p&&/linux/i.test(t),b=n(/edge\/(\d+(\.\d+)?)/i),w=n(/version\/(\d+(\.\d+)?)/i),E=/tablet/i.test(t)&&!/tablet pc/i.test(t),S=!E&&/[^-]mobi/i.test(t),x=/xbox/i.test(t),T;/opera/i.test(t)?T={name:"Opera",opera:e,version:w||n(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr|opios/i.test(t)?T={name:"Opera",opera:e,version:n(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||w}:/SamsungBrowser/i.test(t)?T={name:"Samsung Internet for Android",samsungBrowser:e,version:w||n(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(t)?T={name:"Opera Coast",coast:e,version:w||n(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(t)?T={name:"Yandex Browser",yandexbrowser:e,version:w||n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?T={name:"UC Browser",ucbrowser:e,version:n(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?T={name:"Maxthon",maxthon:e,version:n(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?T={name:"Epiphany",epiphany:e,version:n(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?T={name:"Puffin",puffin:e,version:n(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?T={name:"Sleipnir",sleipnir:e,version:n(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?T={name:"K-Meleon",kMeleon:e,version:n(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:d?(T={name:"Windows Phone",windowsphone:e},b?(T.msedge=e,T.version=b):(T.msie=e,T.version=n(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?T={name:"Internet Explorer",msie:e,version:n(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:f?T={name:"Chrome",chromeos:e,chromeBook:e,chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(t)?T={name:"Microsoft Edge",msedge:e,version:b}:/vivaldi/i.test(t)?T={name:"Vivaldi",vivaldi:e,version:n(/vivaldi\/(\d+(\.\d+)?)/i)||w}:c?T={name:"Sailfish",sailfish:e,version:n(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?T={name:"SeaMonkey",seamonkey:e,version:n(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(T={name:"Firefox",firefox:e,version:n(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(T.firefoxos=e)):l?T={name:"Amazon Silk",silk:e,version:n(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?T={name:"PhantomJS",phantom:e,version:n(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?T={name:"SlimerJS",slimer:e,version:n(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?T={name:"BlackBerry",blackberry:e,version:w||n(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:p?(T={name:"WebOS",webos:e,version:w||n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(T.touchpad=e)):/bada/i.test(t)?T={name:"Bada",bada:e,version:n(/dolfin\/(\d+(\.\d+)?)/i)}:h?T={name:"Tizen",tizen:e,version:n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||w}:/qupzilla/i.test(t)?T={name:"QupZilla",qupzilla:e,version:n(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||w}:/chromium/i.test(t)?T={name:"Chromium",chromium:e,version:n(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||w}:/chrome|crios|crmo/i.test(t)?T={name:"Chrome",chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:o?T={name:"Android",version:w}:/safari|applewebkit/i.test(t)?(T={name:"Safari",safari:e},w&&(T.version=w)):i?(T={name:i=="iphone"?"iPhone":i=="ipad"?"iPad":"iPod"},w&&(T.version=w)):/googlebot/i.test(t)?T={name:"Googlebot",googlebot:e,version:n(/googlebot\/(\d+(\.\d+))/i)||w}:T={name:n(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!T.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(T.name=T.name||"Blink",T.blink=e):(T.name=T.name||"Webkit",T.webkit=e),!T.version&&w&&(T.version=w)):!T.opera&&/gecko\//i.test(t)&&(T.name=T.name||"Gecko",T.gecko=e,T.version=T.version||n(/gecko\/(\d+(\.\d+)?)/i)),!T.windowsphone&&!T.msedge&&(o||T.silk)?T.android=e:!T.windowsphone&&!T.msedge&&i?(T[i]=e,T.ios=e):g?T.mac=e:x?T.xbox=e:m?T.windows=e:y&&(T.linux=e);var C="";T.windows?C=N(n(/Windows ((NT|XP)( \d\d?.\d)?)/i)):T.windowsphone?C=n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):T.mac?(C=n(/Mac OS X (\d+([_\.\s]\d+)*)/i),C=C.replace(/[_\s]/g,".")):i?(C=n(/os (\d+([_\s]\d+)*) like mac os x/i),C=C.replace(/[_\s]/g,".")):o?C=n(/android[ \/-](\d+(\.\d+)*)/i):T.webos?C=n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):T.blackberry?C=n(/rim\stablet\sos\s(\d+(\.\d+)*)/i):T.bada?C=n(/bada\/(\d+(\.\d+)*)/i):T.tizen&&(C=n(/tizen[\/\s](\d+(\.\d+)*)/i)),C&&(T.osversion=C);var k=!T.windows&&C.split(".")[0];if(E||a||i=="ipad"||o&&(k==3||k>=4&&!S)||T.silk)T.tablet=e;else if(S||i=="iphone"||i=="ipod"||o||u||T.blackberry||T.webos||T.bada)T.mobile=e;return T.msedge||T.msie&&T.version>=10||T.yandexbrowser&&T.version>=15||T.vivaldi&&T.version>=1||T.chrome&&T.version>=20||T.samsungBrowser&&T.version>=4||T.firefox&&T.version>=20||T.safari&&T.version>=6||T.opera&&T.version>=10||T.ios&&T.osversion&&T.osversion.split(".")[0]>=6||T.blackberry&&T.version>=10.1||T.chromium&&T.version>=20?T.a=e:T.msie&&T.version<10||T.chrome&&T.version<20||T.firefox&&T.version<20||T.safari&&T.version<6||T.opera&&T.version<10||T.ios&&T.osversion&&T.osversion.split(".")[0]<6||T.chromium&&T.version<20?T.c=e:T.x=e,T}function r(e){return e.split(".").length}function i(e,t){var n=[],r;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function s(e){var t=Math.max(r(e[0]),r(e[1])),n=i(e,function(e){var n=t-r(e);return e+=(new Array(n+1)).join(".0"),i(e.split("."),function(e){return(new Array(20-e.length)).join("0")+e}).reverse()});while(--t>=0){if(n[0][t]>n[1][t])return 1;if(n[0][t]!==n[1][t])return-1;if(t===0)return 0}}function o(e,r,i){var o=n;typeof r=="string"&&(i=r,r=void 0),r===void 0&&(r=!1),i&&(o=t(i));var u=""+o.version;for(var a in e)if(e.hasOwnProperty(a)&&o[a]){if(typeof e[a]!="string")throw new Error("Browser version in the minVersion map should be a string: "+a+": "+String(e));return s([u,e[a]])<0}return r}function u(e,t,n){return!o(e,t,n)}var e=!0,n=t(typeof navigator!="undefined"?navigator.userAgent||"":"");return n.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if(typeof r=="string"&&r in n)return!0}return!1},n.isUnsupportedBrowser=o,n.compareVersions=s,n.check=u,n._detect=t,n});
/* 
* !pulse-sdk-html5 v2.1.19.4.0 | client-side HTML5 SDK 2.x
* Copyright (c) 2019 by Ooyala, www.ooyala.com 
* email: info@ooyala.com 
*/ 
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(window,a){var b,c={adrequest:{},adresponse:{},tracking:{}};if(window.OO){if(window.OO.Pulse)return;b=window.OO}else b={};!function(a){a.adresponse.Session=function(){if(!(this instanceof a.adresponse.Session))return new a.adresponse.Session;this.id="",this.language="",this.trackingEvents={},this.insertionPoints=[],this.secure=!1}}(c),function(a){a.adresponse.InsertionPoint=function(){if(!(this instanceof a.adresponse.InsertionPoint))return new a.adresponse.InsertionPoint;this.parentSession=null,this.conditions=[],this.slots=[]},a.adresponse.InsertionPoint.isReady=function(a){for(var b,c=0;c<a.slots.length;++c){b=a.slots[c];for(var d=0;d<b.ads.length;++d)if(!b.ads[d].ready)return!1}return!0},a.adresponse.InsertionPoint.maximumPreparationTime=function(a){for(var b,c,d=0,e=0;e<a.slots.length;++e){b=a.slots[e];for(var f=0;f<b.ads.length;++f)c=b.ads[f],d+=c.maximumPreparationTime}return d}}(c),function(a){a.adresponse.Slot=function(){if(!(this instanceof a.adresponse.Slot))return new a.adresponse.Slot;this.parentInsertionPoint=null,this.trackingEvents={},this.ads=[]}}(c),function(b){b.adresponse.EventCondition=function(){if(!(this instanceof b.adresponse.EventCondition))return new b.adresponse.EventCondition;this.type=a,this.conditions=[]},b.adresponse.EventCondition.ConditionName={ON_BEFORE_CONTENT:"onBeforeContent",ON_CONTENT_END:"onContentEnd",ON_PAUSE:"onPause"}}(c),function(b){b.adresponse.PropertyCondition=function(){if(!(this instanceof b.adresponse.PropertyCondition))return new b.adresponse.PropertyCondition;this.type=a,this.operator=a,this.value=a,this.conditions=[]},b.adresponse.PropertyCondition.Operator={EQ:"eq",GEQ:"geq"},b.adresponse.PropertyCondition.ConditionName={PLAYBACK_POSITION:"playbackPosition",TIME_SINCE_LINEAR:"timeSinceLinear",PLAYBACK_TIME:"playbackTime"}}(c),function(a){a.adresponse.Companion=function(){if(!(this instanceof a.adresponse.Companion))return new a.adresponse.Companion;this.id="",this.customId="",this.parentAd=null,this.sequence=0,this.width=0,this.height=0,this.trackingEvents={},this.resources=[],this.required=a.adresponse.Companion.RequiredRule.NO,this.zone=""},a.adresponse.Companion.RequiredRule={YES:"yes",AT_LEAST_ONE_FOR_THIS_SEQUENCE:"atLeastOne",NO:"no"}}(c),function(b){b.adresponse.Ad=function(){if(!(this instanceof b.adresponse.Ad))return new b.adresponse.Ad;this.id="",this.title="",this.description="",this.advertiser="",this.customId="",this.goalId="",this.customGoalId="",this.campaignId="",this.customCampaignId="",this.parentSlot=null,this.allowLinearityToChange=!1,this.partOfAnExclusiveCampaign=!1,this.showCountdown=!1,this.type=a,this.variant=a,this.maximumPreparationTime=0,this.startTimeout=0,this.thirdPartyURL="",this.thirdPartyChain=[],this.survey="",this.trackingEvents={},this.creatives=[],this.companions=[],this.ads=[],this.ready=!1,this.labels={},this.conditional=null,this.categories=[],this.verifications=[],this.pricing=null},b.adresponse.Ad.hasPassback=function(a){return a.ready&&a.type!==b.adresponse.Ad.AdType.SPOT_SELECTOR&&a.ads.length>0},b.adresponse.Ad.AdType={INVENTORY:"inventory",SPOT_STANDARD:"spot_standard",SPOT_INTERACTIVE:"spot_interactive",SPOT_SELECTOR:"spot_selector",SPOT_TAKEOVER:"spot_takeover",SPOT_IPTV:"spot_iptv",OVERLAY_STANDARD:"overlay_standard",OVERLAY_VIDEO:"overlay_video",OVERLAY_IMAGESET:"overlay_imageset",OVERLAY_SPLASH:"overlay_splash",SPLASH_STANDARD:"splash_standard",SKIN_INSKIN:"skin_inskin"},b.adresponse.Ad.Variant={NORMAL:"normal",SPONSOR:"sponsor"}}(c),function(b){b.adresponse.LinearCreative=function(){return function(){if(!(this instanceof b.adresponse.LinearCreative))return new b.adresponse.LinearCreative;this.parentAd=null,this.clickThroughUrl="",this.duration=a,this.sequence=0,this.type="",this.trackingEvents={},this.skipOffset=a,this.skipButtonMode=a,this.lastCompletion=a,this.skipResetTime=a,this.mediaFiles=[],this.adParameters="",this.universalAdId=null}}(),b.adresponse.LinearCreative.SkipButtonMode={ALWAYS:"always",NEVER:"never",AFTER_FIRST_COMPLETION:"after_first_completion"}}(c),function(b){b.adresponse.NonLinearCreative=function(){return function(){if(!(this instanceof b.adresponse.NonLinearCreative))return new b.adresponse.NonLinearCreative;this.parentAd=null,this.duration=a,this.sequence=0,this.width=0,this.height=0,this.type="",this.trackingEvents={},this.resources=[]}}()}(c),function(b){b.adresponse.MediaFile=function(){if(!(this instanceof b.adresponse.MediaFile))return new b.adresponse.MediaFile;this.apiFramework=a,this.adParameters=a,this.bitRate=0,this.deliveryMethod=a,this.height=0,this.mimeType="",this.width=0,this.url=""},b.adresponse.MediaFile.DeliveryMethod={PROGRESSIVE:"progressive",STREAMING:"streaming"},b.adresponse.MediaFile.ApiFramework={VPAID:"VPAID"}}(c),function(a){a.adresponse.HtmlResource=function(){this.source=""}}(c),function(a){a.adresponse.IFrameResource=function(){this.url=""}}(c),function(b){b.adresponse.StaticResource=function(){this.adParameters=a,this.adParametersXmlEncoded=a,this.apiFramework=a,this.assetWidth=a,this.assetHeight=a,this.expandedWidth=a,this.expandedHeight=a,this.clickThroughUrl=a,this.mimeType=a,this.url=""},b.adresponse.StaticResource.ApiFramework={VPAID:"VPAID",CLICK_TAG:"clickTAG"}}(c),function(a){a.adrequest.URLBuilder=function(){function c(a){return a&&a.hasOwnProperty("callerVersion")?a.callerVersion:"h5_"+window.videoplaza.versionNumber}function d(b,d,k,l,m){try{e(k),f(l)}catch(B){throw B}var n=b;if(-1===n.indexOf("http://")&&-1===n.indexOf("https://")&&(n="http://"+n),n.lastIndexOf("/")!==n.length-1&&(n+="/"),n+="proxy/distributor/v2?",n+="rt=vp_3.0",n+="&pf=html5",n+="&cv="+c(l),k){k.hasOwnProperty("flags")&&k.flags.length>0&&(n+="&f="+encodeURIComponent(k.flags.join(","))),k.hasOwnProperty("tags")&&k.tags.length>0&&(n+="&t="+encodeURIComponent(k.tags.join(",")));var o="";if(k.hasOwnProperty("category")&&k.category.length>0&&(o+=k.category),k.hasOwnProperty("contentPartner")&&k.contentPartner&&(o=o?o+=","+k.contentPartner:k.contentPartner),o&&(n+="&s="+encodeURIComponent(o)),k.hasOwnProperty("contentForm")&&k.contentForm&&(n+="&cf="+g(k.contentForm)),k.hasOwnProperty("id")&&k.id&&(n+="&ci="+encodeURIComponent(k.id)),k.hasOwnProperty("duration")&&k.duration&&(n+="&cd="+k.duration),k.hasOwnProperty("customParameters")&&Object.keys(k.customParameters).length>0){var p=/[^A-Za-z0-9_~\-.]/;for(var q in k.customParameters)k.customParameters.hasOwnProperty(q)&&!p.test(q)&&(n+="&cp."+q+"="+encodeURIComponent(k.customParameters[q]))}if(k.hasOwnProperty("contentProviderInformation")&&k.contentProviderInformation){var r=k.contentProviderInformation;r.pcode&&(n+="&opc="+r.pcode),r.embedCode&&(n+="&oec="+r.embedCode)}}if(l){"boolean"==typeof l.enableGdpr&&(n+="&gdpr="+(l.enableGdpr?1:0)),"string"==typeof l.gdprConsentString&&l.gdprConsentString.length>0&&-1===l.gdprConsentString.indexOf(" ")&&(n+="&gdpr_consent="+encodeURIComponent(l.gdprConsentString)),"boolean"==typeof l.gdprPersonalDataIncluded&&(n+="&gdpr_pd="+(l.gdprPersonalDataIncluded?1:0)),l.hasOwnProperty("startAdTimeout")&&l.startAdTimeout&&(n+="&sat="+l.startAdTimeout),l.hasOwnProperty("thirdPartyTimeout")&&l.thirdPartyTimeout&&(n+="&tpt="+l.thirdPartyTimeout),l.hasOwnProperty("totalPassbackTimeout")&&l.totalPassbackTimeout&&(n+="&tpat="+l.totalPassbackTimeout),l.hasOwnProperty("width")&&l.width&&(n+="&vwt="+l.width),l.hasOwnProperty("pulse_preview")&&l.pulse_preview&&(n+="&vppreview="+l.pulse_preview),l.hasOwnProperty("height")&&l.height&&(n+="&vht="+l.height),l.hasOwnProperty("maxBitRate")&&l.maxBitRate&&(n+="&vbw="+l.maxBitRate),l.hasOwnProperty("linearSlotSize")&&l.linearSlotSize&&(n+="&pp="+l.linearSlotSize,n+="&mp="+l.linearSlotSize,n+="&pop="+l.linearSlotSize);var s=!1,t=!1;if(l.hasOwnProperty("insertionPointFilter")&&l.insertionPointFilter.length>0){for(var u=[],v=0;v<l.insertionPointFilter.length;v++)try{u.push(i(l.insertionPointFilter[v])),l.insertionPointFilter[v]===a.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION?(s=!0,l.hasOwnProperty("linearPlaybackPositions")&&l.linearPlaybackPositions.length>0&&(t=!0),l.hasOwnProperty("nonlinearPlaybackPositions")&&l.nonlinearPlaybackPositions.length>0&&u.push("o")):l.insertionPointFilter[v]===a.adrequest.AdRequester.InsertionPointType.ON_BEFORE_CONTENT&&(t=!0)}catch(B){}t&&u.push("s"),u=u.filter(function(a,b,c){return c.indexOf(a)==b}),n+="&tt="+u.join(",")}else s=!0;s&&(l.hasOwnProperty("linearPlaybackPositions")&&l.linearPlaybackPositions.length>0&&(n+="&bp="+encodeURIComponent(l.linearPlaybackPositions.join(","))),l.hasOwnProperty("nonlinearPlaybackPositions")&&l.nonlinearPlaybackPositions.length>0&&(n+="&obp="+encodeURIComponent(l.nonlinearPlaybackPositions.join(","))));var w;if(!s&&l.hasOwnProperty("linearPlaybackPositions")&&l.linearPlaybackPositions.length>0&&(w=new a.LogItem,w.message="linearPlaybackPositions provided, but insertionPointFilter excludes PLAYBACK_POSITION. No linear insertion points will be requested for the given playback positions.",w.source=a.LogItem.SourceType.SESSION,w.event=a.LogItem.EventType.WARNING,m(w)),!s&&l.hasOwnProperty("nonlinearPlaybackPositions")&&l.nonlinearPlaybackPositions.length>0&&(w=new a.LogItem,w.message="nonlinearPlaybackPositions provided, but insertionPointFilter excludes PLAYBACK_POSITION. No nonlinear insertion points will be requested for the given playback positions.",w.source=a.LogItem.SourceType.SESSION,w.event=a.LogItem.EventType.WARNING,m(w)),l.hasOwnProperty("referrerUrl")&&l.referrerUrl&&(n+="&ru="+encodeURIComponent(l.referrerUrl)),l.hasOwnProperty("maxLinearBreakDuration")&&l.maxLinearBreakDuration&&(n+="&tbbl="+l.maxLinearBreakDuration),l.hasOwnProperty("forceSiteId")&&l.forceSiteId&&(n+="&sid="+l.forceSiteId),l.hasOwnProperty("liveParameters"))if(a.adrequest.AdRequester.liveParameterEnabled=!0,0==l.liveParameters.length)n+="&live=on";else{for(var x=[],v=0;v<l.liveParameters.length;v++){var y=h(l.liveParameters[v]),z=x.includes(y);z||x.push(y)}x.length>0&&(n+="&live="+x.join(","))}}d&&d.hasOwnProperty("deviceContainer")&&d.deviceContainer&&(n+="&dcid="+encodeURIComponent(d.deviceContainer)),d&&d.hasOwnProperty("persistentId")&&d.persistentId&&(n+="&pid="+encodeURIComponent(d.persistentId));var A=j("vppreview");return A&&(n+="&vppreview="+A),n+="&xpb=1",n+="&st=20:1",n+="&rnd="+Math.floor(1e16*Math.random())}function e(b){var c={id:"",category:"",contentForm:"",contentPartner:"",duration:0,flags:[],tags:[],customParameters:{}};if(b){if(b.hasOwnProperty("id")){if("string"!=typeof b.id)throw new Error("InvalidType of contentMetadata.id, should be string but is "+_typeof(b.id));b.id&&(c.id=b.id)}if(b.hasOwnProperty("category")&&b.category){if("string"!=typeof b.category)throw new Error("InvalidType of property contentMetadata.category, should be string but is "+_typeof(b.category));c.category=b.category}if(b.hasOwnProperty("contentForm")){if("string"!=typeof b.contentForm)throw new Error("InvalidType of property contentMetadata.contentForm, should be string but is "+_typeof(b.contentForm));if(b.contentForm!==a.adrequest.AdRequester.ContentForm.SHORT_FORM&&b.contentForm!==a.adrequest.AdRequester.ContentForm.LONG_FORM)throw new Error("Invalid contentMetadata.contentForm Value");c.contentForm=b.contentForm}if(b.hasOwnProperty("contentPartner")&&b.contentPartner){if("string"!=typeof b.contentPartner)throw new Error("InvalidType of property contentMetadata.contentPartner, should be string but is "+_typeof(b.contentPartner));c.contentPartner=b.contentPartner}if(b.hasOwnProperty("duration")){if("number"!=typeof b.duration)throw new Error("InvalidType of property contentMetadata.duration, should be number but is "+_typeof(b.duration));if(!(b.duration>=0))throw new Error("contentMetadata.duration value must be 0 or greater, but is "+b.duration);c.duration=b.duration}if(b.hasOwnProperty("flags")){if("[object Array]"!==Object.prototype.toString.call(b.flags))throw new Error("InvalidType of contentMetadata.flags, should be Array but is "+Object.prototype.toString.call(b.flags));c.flags=b.flags}if(b.hasOwnProperty("tags")){if("[object Array]"!==Object.prototype.toString.call(b.tags))throw new Error("InvalidType of contentMetadata.tags, should be Array but is "+Object.prototype.toString.call(b.tags));c.tags=b.tags}if(b.hasOwnProperty("customParameters")){if("[object Object]"!==Object.prototype.toString.call(b.customParameters))throw new Error("InvalidType of contentMetadata.customParameters, should be Object but is "+Object.prototype.toString.call(b.customParameters));for(var d in b.customParameters){if(!d)throw new Error("Empty contentMetadata.customParameters key");if("string"!=typeof b.customParameters[d])throw new Error("InvalidType of contentMetadata.customParameters property "+d+". Should be string but is "+_typeof(b.customParameters[d]))}c.customParameters=b.customParameters}}return c}function f(b){var c,d,e={height:0,maxBitRate:0,referrerUrl:"",width:0,linearPlaybackPositions:[],nonlinearPlaybackPositions:[],insertionPointFilter:[]};if(b.hasOwnProperty("height")){if("number"!=typeof b.height)throw new Error("InvalidType of requestSettings.height, should be number but is "+_typeof(b.height));if(!(b.height>=0))throw new Error("Invalid value of requestSettings.height, must be larger than or equal to 0");e.height=b.height}if(b.hasOwnProperty("width")){if("number"!=typeof b.width)throw new Error("InvalidType of requestSettings.width, should be number but is "+_typeof(b.width));if(!(b.width>=0))throw new Error("Invalid value of requestSettings.width, must be larger than or equal to 0");e.width=b.width}if(b.hasOwnProperty("maxBitRate")){if("number"!=typeof b.maxBitRate)throw new Error("InvalidType of requestSettings.maxBitRate, should be number but is "+_typeof(b.maxBitRate));if(!(b.maxBitRate>=0))throw new Error("Invalid value of requestSettings.maxBitRate, must be larger than or equal to 0");e.maxBitRate=b.maxBitRate}if(b.hasOwnProperty("linearSlotSize")){if("number"!=typeof b.linearSlotSize)throw new Error("InvalidType of requestSettings.linearSlotSize, should be number but is "+_typeof(b.linearSlotSize));if(!(b.linearSlotSize>=0))throw new Error("Invalid value of requestSettings.linearSlotSize, must be larger than or equal to 0");e.linearSlotSize=b.linearSlotSize}if(b.hasOwnProperty("referrerUrl")){if("string"!=typeof b.referrerUrl)throw new Error("InvalidType of requestSettings.referrerUrl, should be string but is "+_typeof(b.referrerUrl));b.referrerUrl&&(e.referrerUrl=b.referrerUrl)}if(b.hasOwnProperty("linearPlaybackPositions")){if("[object Array]"!==Object.prototype.toString.call(b.linearPlaybackPositions))throw new Error("InvalidType of requestSettings.linearPlaybackPositions, should be [object Array] but is "+Object.prototype.toString.call(b.linearPlaybackPositions));if(b.linearPlaybackPositions.length>0)for(var f=0;f<b.linearPlaybackPositions.length;f++){if("number"!=typeof(c=b.linearPlaybackPositions[f])||c!==c)throw new Error("InvalidType of requestSettings.linearPlaybackPositions at index "+f+". Should be of type number but is "+_typeof(b.linearPlaybackPositions[f]));e.linearPlaybackPositions.push(b.linearPlaybackPositions[f])}}if(b.hasOwnProperty("nonlinearPlaybackPositions")){if("[object Array]"!==Object.prototype.toString.call(b.nonlinearPlaybackPositions))throw new Error("InvalidType of requestSettings.nonlinearPlaybackPositions, should be [object Array] but is "+Object.prototype.toString.call(b.nonlinearPlaybackPositions));if(b.nonlinearPlaybackPositions.length>0)for(var g=0;g<b.nonlinearPlaybackPositions.length;g++){if("number"!=typeof(d=b.nonlinearPlaybackPositions[g])||d!==d)throw new Error("InvalidType of requestSettings.nonlinearPlaybackPositions at index "+g+". Should be of type number but is "+_typeof(b.nonlinearPlaybackPositions[g]));e.nonlinearPlaybackPositions.push(b.nonlinearPlaybackPositions[g])}}if(b.hasOwnProperty("insertionPointFilter")){if("[object Array]"!==Object.prototype.toString.call(b.insertionPointFilter))throw new Error("Invalid type of requestSettings.insertionPointFilter, should be [object Array] but is "+Object.prototype.toString.call(b.insertionPointFilter));if(b.insertionPointFilter.length>0)for(var h=0;h<b.insertionPointFilter.length;h++){if("string"!=typeof b.insertionPointFilter[h])throw new Error("Invalid type of requestSettings.insertionPointFilter at index "+h+". Should be of type string but is "+_typeof(b.insertionPointFilter[h]));if(b.insertionPointFilter[h]!==a.adrequest.AdRequester.InsertionPointType.ON_BEFORE_CONTENT&&b.insertionPointFilter[h]!==a.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION&&b.insertionPointFilter[h]!==a.adrequest.AdRequester.InsertionPointType.ON_CONTENT_END&&b.insertionPointFilter[h]!==a.adrequest.AdRequester.InsertionPointType.ON_PAUSE&&b.insertionPointFilter[h]!==a.adrequest.AdRequester.InsertionPointType.PLAYBACK_TIME)throw new Error("Invalid Value of requestSettings.insertionPointFilter at index "+h+". Accepted values are onBeforeContent, playbackPosition, onContentEnd, onPause or playbackTime, but is "+b.insertionPointFilter[h]);e.insertionPointFilter.push(b.insertionPointFilter[h])}}if(b.hasOwnProperty("liveParameters")){if("[object Array]"!==Object.prototype.toString.call(b.liveParameters))throw new Error("Invalid type of requestSettings.liveParameters, should be [object Array] but is "+Object.prototype.toString.call(b.liveParameters));if(b.liveParameters.length>0)for(var h=0;h<b.liveParameters.length;h++){if("string"!=typeof b.liveParameters[h])throw new Error("Invalid type of requestSettings.liveParameters at index "+h+". Should be of type string but is "+_typeof(b.liveParameters[h]));if(b.liveParameters[h]!==a.adrequest.AdRequester.Live.DISABLE_ALL&&b.liveParameters[h]!==a.adrequest.AdRequester.Live.ALL_TRACKINGS&&b.liveParameters[h]!==a.adrequest.AdRequester.Live.SESSION_LOOKUP&&b.liveParameters[h]!==a.adrequest.AdRequester.Live.LOCATION_LOOKUP&&b.liveParameters[h]!==a.adrequest.AdRequester.Live.REAL_TIME_BIDDING)throw new Error("Invalid Value of requestSettings.liveParameters at index "+h+". Accepted values are disableAll, allTrackings, sessionLookup, locationLookup or playbackTime, but is "+b.liveParameters[h]);void 0===e.liveParameterss&&(e.liveParameters=[]),e.liveParameters.push(b.liveParameters[h])}}if(b.hasOwnProperty("maxLinearBreakDuration")){if("number"!=typeof b.maxLinearBreakDuration)throw new Error("Invalid type of requestSettings.maxLinearBreakDuration, should be number but is "+_typeof(b.maxLinearBreakDuration));if(!(b.maxLinearBreakDuration>=0))throw new Error("Invalid value of requestSettings.maxLinearBreakDuration, must be larger than or equal to 0");e.maxLinearBreakDuration=b.maxLinearBreakDuration}return e}function g(a){switch(a){case"longForm":return"long_form";case"shortForm":return"short_form"}}function h(c){switch(c){case b.Pulse.Live.DISABLE_ALL:return"on";case b.Pulse.Live.ALL_TRACKINGS:return a.adrequest.AdRequester.liveParameterEnabled=!1,"ust";case b.Pulse.Live.SESSION_LOOKUP:return"ses";case b.Pulse.Live.LOCATION_LOOKUP:return"loc";case b.Pulse.Live.REAL_TIME_BIDDING:return"rtb";default:return"on"}}function i(b){switch(b){case a.adrequest.AdRequester.InsertionPointType.ON_BEFORE_CONTENT:return"p";case a.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION:return"m";case a.adrequest.AdRequester.InsertionPointType.ON_CONTENT_END:return"po";case a.adrequest.AdRequester.InsertionPointType.ON_PAUSE:return"pa";case a.adrequest.AdRequester.InsertionPointType.PLAYBACK_TIME:return"o";default:throw new Error("InvalidInsertionPointType passed")}}function j(a){var b="",c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(window.location.href.toString());return null!==e&&(b=e[1]),b}var k=function(){this.log=function(){}};return k.prototype={setLogMethod:function(a){this.log=a},buildSessionRequestURL:function(a,b,c,e,f){var g=d(a,b,c,e,this.log);return f&&(g+="&tid="+encodeURIComponent(f.id)),g}},k}()}(c),function(c){function d(){b&&b.Pulse&&b.Pulse.Utils.log.apply(null,arguments)}c.adrequest.AdRequester=function(){function f(b,d){if(b===a||null===b)return!1;if(!b.hasOwnProperty("linearPlaybackPositions")||"[object Array]"!==Object.prototype.toString.call(b.linearPlaybackPositions)||0===b.linearPlaybackPositions.length)return!1;if(!b.hasOwnProperty("nonlinearPlaybackPositions")||"[object Array]"!==Object.prototype.toString.call(b.nonlinearPlaybackPositions)||0===b.nonlinearPlaybackPositions.length)return!1;for(var e=0;e<b.linearPlaybackPositions.length;++e)if(-1!==b.nonlinearPlaybackPositions.indexOf(b.linearPlaybackPositions[e])){var f=new c.LogItem;return f.source=c.LogItem.SourceType.SESSION,f.event=c.LogItem.EventType.ILLEGAL_OPERATION,f.message="Both linear and nonlinear ads requested for playback position "+b.linearPlaybackPositions[e]+", but only one type per position is allowed; request canceled",g(d,f),!0}return!1}function g(a,c){for(var d=0;d<a._logCallbacks.length;++d)a._logCallbacks[d](c);if(b&&b.Pulse){var error=c.message;c.errorCode&&(error+=" (VAST error code "+c.errorCode+")"),b.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],error)}}function h(a){return{enforceCacheBusting:!0===a._enforceCacheBusting,useVASTSkipOffset:!0===a._useVASTSkipOffset}}function i(a,b,c,d,e){var f={operation:a,list:b,context:c,step:function(){0===f.list.length?f.finish():f.operation(f.list.shift(),f.context,f.step,f.finish,f.cancel)},finish:d,cancel:e};f.step()}function j(a,e,f,h){if(!0!==e.cancelled&&!0!==e.adContext.cancelled&&!0!==e.adContext.sessionContext.sessionCancelled){var i=function(b){if(!0!==e.cancelled&&!0!==e.adContext.cancelled&&!0!==e.adContext.sessionContext.sessionCancelled){var i,j,k=new c.LogItem;try{d("Parsing VAST response from: ",a.thirdPartyURL),i=e.adContext.sessionContext.vastParser.parse(b)}catch(l){return j=l.hasOwnProperty("errorCode")?l.errorCode:"100",k.message="Could not parse third party ad: "+l.message,k.event=c.LogItem.EventType.INVALID_RESPONSE,k.thirdPartySourceURLs=a.thirdPartyChain.toString(),k.source=c.LogItem.SourceType.AD,k.errorCode=j,g(e.adContext.sessionContext.target,k),h.call(this,a,j),void(e.cancelled=!0)}i?("inventory"===i.type?(u.call(this,i,a),k.message="No ads VAST response.",k.event=c.LogItem.EventType.NO_AD_RESPONSE,k.thirdPartySourceURLs=i.thirdPartyChain.toString(),k.source=c.LogItem.SourceType.AD,k.errorCode="303",g(e.adContext.sessionContext.target,k),h(i,"303"),e.cancelled=!0):(u.call(this,i,a),setTimeout(function(){f(i)},0)),e.currentNode=i,e.adContext.currentChain=i):(setTimeout(function(){h(a,"900")},0),e.cancelled=!0)}}.bind(this),j=new c.HTTPRequester;a.thirdPartyChain.push(a.thirdPartyURL);var k=function(b){j.request(b,i,function(b){if(!0!==e.cancelled&&!0!==e.adContext.cancelled&&!0!==e.adContext.sessionContext.sessionCancelled){var d=new c.LogItem;d.message="Could not retrieve third party ad: "+b,d.event=c.LogItem.EventType.REQUEST_FAILED,d.thirdPartySourceURLs=a.thirdPartyChain.toString(),d.source=c.LogItem.SourceType.AD,d.errorCode="300",g(e.adContext.sessionContext.target,d),h(a,"300"),e.cancelled=!0}})};b&&b.Pulse&&b.Pulse.HTTPRequesterOverride&&b.Pulse.HTTPRequesterOverride.hasOwnProperty("overrideTicketRequestURL")?b.Pulse.HTTPRequesterOverride.overrideTicketRequestURL(a.thirdPartyURL,k,"thirdPartyAdRequest"):(!0===e.adContext.sessionContext.logPassbackURL&&b&&b.Pulse&&b.Pulse.Utils.log("Loading third party ad: "+a.thirdPartyURL),k(a.thirdPartyURL))}}function k(a,b,c,d){var e=function(a){k.call(this,a,b,c,d)};a.thirdPartyURL.length>0?j.call(this,a,b,e,d):(b.completed=!0,c(a))}function l(b,d,e,f){var h,i={adContext:d,cancelled:!1,completed:!1,currentNode:b},l=Date.now(),m=function(){if(!0!==i.completed&&!0!==i.cancelled&&!0!==i.adContext.cancelled&&!0!==i.adContext.sessionContext.sessionCancelled){i.cancelled=!0;var a=(Date.now()-l)/1e3,e=new c.LogItem;e.message="Could not retrieve third party ad: chain timed out after "+a+"s",e.event=c.LogItem.EventType.REQUEST_TIMEOUT,e.thirdPartySourceURLs=b.thirdPartyChain.toString(),e.source=c.LogItem.SourceType.AD,e.errorCode="301",g(d.sessionContext.target,e);for(var h=0;h<i.currentNode.creatives.length;++h)i.currentNode.creatives[h].trackingEvents={};f.call(this,i.currentNode,"301")}},n=function(a){clearTimeout(h),e.call(this,a)},o=function(a){k.call(this,a,i,n,f)}.bind(this);b.thirdPartyURL.length>0?(b.maximumPreparationTime!==a&&(h=setTimeout(m,1e3*b.maximumPreparationTime)),j.call(this,b,i,o,f)):(i.completed=!0,e.call(this,b))}function m(d,e,f,h,i){var j,k,m,n={sessionContext:e,cancelled:!1,completed:!1,currentChain:null},o=function(a,h,j){if(!0!==n.completed&&!0!==n.cancelled&&!0!==e.sessionCancelled){if(d.ads[0]&&d.ads[0].trackingEvents.report&&d.ads[0].trackingEvents.report.urls.length>0&&b&&b.Pulse&&b.Pulse._instance){var k="301"===a?"2":a;b.Pulse._instance._tracker.reportPulseError(d.ads[0],k)}var l=new c.LogItem;if(j||(l.message=h,l.event="301"===a?c.LogItem.EventType.REQUEST_TIMEOUT:c.LogItem.EventType.REQUEST_CANCELED,l.thirdPartySourceURLs=d.thirdPartyChain.toString(),l.source=c.LogItem.SourceType.AD,l.errorCode=a,g(e.target,l)),d.ready=!0,d.ads.length>=2){var m=d.ads[d.ads.length-1];d.ads=[],null!==n.currentChain&&w(n.currentChain,d,"error"),z(d,a);for(var o=0;o<d.creatives.length;++o)d.creatives[o].trackingEvents.urls=[];u(d,m,!1,!0),r.call(this,d,m),"inventory"===m.type&&(d.companions=[]),f()}else i("No passback candidates remaining");n.cancelled=!0}}.bind(this),p=function(a,b){o("900",a,b)},q=function(){var a=(Date.now()-k)/1e3;o("301","Could not retrieve third party ad: passback timed out after "+a+"s")},s=function(a){clearTimeout(m),n.completed=!0,u(d,a,!1,!0),r.call(this,d,j),d.ads.shift(),d.ready=!0,"inventory"===d.type&&(d.companions=[]),f.call(this)}.bind(this),t=function(a,c){d.ads[0]&&d.ads[0].trackingEvents.report&&d.ads[0].trackingEvents.report.urls.length>0&&b&&b.Pulse&&b.Pulse._instance&&b.Pulse._instance._tracker.reportPulseError(d.ads[0],c),d.ads.shift();for(var e=0;e<a.creatives.length;++e)a.creatives[e].trackingEvents={};a.thirdPartyChain.length=0,a.trackingEvents.hasOwnProperty("impression")&&(a.trackingEvents.impression.urls.length=0),d.ads.length>0?(u.call(this,d.ads[0],a,!0),z(d.ads[0],c),j=d.ads[0],l.call(this,j,n,s,t)):i("No passback candidates remaining")}.bind(this);return d.ready&&!1===e.skipLazyAds||!d.ready&&!0===e.skipLazyAds?f.call(this):e.skipLazyAds&&c.adresponse.Ad.hasPassback(d)||!d.ready?(d.maximumPreparationTime!==a&&(k=Date.now(),m=setTimeout(q,1e3*d.maximumPreparationTime)),n.currentChain=d.ads[0],j=d.ads[0],l.call(this,j,n,s,t)):f(),p}function n(a,b,c,d,e){var f=a.ads.slice(0);i(m.bind(this),f,b,c,e)}function o(a,b,c,d,e){var f=a.slots.slice(0);i(n.bind(this),f,b,c,e)}function p(a,b,d,e,f){var g=new c.adrequest.VASTParser(h(this)),j={target:a,vastParser:g,sessionCancelled:!1,skipLazyAds:f},k=function(){!1===j.sessionCancelled&&d.call(this,b)}.bind(this),l=function(){!1===j.sessionCancelled&&e(b)}.bind(this);return i(o,b.insertionPoints.slice(0),j,k,l),function(error){!1===j.sessionCancelled&&(j.sessionCancelled=!0,e(error))}}function q(a,b,d){for(var f,h,i,j,k=0,l=[],m=[],n=[],o=0;o<b.insertionPoints.length;++o)h=b.insertionPoints[o],h.conditions[0].type===c.adresponse.PropertyCondition.PLAYBACK_POSITION&&l.push(h.conditions[0].value);for(var p=0;p<a.insertionPoints.length;++p){if(i=a.insertionPoints[p],j=!1,i.conditions[0].type===c.adresponse.PropertyCondition.ConditionName.PLAYBACK_POSITION)++k,-1!==l.indexOf(i.conditions[0].value)&&(j=!0,m.push(i.conditions[0].value));else for(var o=0;o<b.insertionPoints.length;++o)if(h=b.insertionPoints[o],h.conditions[0].type===i.conditions[0].type){if(i.conditions[0].type===c.adresponse.EventCondition.ConditionName.ON_PAUSE){b.insertionPoints.splice(o,1);break}j=!0,n.push(i.conditions[0].type);break}j||b.insertionPoints.push(i)}k>0&&k===m.length&&n.push(c.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION);var q;if(n.length>0){for(var p=0;p<n.length;++p)e[n[p]]&&(n[p]=e[n[p]]);q=n.join(", "),f=new c.LogItem,f.source=c.LogItem.SourceType.SESSION,f.event=c.LogItem.EventType.WARNING,f.message="Some insertion point types were received, but not merged, as they already exist: "+q,g(d,f)}m.length>0&&(q=m.join(", "),f=new c.LogItem,f.source=c.LogItem.SourceType.SESSION,f.event=c.LogItem.EventType.WARNING,f.message="Some playback positions were received, but not merged, as they already exist: "+q,g(d,f))}function r(a,b){a.id=b.id,a.type=b.type,a.candidate=b.candidate,a.customId=b.customId,a.campaignId=b.campaignId,a.customCampaignId=b.customCampaignId,a.goalId=b.goalId,a.customGoalId=b.customGoalId,a.allowLinearityToChange=b.allowLinearityToChange,a.partOfAnExclusiveCampaign=b.partOfAnExclusiveCampaign,a.showCountdown=b.showCountdown,a.variant=b.variant;for(var c=0;c<b.creatives.length;++c)s.call(this,a.creatives[c],b.creatives[c])}function s(a,b){a.type=b.type,a.sequence=b.sequence,!0!==this._useVASTSkipOffset&&(a.skipOffset=b.skipOffset,a.skipResetTime=b.skipResetTime,a.skipButtonMode=b.skipButtonMode),a.lastCompletion=b.lastCompletion}function t(a,b){a.duration=b.duration,a.clickThroughUrl=b.clickThroughUrl,a.adParameters=b.adParameters,a.universalAdId=b.universalAdId,a.skipOffset=b.skipOffset,a.skipResetTime=b.skipResetTime,a.skipButtonMode=b.skipButtonMode}function u(a,b,d,e){if(a!==b){a.thirdPartyURL&&0===a.creatives.length&&a.creatives.push(new c.adresponse.LinearCreative);for(var f=0;f<b.thirdPartyChain.length;++f)a.thirdPartyChain.push(b.thirdPartyChain[f]);if(d?(v(b,"error"),v(b,"impression")):(v(a,"error"),v(a,"impression")),w(b,a),"inventory"!==a.type){for(var g=0;g<b.creatives.length;++g){var h=a.creatives[g],i=b.creatives[g];w(i,h);for(var j=0;j<i.mediaFiles.length;++j)h.mediaFiles.push(y(i.mediaFiles[j]));e&&t(h,i)}for(var j=0;j<b.companions.length;++j)b.companions[j].targetAd=a,a.companions.push(b.companions[j]);e?(a.title=b.title,a.pricing=b.pricing,a.verifications=b.verifications,a.categories=b.categories,a.conditional=b.conditional,a.description=b.description,a.advertiser=b.advertiser):a.pricing||(a.pricing=b.pricing)}}}function v(a,b){if(a.trackingEvents.hasOwnProperty(b)){for(var c,d=[],e=0;e<a.trackingEvents[b].urls.length;++e)c=a.trackingEvents[b].urls[e],c.thirdParty&&d.push(c);a.trackingEvents[b].urls=d}}function w(a,b,c){if(b)for(var d,e=Object.keys(a.trackingEvents),f=0;f<e.length;++f)if(d=e[f],(!c||d===c)&&a.trackingEvents.hasOwnProperty(d))if("progress"!==d)if(b.trackingEvents.hasOwnProperty(d)||(b.trackingEvents[d]={urls:[],blocked:!1}),"report"===d&&a.trackingEvents.hasOwnProperty("report")&&0==b.trackingEvents.report.urls.length)b.trackingEvents.report.urls=a.trackingEvents.report.urls;else for(var g,h=0;h<a.trackingEvents[d].urls.length;++h)g=a.trackingEvents[d].urls[h],b.trackingEvents[d].urls.push(g);else x(a.trackingEvents.progress,b)}function x(a,b){var c,d=Object.keys(a);b.trackingEvents.hasOwnProperty("progress")||(b.trackingEvents.progress={});for(var e=b.trackingEvents.progress,f=0;f<d.length;++f){c=d[f],e.hasOwnProperty(c)||(e[c]={urls:[],blocked:!1});for(var g,h=0;h<a[c].urls.length;++h)g=a[c].urls[h],e[c].urls.push(g)}}function y(a){var b=new c.adresponse.MediaFile;return b.apiFramework=a.apiFramework,b.bitRate=a.bitRate,b.deliveryMethod=a.deliveryMethod,b.height=a.height,b.id=a.id,b.mimeType=a.mimeType,b.url=a.url,b.width=a.width,b}function z(a,b){a.trackingEvents.hasOwnProperty("error")||(a.trackingEvents.error={urls:[],blocked:!1});for(var c=a.trackingEvents.error.urls,d=0;d<c.length;++d)c[d].thirdParty&&(b&&(c[d].url=c[d].url.replace(E,encodeURIComponent(b))),a.trackingEvents.hasOwnProperty("impression")||(a.trackingEvents.impression={urls:[],blocked:!1}),a.trackingEvents.impression.urls.push({url:c[d].url,thirdParty:!0}))}function A(a){
return 0===a.toLowerCase().indexOf("https")}function B(a){return/(^(http|https)\:\/\/)?([a-z0-9\-]+)\.([a-z0-9\-]+)\.[a-z]+/i.test(a)}var C=!1,D=function h(i,j){if(!(this instanceof c.adrequest.AdRequester))return new h(i,j);if(!B(i)){var k=new Error("Argument vpHost invalid or missing");throw k.name="Invalid_Arguments",k}if(this._vpHost=i,!(j&&j instanceof Object))throw new Error("Argument adRequesterSettings invalid or missing");this._logCallbacks=[],j=JSON.parse(JSON.stringify(j)),j.hasOwnProperty("persistentId")?this._pid=j.persistentId:this._pid=a;var l=this,m=function(e,h,m,n,o){C=!1,e||(e={}),h||(h={});var q=!1;if(h&&h.hasOwnProperty("pulse_preview")&&(q=h.pulse_preview),!1===h.enforceCacheBusting?this._enforceCacheBusting=!1:this._enforceCacheBusting=!0,!0===h.useVASTSkipOffset?this._useVASTSkipOffset=!0:this._useVASTSkipOffset=!1,this._seekMode=b.Pulse.SeekMode.IGNORE,h.seekMode)switch(h.seekMode){case b.Pulse.SeekMode.IGNORE:case b.Pulse.SeekMode.PLAY_FIRST:case b.Pulse.SeekMode.PLAY_LAST:case b.Pulse.SeekMode.PLAY_ALL:this._seekMode=h.seekMode;break;default:d("Ignoring unknown seek mode '"+h.seekMode+"'")}this._gdpr_consent=a,this._gdpr=a,this._gdpr_pd=a,"boolean"==typeof h.gdprPersonalDataIncluded&&(this._gdpr_pd=h.gdprPersonalDataIncluded),"boolean"==typeof h.enableGdpr&&(this._gdpr=h.enableGdpr),"string"==typeof h.gdprConsentString&&_typeof(h.gdprConsentString.length)>0&&(this._gdpr_consent=h.gdprConsentString.trim());var r;if(!m)return r=new c.LogItem,r.message="Required parameter missing: 'onSuccess' callback",r.event=c.LogItem.EventType.INVALID_ARGUMENT,r.source=c.LogItem.SourceType.SESSION,g(this,r),function(){};if(!n)return r=new c.LogItem,r.message="Required parameter missing: 'onFail' callback",r.event=c.LogItem.EventType.INVALID_ARGUMENT,r.source=c.LogItem.SourceType.SESSION,g(this,r),function(){};var s=null,t=!1,u=new c.HTTPRequester,v=function(){},w=function(){},x=!1,y=function(a){var d=new c.LogItem;d.source=c.LogItem.SourceType.SESSION,t?(d.message="Session request canceled: "+a,d.event=c.LogItem.EventType.REQUEST_CANCELED):(d.message="Session request failed: "+a+" URL: "+s,d.event=c.LogItem.EventType.REQUEST_FAILED),g(l,d),window.OO&&b.Pulse&&b.Pulse.SessionRequestFailedCallback&&s?b.Pulse.SessionRequestFailedCallback(s,a,z,n):n(o?o:a)},z=function(a){x=!0;var b,d,e=new c.adrequest.VPTP3Parser(q);try{b=JSON.parse(a)}catch(k){throw new Error("Unable to parse VPTP Ticket, malformed JSON data: "+k.message)}try{d=e.parse(b),d.secure=A(i)&&!j.ignoreSecure,d.seekMode=this._seekMode}catch(h){var f=new c.LogItem;return f.message=h.message,f.event=c.LogItem.EventType.INVALID_RESPONSE,f.source=c.LogItem.SourceType.SESSION,g(l,f),void n(h.message)}v=p.call(this,l,d,m,y,!0)}.bind(this),B=function(error){t=!0,!1===x?w(error):v(error)};if(function(){return h&&h.hasOwnProperty("vptpTicketData")&&h.vptpTicketData}())return setTimeout(z,0,h.vptpTicketData),function(){};if(f(h,this))return setTimeout(function(){n(o?o:"Incompatible request settings")},0),function(){};try{var D=new c.adrequest.URLBuilder;D.setLogMethod(function(a){g(this,a)}.bind(this)),s=D.buildSessionRequestURL(i,j,e,h,o);var E=function(a){w=u.request(a,z,y)};window.OO&&b.Pulse&&b.Pulse.HTTPRequesterOverride&&b.Pulse.HTTPRequesterOverride.hasOwnProperty("overrideTicketRequestURL")?b.Pulse.HTTPRequesterOverride.overrideTicketRequestURL(s,E,"firstPartyAdRequest"):E(s)}catch(F){return r=new c.LogItem,r.message=F.message,r.event=c.LogItem.EventType.INVALID_ARGUMENT,r.source=c.LogItem.SourceType.SESSION,g(this,r),n(F.message),null}return B}.bind(this);this.requestSession=function(a,b,c,d){return m.call(this,a,b,c,d)},this.requestSessionExtension=function(d,h,i,j){var k;if(null===d||d===a||!(d instanceof c.adresponse.Session))return k=new c.LogItem,k.source=c.LogItem.SourceType.SESSION,k.event=c.LogItem.EventType.INVALID_ARGUMENT,k.message=d?"Invalid type: only Session accepted for argument 'session'":"Required parameter missing: 'session'",g(this,k),function(){};if(null===i||i===a)return k=new c.LogItem,k.source=c.LogItem.SourceType.SESSION,k.event=c.LogItem.EventType.INVALID_ARGUMENT,k.message="Required parameter missing: 'requestSettings'",g(this,k),function(){};if(null===j||j===a)return k=new c.LogItem,k.source=c.LogItem.SourceType.SESSION,k.event=c.LogItem.EventType.INVALID_ARGUMENT,k.message="Required parameter missing: 'onComplete' callback",g(this,k),function(){};var n=[],o=[],p=[],r=[];if(!i.hasOwnProperty("insertionPointFilter")||i.hasOwnProperty("insertionPointFilter")&&0===i.insertionPointFilter.length){for(var s in c.adrequest.AdRequester.InsertionPointType)n.push(c.adrequest.AdRequester.InsertionPointType[s]);o.push(c.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION)}else{n=n.concat(i.insertionPointFilter);for(var t=0;t<n.length;++t)if(n[t]===c.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION){o.push(c.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION);break}}var u,v,w=[],x=[];if(i.linearPlaybackPositions)for(var y=0;y<i.linearPlaybackPositions.length;++y){u=!0;for(var t=0;t<d.insertionPoints.length;++t)if(v=d.insertionPoints[t],v.conditions[0].type===c.adresponse.PropertyCondition.ConditionName.PLAYBACK_POSITION&&v.conditions[0].value===i.linearPlaybackPositions[y]){u=!1,x.push(i.linearPlaybackPositions[y]);break}u&&p.push(i.linearPlaybackPositions[y])}if(i.nonlinearPlaybackPositions)for(var y=0;y<i.nonlinearPlaybackPositions.length;++y){u=!0;for(var t=0;t<d.insertionPoints.length;++t)if(v=d.insertionPoints[t],v.conditions[0].type===c.adresponse.PropertyCondition.ConditionName.PLAYBACK_POSITION&&v.conditions[0].value===i.nonlinearPlaybackPositions[y]){u=!1,x.push(i.nonlinearPlaybackPositions[y]);break}u&&r.push(i.nonlinearPlaybackPositions[y])}if(f(i,this))return setTimeout(function(){j(d)},0),function(){};for(var z=0;z<n.length;++z){var A=n[z],B=!0;if(A!==c.adrequest.AdRequester.InsertionPointType.ON_PAUSE){for(var C=0;C<d.insertionPoints.length;C++)if(v=d.insertionPoints[C],v.conditions[0].type===A&&A!==c.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION){w.push(A),B=!1;break}B&&A!==c.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION&&o.push(A)}else o.push(A)}var D;if(w.length>0){for(var t=0;t<w.length;++t)e[w[t]]&&(w[t]=e[w[t]]);D=w.join(", "),k=new c.LogItem,k.source=c.LogItem.SourceType.SESSION,k.event=c.LogItem.EventType.WARNING,k.message="Some insertion point types were excluded from the request, as they already exist: "+D,g(this,k)}if(x.length>0&&(D=x.join(", "),k=new c.LogItem,k.source=c.LogItem.SourceType.SESSION,k.event=c.LogItem.EventType.WARNING,k.message="Some playback positions were excluded from the request, as they already exist: "+D,g(this,k)),0===p.length&&0===r.length&&(o=o.filter(function(a,b,d){return a!==c.adrequest.AdRequester.InsertionPointType.PLAYBACK_POSITION})),o.length>0){var E=function(a){if(a.id!==d.id)return k=new c.LogItem,k.source=c.LogItem.SourceType.SESSION,k.event=c.LogItem.EventType.ILLEGAL_OPERATION,k.message="The request response's session id does not match; unmodified session returned",g(l,k),void j(d);q(a,d,l),j(d)},F=JSON.parse(JSON.stringify(i));F.insertionPointFilter=o,i&&(F.linearPlaybackPositions=p,F.nonlinearPlaybackPositions=r);var G=function(error){b&&b.Pulse&&b.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],error),j(d)};return m.call(this,h,F,E,G,d)}return k=new c.LogItem,k.source=c.LogItem.SourceType.SESSION,k.event=c.LogItem.EventType.ILLEGAL_OPERATION,k.message="None of the provided insertion point types and/or playback positions can be requested again; unmodified session returned",g(this,k),setTimeout(function(){j(d)},0),function(){}}};D.prototype.addLogListener=function(a){a&&"[object Function]"==Object.prototype.toString.call(a)&&this._logCallbacks.push(a)},D.prototype.requestThirdParty=function(b,d){var e;if(b instanceof c.adresponse.InsertionPoint)e=!0;else{if(!(b instanceof c.adresponse.Ad))throw new Error("The supplied third party container is not of a valid type: only InsertionPoints and Ads are accepted");e=!1}if(b._partOfOngoingRequest)throw new Error("The supplied container is already waiting for a request response");if(e&&!b._partOfOngoingRequest)for(var f=0;f<b.slots.length;f++)for(var i=b.slots[f],j=0;j<i.ads.length;j++){var k=i.ads[j];if(k._partOfOngoingRequest)throw new Error("The supplied insertionPoint has ads already waiting for a request response")}if(!e&&b.ready)return void d(b);var l=function(a){if(a?b._partOfOngoingRequest=a:delete b._partOfOngoingRequest,e)for(var c=0;c<b.slots.length;c++)for(var d=b.slots[c],f=0;f<d.ads.length;f++){var g=d.ads[f];a?g._partOfOngoingRequest=a:delete g._partOfOngoingRequest}};l(!0);var n,p=!1,q=function(a){throw l(!1),new Error("Third party request failed unexpectedly: "+a)},r=function(){l(!1),p=!0,d.call(this,b)}.bind(this),s=new c.adrequest.VASTParser(h(this)),t={target:this,vastParser:s,sessionCancelled:!1,skipLazyAds:!1},u=!1;return e?(n=function(error){if(!p&&!1===t.sessionCancelled){for(var d,e,f=function(){},h=0;h<b.slots.length;++h)if(d=b.slots[h],h===b.slots.length-1)for(var i=0;i<d.ads.length;++i)e=d.ads[i],m.call(this,e,t,f,a,f)("Third party ad request cancelled",!0);var j=new c.LogItem;j.message="Third party request for insertion point canceled: "+error,j.source=c.LogItem.SourceType.AD,j.event=c.LogItem.EventType.REQUEST_CANCELED,g(t.target,j),t.sessionCancelled=!0,r()}}.bind(this),o.call(this,b,t,r,a,q)):n=m.call(this,b,t,r,a,q),function(a){if(u)throw new Error("Request has already been cancelled");u=!0,n(a)}},D.prototype.requestPassback=function(b,d,e){var f,g=!1;if(f=c.tracking.Tracker.resolveErrorCode(b,d),b instanceof c.adresponse.LinearCreative)b=b.parentAd,g=!0;else if(!(b instanceof c.adresponse.Ad))throw new Error("Invalid type: only Creative or Ad accepted");if(b.hasOwnProperty("trackingEvents")&&b.trackingEvents.hasOwnProperty("error")&&b.trackingEvents.error.hasOwnProperty("blocked")&&!0===b.trackingEvents.error.blocked)throw new Error("Cannot request passback after tracking error");if(b.hasOwnProperty("trackingEvents")&&b.trackingEvents.hasOwnProperty("impression")&&b.trackingEvents.impression.hasOwnProperty("blocked")&&!0===b.trackingEvents.impression.blocked)throw new Error("Cannot request passback after tracking impression");if(b._partOfOngoingRequest)throw g?new Error("The supplied creative's parent ad is already waiting for a request response"):new Error("The supplied ad is already waiting for a request response");if(b._partOfOngoingRequest=!0,!c.adresponse.Ad.hasPassback(b))throw g?new Error("The supplied creative's parent ad has no passback candidates available"):new Error("The supplied ad has no passback candidates available");var i,j=function(a){throw delete b._partOfOngoingRequest,new Error("Passback loading failed unexpectedly: "+a)},k=function(){for(var a=0;a<i.length;++a)i[a].thirdParty&&b.trackingEvents.error.urls.push(i[a]);delete b._partOfOngoingRequest,e.call(this,b)}.bind(this);b.trackingEvents.impression.urls.length=0,z(b,f),i=b.trackingEvents.error.urls,b.trackingEvents.error.urls=[];for(var l=0;l<b.creatives.length;++l)b.creatives[l].trackingEvents={},b.creatives[l].mediaFiles=[];b.companions=[];var n=new c.adrequest.VASTParser(h(this)),o={target:this,vastParser:n,sessionCancelled:!1,skipLazyAds:!0,logPassbackURL:!0},p=!1,q=m.call(this,b,o,k,a,j);return function(a){if(p)throw new Error("Request has already been cancelled");p=!0,q.call(this,a)}.bind(this)};var E=/\[ERRORCODE\]|%5BERRORCODE%5D/g;return D}(),c.adrequest.AdRequester.InsertionPointType={ON_BEFORE_CONTENT:"onBeforeContent",PLAYBACK_POSITION:"playbackPosition",ON_CONTENT_END:"onContentEnd",ON_PAUSE:"onPause",PLAYBACK_TIME:"playbackTime"},c.adrequest.AdRequester.Live={DISABLE_ALL:"disableAll",ALL_TRACKINGS:"allTrackings",SESSION_LOOKUP:"sessionLookup",LOCATION_LOOKUP:"locationLookup",REAL_TIME_BIDDING:"realTimeBidding"};var e={};for(var f in c.adrequest.AdRequester.InsertionPointType){var g=c.adrequest.AdRequester.InsertionPointType[f];e[g]=f}c.adrequest.AdRequester.ContentForm={SHORT_FORM:"shortForm",LONG_FORM:"longForm"}}(c),function(b){b.adrequest.VASTParser=function(){function c(a,c){var f,g,h,m,o,p,error,q,r,s=!1;if(f=new b.adresponse.Ad,!(a.getElementsByTagName("AdSystem").length>0))throw error=new Error,error.message='Invalid VAST. VAST Ad missing "AdSystem" element.',error.errorCode="101",error;var t=a.getElementsByTagName("AdSystem")[0].textContent;if(t&&t.toLowerCase().indexOf("videoplaza karbon")>-1&&(s=!0),a.getElementsByTagName("AdTitle").length>0){var u=a.getElementsByTagName("AdTitle")[0].textContent;u&&(f.title=u)}if(a.getElementsByTagName("Description").length>0){var v=a.getElementsByTagName("Description")[0].textContent;v&&(f.description=v)}if(a.getElementsByTagName("Advertiser").length>0){var w=a.getElementsByTagName("Advertiser")[0].textContent;w&&(f.advertiser=w)}if("Wrapper"===a.firstChild.nodeName){if(g=a.getElementsByTagName("VASTAdTagURI"),!(g.length>0))throw error=new Error,error.message="Invalid VAST. VAST Wrapper Ad missing VASTAdTagURI element.",error.errorCode="101",error;f.thirdPartyURL=g[0].textContent}else g=null;for(f.sequence=k(a,"sequence")?parseInt(k(a,"sequence")):0,f.id=k(a,"id"),null===f.id&&(s?(f.id="0",f.type="inventory"):f.id=""),m=a.getElementsByTagName("Extension"),h=0;h<m.length;h++)"AdServer"===k(m[h],"type")&&"Videoplaza"===k(m[h],"name")&&(o=m[h].getElementsByTagName("AdInfo")[0],f.campaignId=k(o,"cid"),f.customId=k(o,"customaid"),f.customGoalId=k(o,"customgid"),f.customCampaignId=k(o,"customcid"),f.goalId=k(o,"gid"),f.type=l(k(o,"format")),f.variant=j(k(o,"variant")),f.partOfAnExclusiveCampaign="true"===k(o,"exclusive"),o.getElementsByTagName("Companion"));for(d.call(this,f,a,"Impression","impression",c),r=a.getElementsByTagName("Survey"),r.length>0&&(f.survey=n(r[0].textContent)),p=a.getElementsByTagName("Error"),null===g&&s&&0===p.length&&"inventory"===f.type&&(p=a.getElementsByTagName("Impression")),h=0;h<p.length;h++)f.trackingEvents.hasOwnProperty("error")||(f.trackingEvents.error={urls:[],blocked:!1}),f.trackingEvents.error.urls.push({url:i.call(this,n(p[h].textContent),c),thirdParty:!0});if(q=a.getElementsByTagName("Creative"),!s&&0===q.length&&null===g)throw error=new Error,error.message="Invalid VAST. VAST InLine Ad missing creatives!",error.errorCode="101",error;if(f.creatives=e.call(this,q,f,c),f.creatives&&f.creatives[0]&&f.creatives[0].mediaFiles&&f.creatives[0].mediaFiles[0]&&"VPAID"!==f.creatives[0].mediaFiles[0].apiFramework&&a.getElementsByTagName("Impression").length<1)throw error=new Error,error.message="Invalid VAST. VAST Ad missing Impression elements!",error.errorCode="101",error;if("4.0"===c){var x=k(a,"conditionalAd");"false"===x?f.conditional=!1:"true"===x&&(f.conditional=!0);var y=a.getElementsByTagName("ViewableImpression");y.length>0&&(y=y[0],d.call(this,f,y,"Viewable","impressionViewable",c),d.call(this,f,y,"NotViewable","impressionNotViewable",c),d.call(this,f,y,"ViewUndetermined","impressionViewUndetermined",c));var z=a.getElementsByTagName("AdVerifications")[0];if(z)for(var A=z.getElementsByTagName("Verification"),B=0;B<A.length;++B){var C=A[B],D={trackingEvents:{}},E=C.getElementsByTagName("JavaScriptResource")[0];if(E){var F=k(E,"apiFramework");D.javascriptResource=n(E.textContent),D.javascriptResourceAPIFramework=F}var G=C.getElementsByTagName("FlashResource")[0];if(G){var H=k(G,"apiFramework");D.flashResource=n(G.textContent),D.flashResourceAPIFramework=H}y=C.getElementsByTagName("ViewableImpression"),y.length>0&&(y=y[0],d.call(this,D,y,"Viewable","impressionViewable",c),d.call(this,D,y,"NotViewable","impressionNotViewable",c),d.call(this,D,y,"ViewUndetermined","impressionViewUndetermined",c)),(D.javascriptResource||D.flashResource)&&f.verifications.push(D)}for(var I=a.getElementsByTagName("Category"),J=0;J<I.length;++J){var K=I[J],L=n(K.textContent),M=k(K,"authority");if(M)f.categories.push({label:L,authority:M});else if(L)throw error=new Error,error.message="Invalid VAST. Category without authority attribute.",error.errorCode="101",error}var N=a.getElementsByTagName("Pricing")[0];if(N){var O=k(N,"model"),P=k(N,"currency"),Q=parseFloat(n(N.textContent));if(!O||!P)throw error.message="Invalid VAST. Pricing is missing model or currency attributes.",error.errorCode="101",error;if("cpm"!==(O=O.toLowerCase())&&"cpc"!==O&&"cpe"!==O&&"cpv"!==O)throw error.message='Invalid VAST. Unknown pricing model "'+O+'".',error.errorCode="101",error;f.pricing={model:O,currency:P,value:Q}}}return f}function d(a,b,c,d,e){for(var f=b.getElementsByTagName(c),g=0;g<f.length;g++){a.trackingEvents.hasOwnProperty(d)||(a.trackingEvents[d]={urls:[],blocked:!1});var h=k(f[g],"id");h?a.trackingEvents[d].urls.push({id:h,url:i.call(this,n(f[g].textContent),e),thirdParty:!0}):a.trackingEvents[d].urls.push({url:i.call(this,n(f[g].textContent),e),thirdParty:!0})}}function e(c,d,e){for(var g,j,l,m,o,error,p,q,r,s,t,u,v,w,x=[],y=0,z=0;z<c.length;z++){m=k(c[z],"id");var A;if(g=c[z].getElementsByTagName("Linear")[0],j=c[z].getElementsByTagName("NonLinearAds")[0],l=c[z].getElementsByTagName("CompanionAds")[0],g){for(++y,A=new b.adresponse.LinearCreative,A.parentAd=d,A.type="linear",A.id=m,A.sequence=k(c[z],"sequence")?parseInt(k(c[z],"sequence")):0,p=c[z].getElementsByTagName("TrackingEvents"),p.length>0&&(A.trackingEvents=f.call(this,p[0],e)),r=c[z].getElementsByTagName("ClickTracking"),q=0;q<r.length;q++)A.trackingEvents.hasOwnProperty("clickthrough")||(A.trackingEvents.clickthrough={urls:[],blocked:!1}),A.trackingEvents.clickthrough.urls.push({url:i.call(this,n(r[q].textContent),e),thirdParty:!0});for(var B=c[z].getElementsByTagName("CustomClick"),C=0;C<B.length;C++)A.trackingEvents.hasOwnProperty("customClick")||(A.trackingEvents.customClick={urls:[],blocked:!1}),A.trackingEvents.customClick.urls.push({url:i.call(this,n(B[C].textContent),e),thirdParty:!0});if(s=c[z].getElementsByTagName("ClickThrough"),s.length>0&&(A.clickThroughUrl=n(s[0].textContent)),t=c[z].getElementsByTagName("MediaFile"),0===d.thirdPartyURL.length){if(!t||0===t.length)throw error=new Error,error.message="Invalid VAST. Creative element has no MediaFiles.",error.errorCode="101",error;for(q=0;q<t.length;q++){if(u=new b.adresponse.MediaFile,!k(t[q],"delivery"))throw error=new Error,error.message='Invalid VAST. MediaFile missing property "delivery".',error.errorCode="101",error;if(!k(t[q],"width"))throw error=new Error,error.message='Invalid VAST. MediaFile missing property "width".',error.errorCode="101",error;if(!k(t[q],"height"))throw error=new Error,error.message='Invalid VAST. MediaFile missing property "height".',error.errorCode="101",error;if(!k(t[q],"type"))throw error=new Error,error.message='Invalid VAST. MediaFile missing property "type".',error.errorCode="101",error;u.apiFramework=k(t[q],"apiFramework"),u.bitRate=parseFloat(k(t[q],"bitrate")),u.deliveryMethod=k(t[q],"delivery"),u.height=parseFloat(k(t[q],"height")),u.id=k(t[q],"id"),u.mimeType=k(t[q],"type"),u.url=t[q].textContent,u.width=parseFloat(k(t[q],"width")),A.mediaFiles.push(u)}if("4.0"===e){var D=c[z].getElementsByTagName("UniversalAdId")[0];if(!D)throw error=new Error,error.message="Invalid VAST. VAST 4.0 creative without UniversalAdId element.",error.errorCode="101",error;var E=n(D.textContent),F=k(D,"idRegistry");F||(F="unknown"),A.universalAdId={identifier:E,registry:F}}}else if(0!==t.length)throw error=new Error,error.message="Invalid VAST. MediaFile elements not allowed in Wrapper Linear.",error.errorCode="101",error;if(0===d.thirdPartyURL.length){if(!(o=c[z].getElementsByTagName("Duration"))||0===o.length)throw error=new Error,error.message="Invalid VAST. No Duration element.",error.errorCode="101",error;try{A.duration=h(o[0].textContent)}catch(J){A.duration=a}}else o=0;if(w=k(g,"skipoffset"),A.skipResetTime=0,w){var G;if(w.indexOf("%")>-1)if(A.duration){var H=parseFloat(String(w).substring(0,w.indexOf("%")));G=isNaN(H)?a:(A.duration||0)*(H/100)}else G=w;else G=h(w);A.skipOffset=G,A.skipButtonMode=b.adresponse.LinearCreative.SkipButtonMode.ALWAYS}else A.skipButtonMode=b.adresponse.LinearCreative.SkipButtonMode.NEVER;A.adParameters=c[z].getElementsByTagName("AdParameters"),A.adParameters.length>0?A.adParameters=n(A.adParameters[0].textContent):A.adParameters=null,x.push(A)}else if(j&&0===d.thirdPartyURL.length){var I=j.getElementsByTagName("NonLinear");if(I.length>0)throw error=new Error,error.message="Invalid VAST. VAST nonlinear creatives not accepted.",error.errorCode="101",error}else if(l&&"3.0"===e&&null!==(v=k(l,"required"))&&"none"!==v)throw error=new Error,error.message='Invalid VAST. VAST 3.0 companions not accepted unless "required" attribute is "none".',error.errorCode="101",error}if(y>1)throw error=new Error,error.message="Invalid VAST. Ads with multiple linear creatives are not supported.",error.errorCode="101",error;return x}function f(a,c){var d,e,f,h,j;d={},e=a.getElementsByTagName("Tracking");for(var l=0;l<e.length;l++)if(f=e.item(l),h=k(f,"event"),"acceptinvitationlinear"===h.toLowerCase()?h=b.tracking.Tracker.CreativeEventType.ACCEPT_INVITATION:"closelinear"===h.toLowerCase()&&(h=b.tracking.Tracker.CreativeEventType.CLOSE),"progress"===h){if(j=k(f,"offset"),!g(j)){var error=new Error;throw error.message="Invalid VAST. Progress event with missing or invalid offset value.",error.errorCode="101",error}d.hasOwnProperty(h)||(d[h]={}),d[h].hasOwnProperty(j)||(d[h][j]={urls:[],blocked:!1}),d[h][j].urls.push({url:i.call(this,n(f.textContent),c),thirdParty:!0})}else d.hasOwnProperty(h)||(d[h]={urls:[],blocked:!1}),d[h].urls.push({url:i.call(this,n(f.textContent),c),thirdParty:!0});return d}function g(a){return a&&null!==a.match(o)}function h(a){var b=a.split(":"),c=0;if(!(b.length>0&&b.length<=3))throw new Error("Invalid VAST. Invalid timestamp format");for(var d=0;d<b.length;d++)c+=Number(b[b.length-d-1]*(d?Math.pow(60,d):1));if(isNaN(c))throw new Error("Invalid VAST. Invalid timestamp format");return c}function i(a,b){return this.options.enforceCacheBusting&&"2.0"===b&&-1===a.indexOf("[CACHEBUSTING]")&&-1===a.indexOf("%5BCACHEBUSTING%5D")&&a.length>0&&(a.indexOf("?")>-1?a+="&rnd=[CACHEBUSTING]":a+="?rnd=[CACHEBUSTING]"),a}function j(a){return!a||"bumper"!==(a=a.toLowerCase())&&"sponsor"!==a?"normal":"sponsor"}function k(a,b){var c;return a&&a.attributes&&(c=a.attributes.getNamedItem(b))?c.value:null}function l(a){return"spot_standard"===a?"standard_spot":a}function m(a){var b,c,d=/^\s*$/;if(3===a.nodeType)d.test(a.nodeValue)&&a.parentNode.removeChild(a);else if(8===a.nodeType&&"#comment"===a.nodeName)a.parentNode.removeChild(a);else if(1===a.nodeType||9===a.nodeType)for(b=a.firstChild;b;)c=b.nextSibling,m(b),b=c}function n(a){return a.replace(/^\s+|\s+$/g,"")}var o=/^(\d\d:\d\d:\d\d(.\d\d\d)?)$|^((100)|(\d\d?)|(1\d\d?\.0*)|(\d\d?\.\d?\d?)|(\.\d\d?))%$/,p=function a(c){if(c=c||{},!1!==c.enforceCacheBusting&&(c.enforceCacheBusting=!0),!0!==c.useVASTSkipOffset&&(c.useVASTSkipOffset=!1),this.options=c,this.parser=new window.DOMParser,!(this instanceof b.adrequest.VASTParser))return new a};return p.prototype.parse=function(a){var d,e,f,g,error,h;try{d=this.parser.parseFromString(a,"text/xml")}catch(q){throw error=new Error,error.message="Could not parse VAST. "+q.message,error.errorCode="100",error}if(e=d.documentElement,m(e),!e)throw error=new Error,error.message="Could not parse VAST. No root element",error.errorCode="100",error;if("VAST"!==e.nodeName)throw error=new Error,error.message='Could not parse VAST. Root element is not "VAST".',error.errorCode="100",error;h=k(e,"version");var j;if(e.hasChildNodes()){if(f=e.getElementsByTagName("Ad"),g=e.getElementsByTagName("Error"),"Ad"===e.firstChild.nodeName){if(f.length>1)throw error=new Error,error.message="Invalid VAST. Found more than one ad.",error.errorCode="101",error;j=c.call(this,f[0],h)}else if("Error"===e.firstChild.nodeName){j=new b.adresponse.Ad,j.id="0",j.type="inventory";for(var l=0;l<g.length;l++)j.trackingEvents.hasOwnProperty("error")||(j.trackingEvents.error={urls:[],blocked:!1}),j.trackingEvents.error.urls.push({url:i.call(this,n(g[l].textContent),h),thirdParty:!0})}else if("parsererror"===e.firstChild.nodeName)throw error=new Error,error.message="Could not parse VAST. XML bad form: "+n(e.firstChild.textContent),error.errorCode="100",error}else j=new b.adresponse.Ad,j.id="0",j.type="inventory";for(var o=0;o<j.creatives.length;++o){var p=j.creatives[o];p instanceof b.adresponse.LinearCreative&&p.mediaFiles.sort(function(a,b){return a.bitRate||(a.bitRate=0),b.bitRate||(b.bitRate=0),0===a.bitRate&&0===b.bitRate?0:0===a.bitRate&b.bitRate>0?-1:a.bitRate>0&0===b.bitRate?1:b.bitRate-a.bitRate})}return j},p}(),b.adrequest.VAST3Parser=b.adrequest.VASTParser}(c),function(a){a.adrequest.VPTP3Parser=function(){function b(a){var b=[];if("[object Object]"!==Object.prototype.toString.call(a))throw new Error("VPTP Ticket trackingEvents should be object but is "+Object.prototype.toString.call(a));if(!(a.tracking.length>0))throw new Error("VPTP Ticket trackingEvents.tracking can not be empty");for(var c=0;c<a.tracking.length;c++)b[a.tracking[c].event]?b[a.tracking[c].event].urls.push({url:a.tracking[c].value}):b[a.tracking[c].event]={urls:[{url:a.tracking[c].value}],blocked:!1};return b}function c(b,c,e){var f=[];if("[object Array]"!==Object.prototype.toString.call(b))throw new Error("VPTP Ticket insertionPoint should be array but is "+Object.prototype.toString.call(b));for(var g=0;g<b.length;g++){var h=new a.adresponse.InsertionPoint;if(h.parentSession=c,!o(b[g],"conditions"))throw new Error("VPTP Ticket insertionPoint is missing conditions!");if(h.conditions=m(b[g].conditions.condition),!o(b[g],"slot"))throw new Error("VPTP Ticket insertionPoint is missing slots!");h.slots=d(b[g].slot,h,c,e),f.push(h)}return f}function d(b,c,d,f){var g=[];if("[object Array]"!==Object.prototype.toString.call(b))throw new Error("VPTP Ticket insertionPoint.slot should be array but is "+Object.prototype.toString.call(b));if(!(b.length>0))throw new Error("VPTP Ticket insertionPoint.slot cannot be empty!");for(var h=0;h<b.length;h++){var i=b[h],j=new a.adresponse.Slot;if(j.parentInsertionPoint=c,o(i,"trackingEvents")){if("[object Object]"!==Object.prototype.toString.call(i.trackingEvents))throw new Error("VPTP Ticket insertionPoint.slot.trackingEvents should be object but is "+Object.prototype.toString.call(i.trackingEvents));if(!o(i.trackingEvents,"tracking"))throw new Error("VPTP Ticket slot.trackingEvents is missing tracking object!");if("[object Array]"!==Object.prototype.toString.call(i.trackingEvents.tracking))throw new Error("VPTP Ticket insertionPoint.slot.trackingEvents.tracking should be array but is "+Object.prototype.toString.call(i.trackingEvents.tracking));for(var k=0;k<i.trackingEvents.tracking.length;++k){var m=i.trackingEvents.tracking[k];if(!o(m,"event"))throw new Error("VPTP Ticket slot.trackingEvent object is missing event property!");if("string"!=typeof m.event)throw new Error("VPTP Ticket slot.trackingEvent object event property should be string but is "+_typeof(m.event));if(!o(m,"value"))throw new Error("VPTP Ticket slot.trackingEvent object is missing value property!");if("string"!=typeof m.value)throw new Error("VPTP Ticket slot.trackingEvent object value property should be string but is "+_typeof(m.value));j.trackingEvents[m.event]?j.trackingEvents[m.event].urls.push({url:m.value}):j.trackingEvents[m.event]={urls:[{url:m.value}],blocked:!1}}}if(!o(i,"vast"))throw new Error("VPTP Ticket insertionPoint.slot missing VAST property!");if(!o(i.vast,"ad"))throw new Error("VPTP Ticket insertionPoint.slot.vast missing 'ad' property!");if("[object Array]"!==Object.prototype.toString.call(i.vast.ad))throw new Error("VPTP Ticket insertionPoint.slot.vast.ad property should be array but is "+Object.prototype.toString.call(i.vast.ad));if(!(i.vast.ad.length>0))throw new Error("VPTP Ticket insertionPoint.slot.vast.ad array is empty!");for(var n=i.vast.ad,p=n.length,q=[],r=0;r<p;r++){var s=null;if(!o(n[r],"inLine"))throw new Error("VPTP Ticket ad missing 'inLine' property!");if("[object Object]"!==Object.prototype.toString.call(n[r].inLine))throw new Error("VPTP Ticket ad.inLine property should be object but is "+Object.prototype.toString.call(n[r].inLine));if(o(n[r].inLine,"creatives")){if("[object Object]"!==Object.prototype.toString.call(n[r].inLine.creatives))throw new Error("VPTP Ticket ad.inLine.creatives property should be object but is "+Object.prototype.toString.call(n[r].inLine.creatives));if(!o(n[r].inLine.creatives,"creative"))throw new Error("VPTP Ticket ad.inLine.creatives missing 'creative' property!");if("[object Array]"!==Object.prototype.toString.call(n[r].inLine.creatives.creative))throw new Error("VPTP Ticket ad.inLine.creatives.creative property should be array but is "+Object.prototype.toString.call(n[r].inLine.creatives.creative));for(var t=0;t<n[r].inLine.creatives.creative.length;t++){var u=n[r].inLine.creatives.creative[t];if(o(u,"linear")){if("[object Object]"!==Object.prototype.toString.call(u.linear))throw new Error("Creative.linear should be object but is "+Object.prototype.toString.call(u.linear));if(!o(u.linear,"adParameters"))throw new Error("Linear is missing AdParameters!");if("[object Object]"!==Object.prototype.toString.call(u.linear.adParameters))throw new Error("Linear AdParameters should be object but is "+Object.prototype.toString.call(u.linear.adParameters));if(!o(u.linear.adParameters,"value"))throw new Error("Linear AdParameters is missing 'value' property!");if("[object String]"!==Object.prototype.toString.call(u.linear.adParameters.value))throw new Error("Unparsed AdParameters.value should be string but is "+Object.prototype.toString.call(u.linear.adParameters.value));u.linear.adParameters.value=JSON.parse(u.linear.adParameters.value)}else{if(!o(u,"nonLinearAds"))throw new Error("Creative is missing linear or nonLinearAds property!");if("[object Object]"!==Object.prototype.toString.call(u.nonLinearAds))throw new Error("Creative.nonLinearAds should be object but is "+Object.prototype.toString.call(u.nonLinearAds));if(!o(u.nonLinearAds,"nonLinear"))throw new Error("Creative.nonLinearAds is missing nonLinear!");if("[object Array]"!==Object.prototype.toString.call(u.nonLinearAds.nonLinear))throw new Error("Creative.nonLinearAds.nonLinear should be array but is "+Object.prototype.toString.call(u.nonLinearAds.nonLinear));if(0===u.nonLinearAds.nonLinear.length)throw new Error("Creative.nonLinearAds.nonLinear is empty!");if(!o(u.nonLinearAds.nonLinear[0],"adParameters"))throw new Error("Creative.nonLinearAds.nonLinear is missing AdParameters!");if("[object Object]"!==Object.prototype.toString.call(u.nonLinearAds.nonLinear[0].adParameters))throw new Error("Creative.nonLinearAds.nonLinear.adParameters should be object but is "+Object.prototype.toString.call(u.nonLinearAds.nonLinear[0].adParameters));if(!o(u.nonLinearAds.nonLinear[0].adParameters,"value"))throw new Error("Creative.nonLinearAds.nonLinear.adParameters is missing 'value' property!");if("[object String]"!==Object.prototype.toString.call(u.nonLinearAds.nonLinear[0].adParameters.value))throw new Error("Unparsed AdParameters.value should be string but is "+Object.prototype.toString.call(u.nonLinearAds.nonLinear[0].adParameters.value));u.nonLinearAds.nonLinear[0].adParameters.value=JSON.parse(u.nonLinearAds.nonLinear[0].adParameters.value)}if(0===t)if(o(u,"linear")){if(o(u.linear,"mediaFiles")&&o(u.linear.mediaFiles,"mediaFile")){if("[object Array]"!==Object.prototype.toString.call(u.linear.mediaFiles.mediaFile))throw new Error("VPTP Linear Creative.mediaFiles.mediaFile should be Array but is "+Object.prototype.toString.call(u.linear.mediaFiles.mediaFile));if(0===u.linear.mediaFiles.mediaFile.length)s=e(n[r],j,f);else{if(!o(u.linear.mediaFiles.mediaFile[0],"value"))throw new Error("VPTP MediaFile missing value property!")
;if("string"!=typeof u.linear.mediaFiles.mediaFile[0].value)throw new Error("VPTP MediaFile value property should be string but is "+_typeof(u.linear.mediaFiles.mediaFile[0].value));-1!=u.linear.mediaFiles.mediaFile[0].value.indexOf("spot_selector")&&(s=e(n[r],j,f),s.type=a.adresponse.Ad.AdType.SPOT_SELECTOR)}}s||(s=e(n[r].inLine.creatives.creative[0].linear.adParameters.value.ad[0],j,f))}else o(u,"nonLinearAds")&&(s=e(n[r].inLine.creatives.creative[0].nonLinearAds.nonLinear[0].adParameters.value.ad[0],j,f))}}else s=e(n[r],j,f),s.type="inventory";if(null!=s){if("spot_selector"!==s.type&&s.ads.length>0){for(var v=0,w=0;w<s.ads.length;++w)v+=s.ads[w].maximumPreparationTime;s.maximumPreparationTime=Math.min(s.maximumPreparationTime,v)}switch(s.type){case a.adresponse.Ad.AdType.SKIN_INSKIN:case a.adresponse.Ad.AdType.SPOT_INTERACTIVE:case a.adresponse.Ad.AdType.SPOT_SELECTOR:case a.adresponse.Ad.AdType.SPOT_TAKEOVER:s=l(s);default:q.push(s)}}}j.ads=q,g.push(j)}return g}function e(b,c,d,h){var k=new a.adresponse.Ad;if(k.parentSlot=c,k.candidate=h||1,k.ready=!0,o(b,"id")&&(k.id=b.id),o(b,"inLine")||o(b,"wrapper")){var l="inLine";if(o(b,"wrapper")){if(l="wrapper",!o(b[l],"vastadTagURI"))throw new Error("VPTP Wrapper ad missing vastadTagURI!");if(!(b[l].vastadTagURI.length>0))throw new Error("VPTP Wrapper ad vastadTagURI is empty!");k.thirdPartyURL=b[l].vastadTagURI}if(!o(b[l],"impression"))throw new Error("VPTP ad "+l+" is missing impression property!");if("[object Array]"!==Object.prototype.toString.call(b[l].impression))throw new Error("VPTP ad "+l+" impression property should be array but is "+Object.prototype.toString.call(b[l].impression));if(b[l].impression.length>0)for(var m=b[l].impression,p=m.length,q=0;q<p;q++){var r=m[q];o(k.trackingEvents,"impression")||(k.trackingEvents.impression={urls:[],blocked:!1}),"inLine"===l&&o(r,"value")?k.trackingEvents.impression.urls.push({url:r.value.toString()}):"wrapper"===l&&k.trackingEvents.impression.urls.push({url:r.toString()})}if(o(b[l],"error")){if("string"!=typeof b[l].error)throw new Error("VPTP Ad error property should be string but is "+_typeof(b[l]));b[l].error.length>0&&(o(k.trackingEvents,"error")?k.trackingEvents.error.urls.push({url:b[l].error}):k.trackingEvents.error={urls:[{url:b[l].error}],blocked:!1})}if(o(b[l],"adTitle")&&(k.title=b[l].adTitle.toString()),o(b[l],"creatives")){if("[object Object]"===Object.prototype.toString.call(b[l].creatives)&&o(b[l].creatives,"creative")&&"[object Array]"===Object.prototype.toString.call(b[l].creatives.creative)&&b[l].creatives.creative.length>0)for(var s,t=b[l].creatives.creative,u=t.length,v=0;v<u;v++){var w=t[v];if(s=0,o(w,"sequence")&&NaN===(s=parseInt(w.sequence))&&(s=0),o(w,"linear")){var x=new a.adresponse.LinearCreative;if(x.parentAd=k,x.sequence=s,o(w,"id")&&(x.type=w.id),o(w.linear,"duration")&&("string"==typeof w.linear.duration?x.duration=n(w.linear.duration):"number"==typeof w.linear.duration&&(x.duration=w.linear.duration)),o(w.linear,"mediaFiles")){if(!o(w.linear.mediaFiles,"mediaFile"))throw new Error("VPTP Linear Creative.mediaFiles missing mediaFile property!");if("[object Array]"===Object.prototype.toString.call(w.linear.mediaFiles.mediaFile)&&w.linear.mediaFiles.mediaFile.length>0)for(var y=w.linear.mediaFiles.mediaFile,z=y.length,A=0;A<z;A++){var B=y[A],C=new a.adresponse.MediaFile;if(!o(B,"value"))throw new Error("VPTP MediaFile missing value property!");if("string"!=typeof B.value)throw new Error("VPTP MediaFile value property should be string but is "+_typeof(B.value));if(C.url=B.value,!o(B,"type"))throw new Error("VPTP MediaFile missing type property!");if("string"!=typeof B.type)throw new Error("VPTP MediaFile type property should be string but is "+_typeof(B.type));if(C.mimeType=B.type,!o(B,"width"))throw new Error("VPTP MediaFile missing width property!");if("number"!=typeof B.width)throw new Error("VPTP MediaFile width property should be number but is "+_typeof(B.width));if(C.width=parseFloat(B.width),!o(B,"height"))throw new Error("VPTP MediaFile missing height property!");if("number"!=typeof B.height)throw new Error("VPTP MediaFile height property should be number but is "+_typeof(B.height));if(C.height=parseFloat(B.height),!o(B,"bitrate"))throw new Error("VPTP MediaFile missing bitrate property!");if("number"!=typeof B.bitrate)throw new Error("VPTP MediaFile bitrate property should be number but is "+_typeof(B.bitrate));if(C.bitRate=parseFloat(B.bitrate),!o(B,"delivery"))throw new Error("VPTP MediaFile missing delivery property!");if("string"!=typeof B.delivery)throw new Error("VPTP MediaFile delivery property should be string but is "+_typeof(B.delivery));if(C.deliveryMethod=B.delivery,o(B,"apiFramework")){if("string"!=typeof B.apiFramework)throw new Error("VPTP MediaFile apiFramework property should be string but is "+_typeof(B.apiFramework));C.apiFramework=B.apiFramework}o(x,"mediaFiles")||(x.mediaFiles=[]),x.mediaFiles.push(C)}}else if("wrapper"!==l)throw new Error("VPTP Linear Creative missing mediaFiles property!");if(o(w.linear,"videoClicks")){if("[object Object]"!==Object.prototype.toString.call(w.linear.videoClicks))throw new Error("VPTP Linear Creative.videoClicks should be Object but is "+Object.prototype.toString.call(w.linear.videoClicks));if(!o(w.linear.videoClicks,"clickTracking"))throw new Error("VPTP Linear Creative videoClicks missing clickTracking property!");if("[object Array]"!==Object.prototype.toString.call(w.linear.videoClicks.clickTracking))throw new Error("VPTP Linear Creative.videoClicks.clickTracking should be Array but is "+Object.prototype.toString.call(w.linear.videoClicks.clickTracking));if(w.linear.videoClicks.clickTracking.length>0){o(x.trackingEvents,"clickthrough")||(x.trackingEvents.clickthrough={urls:[],blocked:!1});for(var q=0;q<w.linear.videoClicks.clickTracking.length;++q){var D=w.linear.videoClicks.clickTracking[q];if(!o(D,"value"))throw new Error("VPTP ClickTracking object missing value property!");if("string"!=typeof D.value)throw new Error("VPTP ClickTracking value property should be string but is "+_typeof(D.value));x.trackingEvents.clickthrough.urls.push({url:D.value})}}if(o(w.linear.videoClicks,"clickThrough")){if("[object Object]"!==Object.prototype.toString.call(w.linear.videoClicks.clickThrough))throw new Error("VPTP Linear Creative.videoClicks clickThrough property should be object but is "+Object.prototype.toString.call(w.linear.videoClicks.clickThrough));if(!o(w.linear.videoClicks.clickThrough,"value"))throw new Error("VPTP Linear Creative.videoClicks.clickThrough missing value property!");if("string"!=typeof w.linear.videoClicks.clickThrough.value)throw new Error("VPTP Linear Creative.videoClicks.clickThrough value property should be string but is "+_typeof(w.linear.videoClicks.clickThrough.value));x.clickThroughUrl=w.linear.videoClicks.clickThrough.value}}if(o(w.linear,"trackingEvents")&&!a.adrequest.AdRequester.liveParameterEnabled){if("[object Object]"!==Object.prototype.toString.call(w.linear.trackingEvents))throw new Error("VPTP Linear Creative.trackingEvents should be Object but is "+Object.prototype.toString.call(w.linear.trackingEvents));if(!o(w.linear.trackingEvents,"tracking"))throw new Error("VPTP Linear Creative missing trackingEvents.tracking property!");if("[object Array]"!==Object.prototype.toString.call(w.linear.trackingEvents.tracking))throw new Error("VPTP Linear Creative.trackingEvents.tracking should be Array but is "+Object.prototype.toString.call(w.linear.trackingEvents.tracking));if(w.linear.trackingEvents.tracking.length>0)x.trackingEvents=i(x.trackingEvents,w.linear.trackingEvents.tracking);else{if(!d)throw new Error("VPTP Linear Creative.trackingEvents.tracking array is empty!");x.trackingEvents=[]}}if(w.linear.hasOwnProperty("skipOffset")||w.linear.hasOwnProperty("skipoffset")){var E,F=w.linear.hasOwnProperty("skipoffset")?w.linear.skipoffset:w.linear.skipOffset;if(F.indexOf("%")>-1){var G=parseFloat(String(F).substring(0,F.indexOf("%")));E=(x.duration||0)*(G/100)}else E=n(F);x.skipOffset=E}if(k.creatives.push(x),o(w.linear,"adParameters")&&"[object Object]"===Object.prototype.toString.call(w.linear.adParameters)&&o(w.linear.adParameters,"value")&&"[object Object]"===Object.prototype.toString.call(w.linear.adParameters.value)&&o(w.linear.adParameters.value,"ad")){if("[object Array]"!==Object.prototype.toString.call(w.linear.adParameters.value.ad))throw new Error("VPTP Linear Creative adParameters.value.ad should be Array but is "+Object.prototype.toString.call(w.linear.adParameters.value.ad));if(!(w.linear.adParameters.value.ad.length>0))throw new Error("VPTP Linear Creative adParameters.value.ad is empty!");for(var H=w.linear.adParameters.value.ad,I=H.length,J=0;J<I;J++){var K=e(H[J],c,d,J+1);K&&(o(K,"lazyPrepared")&&(k.ready=!1),k.ads.push(K))}}}else if(o(w,"nonLinearAds"))o(w.nonLinearAds,"nonLinear")&&g(k,w.nonLinearAds,s,w.id,d);else if(o(w,"companionAds")&&o(w.companionAds,"companion")){var L=a.adresponse.Companion.RequiredRule.NO;if(o(w.companionAds,"required"))switch(w.companionAds.required){case"all":L=a.adresponse.Companion.RequiredRule.YES;break;case"any":L=a.adresponse.Companion.RequiredRule.AT_LEAST_ONE_FOR_THIS_SEQUENCE;break;case"none":L=a.adresponse.Companion.RequiredRule.NO}f(k,w.companionAds.companion,s,L)}}}else k.type="inventory",k.trackingEvents.error=k.trackingEvents.impression,k.trackingEvents.impression={urls:[],blocked:!1};k=j(k,b)}for(var q=0;q<k.creatives.length;++q){var M=k.creatives[q];M instanceof a.adresponse.LinearCreative&&M.mediaFiles.sort(function(a,b){return a.bitRate?b.bitRate?a.bitRate<b.bitRate?1:b.bitRate<a.bitRate?-1:0:-1:1})}return k}function f(b,c,d,e){for(var f,g,j=0;j<c.length;++j){if(f=c[j],g=new a.adresponse.Companion,g.parentAd=b,g.sequence=d,g.required=e,!o(f,"width"))throw new Error("VPTP Companion missing required attribute width");if(g.width=parseInt(f.width),isNaN(g.width))throw new Error("VPTP Companion width is not a number");if(!o(f,"height"))throw new Error("VPTP Companion missing required attribute height");if(g.height=parseInt(f.height),isNaN(g.height))throw new Error("VPTP Companion height is not a number");if(o(f,"id")&&(g.id=f.id),h(f,g,!0),o(f,"trackingEvents")&&!a.adrequest.AdRequester.liveParameterEnabled){if("[object Object]"!==Object.prototype.toString.call(f.trackingEvents))throw new Error("VPTP Linear Companion.trackingEvents should be Object but is "+Object.prototype.toString.call(f.trackingEvents));if(!o(f.trackingEvents,"tracking"))throw new Error("VPTP Linear Companion missing trackingEvents.tracking property!");if("[object Array]"!==Object.prototype.toString.call(f.trackingEvents.tracking))throw new Error("VPTP Linear Companion.trackingEvents.tracking should be Array but is "+Object.prototype.toString.call(f.trackingEvents.tracking));if(!(f.trackingEvents.tracking.length>0))throw new Error("VPTP Linear Companion.trackingEvents.tracking array is empty!");g.trackingEvents=i(g.trackingEvents,f.trackingEvents.tracking)}if(o(f,"companionClickTracking")){o(g.trackingEvents,"clickThrough")||(g.trackingEvents.clickThrough={urls:[],blocked:!1});for(var k,l,j=0;j<f.companionClickTracking.length;++j){if(k=f.companionClickTracking[j],!o(k,"value"))throw new Error("Companion has ClickTracking with no URL value");l={url:k.value,thirdPartyURL:!0},o(k,"id")||(l.id=k.id),g.trackingEvents.clickThrough.urls.push(l)}}b.companions.push(g)}}function g(b,c,d,e,f){for(var g,j,k=0;k<c.nonLinear.length;++k){if(g=c.nonLinear[k],j=new a.adresponse.NonLinearCreative,j.parentAd=b,j.sequence=d,o(g,"minSuggestedDuration")&&("string"==typeof g.minSuggestedDuration?j.duration=n(g.minSuggestedDuration):"number"==typeof g.minSuggestedDuration&&(j.duration=g.minSuggestedDuration),isNaN(j.duration)))throw new Error("VPTP NonLinearCreative duration is not a number");if(o(g,"width")&&(j.width=parseInt(g.width),isNaN(j.width)))throw new Error("VPTP NonLinearCreative width is not a number");if(o(g,"height")&&(j.height=parseInt(g.height),isNaN(j.height)))throw new Error("VPTP NonLinearCreative height is not a number");if(e&&(j.type=e),h(g,j,!1),o(c,"trackingEvents")&&!a.adrequest.AdRequester.liveParameterEnabled){if("[object Object]"!==Object.prototype.toString.call(c.trackingEvents))throw new Error("VPTP nonLinearAds trackingEvents should be Object but is "+Object.prototype.toString.call(c.trackingEvents));if(!o(c.trackingEvents,"tracking"))throw new Error("VPTP nonLinearAds missing trackingEvents.tracking property!");if("[object Array]"!==Object.prototype.toString.call(c.trackingEvents.tracking))throw new Error("VPTP nonLinearAds trackingEvents.tracking should be Array but is "+Object.prototype.toString.call(c.trackingEvents.tracking));if(c.trackingEvents.tracking.length>0)j.trackingEvents=i(j.trackingEvents,c.trackingEvents.tracking);else{if(!f)throw new Error("VPTP nonLinearAds trackingEvents.tracking array is empty!");j.trackingEvents=[]}}if(o(g,"nonLinearClickTracking")){o(j.trackingEvents,"clickThrough")||(j.trackingEvents.clickThrough={urls:[],blocked:!1});for(var l,m,k=0;k<g.nonLinearClickTracking.length;++k){if(l=g.nonLinearClickTracking[k],!o(l,"value"))throw new Error("NonLinearCreative has ClickTracking with no URL value");m={url:l.value,thirdPartyURL:!0},o(l,"id")||(m.id=l.id),j.trackingEvents.clickThrough.urls.push(m)}}b.creatives.push(j)}}function h(b,c,d){var e,f=d?"Companion":"NonLinearCreative";if(o(b,"staticResource")){if(!o(b.staticResource,"value"))throw new Error("VPTP "+f+" has StaticResource with no URL value");if(e=new a.adresponse.StaticResource,e.url=b.staticResource.value,o(b.staticResource,"creativeType")&&(e.mimeType=b.staticResource.creativeType),o(b,"apiFramework")&&(e.apiFramework=b.apiFramework),o(b,"adParameters")&&o(b.adParameters,"value")&&(e.adParameters=b.adParameters.value,o(b.adParameters,"xmlEncoded"))){if("boolean"!=typeof b.adParameters.xmlEncoded)throw new Error("VPTP "+f+" has adParameters.xmlEncoded with invalid type");e.adParametersXmlEncoded=b.adParameters.xmlEncoded}if(d?o(b,"companionClickThrough")&&(e.clickThroughUrl=b.companionClickThrough):o(b,"nonLinearClickThrough")&&(e.clickThroughUrl=b.nonLinearClickThrough),o(b,"assetWidth")&&(e.assetWidth=parseInt(b.assetWidth),isNaN(e.assetWidth)))throw new Error("VPTP "+f+" assetWidth is not a number");if(o(b,"assetHeight")&&(e.assetHeight=parseInt(b.assetHeight),isNaN(e.assetHeight)))throw new Error("VPTP "+f+" assetHeight is not a number");if(o(b,"expandedWidth")&&(e.expandedWidth=parseInt(b.expandedWidth),isNaN(e.expandedWidth)))throw new Error("VPTP "+f+" expandedWidth is not a number");if(o(b,"expandedHeight")&&(e.expandedHeight=parseInt(b.expandedHeight),isNaN(e.expandedWidth)))throw new Error("VPTP "+f+" expandedHeight is not a number");c.resources.push(e)}o(b,"iframeResource")&&(e=new a.adresponse.IFrameResource,e.url=b.iframeResource,c.resources.push(e)),b.hasOwnProperty("htmlResource")?(e=new a.adresponse.HtmlResource,e.source=b.htmlResource.value,c.resources.push(e)):b.hasOwnProperty("htmlresource")&&(e=new a.adresponse.HtmlResource,e.source=b.htmlresource.value,c.resources.push(e))}function i(b,c){b||(b={});for(var d=0;d<c.length;d++){var e=c[d];if(!o(e,"value"))throw new Error("VPTP Tracking object missing value property!");if(!o(e,"event"))throw new Error("VPTP Tracking object missing event property!");var f="";switch(e.event){case"3":case"4":case"91":f="";break;case"10":f="interaction";break;case"100":f="timeSpent";break;default:f=e.event}"acceptinvitationlinear"===f.toLowerCase()?f=a.tracking.Tracker.CreativeEventType.ACCEPT_INVITATION:"closelinear"===f.toLowerCase()&&(f=a.tracking.Tracker.CreativeEventType.CLOSE),f.length>0&&(o(b,f)||(b[f]={urls:[],blocked:!1}),b[f].urls.push({url:e.value.toString()}))}return b}function j(b,c){var d,e=null;if(o(c,"inLine"))e=c.inLine;else{if(!o(c,"wrapper"))return b;e=c.wrapper}var f=null;if(o(e,"extensions")){if(!o(e.extensions,"extension"))throw new Error("VPTP Extensions missing extension property!");if("[object Array]"!==Object.prototype.toString.call(e.extensions.extension))throw new Error("VPTP Extensions.extension should be array but is "+Object.prototype.toString.call(e.extensions.extension));if(e.extensions.extension.length>0)for(var g=e.extensions.extension,h=g.length,i=0;i<h;i++){var j=g[i];o(j,"adInfo")&&(f=j.adInfo)}}if(!b||!f)return b;if(o(f,"report")){o(b.trackingEvents,"report")||(b.trackingEvents.report={urls:[],blocked:!1});var l=/\[PASSBACK_INDEX\]|%5BPASSBACK_INDEX%5D/g,m=f.report.replace(l,encodeURIComponent(b.candidate));b.trackingEvents.report.urls=[{url:m,thirdParty:!1}]}if(o(f,"format")&&(b.type=f.format),o(f,"requestType")&&"lazy"===f.requestType&&null!==b.thirdPartyURL&&(b.lazyPrepared=!0),o(f,"timeout"))b.maximumPreparationTime=n(f.timeout);else if(a.adresponse.Ad.hasPassback(b))throw new Error("VPTP Extensions missing timeout value");if(o(f,"startAdTimeout")&&(b.startTimeout=n(f.startAdTimeout)),o(f,"variant")?b.variant=f.variant&&"normal"!==f.variant.toLowerCase()?"sponsor":"normal":b.variant="normal",o(f,"gid")&&(b.goalId=f.gid),o(f,"cid")&&(b.campaignId=f.cid),o(f,"customaid")&&(b.customId=f.customaid),o(f,"customgid")&&(b.customGoalId=f.customgid),o(f,"customcid")&&(b.customCampaignId=f.customcid),o(f,"allowLinearModeChange")&&(b.allowLinearModeChange="true"==f.allowLinearModeChange||"TRUE"==f.allowLinearModeChange),o(f,"countdown")&&(b.showCountdown="true"==f.countdown||"TRUE"==f.countdown),o(f,"exclusive")&&(b.partOfExclusiveCampaign="true"==f.exclusive||"TRUE"==f.exclusive),f.hasOwnProperty("labels")&&f.labels.hasOwnProperty("label")&&"[object Array]"===Object.prototype.toString.call(f.labels.label)&&f.labels.label.length>0)for(var p=0;p<f.labels.label.length;p++){var q=f.labels.label[p];q.hasOwnProperty("name")&&q.hasOwnProperty("value")&&(b.labels[q.name]=q.value)}o(f,"lastImpression")&&(d=Number(f.lastImpression)),o(f,"lastCompletion")&&(d=Number(f.lastCompletion));for(var r=b.creatives.filter(function(b,c,d){return b instanceof a.adresponse.LinearCreative||b instanceof a.adresponse.NonLinearCreative}),s=0;s<r.length;s++){var t=r[s];if(o(f,"showSkipButton")&&(f.showSkipButton===a.adresponse.LinearCreative.SkipButtonMode.ALWAYS?t.skipButtonMode=a.adresponse.LinearCreative.SkipButtonMode.ALWAYS:f.showSkipButton===a.adresponse.LinearCreative.SkipButtonMode.NEVER?t.skipButtonMode=a.adresponse.LinearCreative.SkipButtonMode.NEVER:f.showSkipButton===a.adresponse.LinearCreative.SkipButtonMode.AFTER_FIRST_COMPLETION&&(t.skipButtonMode=a.adresponse.LinearCreative.SkipButtonMode.AFTER_FIRST_COMPLETION),"after_first_impression"===f.showSkipButton&&(t.skipButtonMode=a.adresponse.LinearCreative.SkipButtonMode.AFTER_FIRST_COMPLETION)),f.hasOwnProperty("skipOffset")||f.hasOwnProperty("skipoffset")){var u,v=f.hasOwnProperty("skipoffset")?f.skipoffset:f.skipOffset;if(v.indexOf("%")>-1&&b&&b.creatives&&b.creatives[0]&&b.creatives[0].duration){var w=parseFloat(String(v).substring(0,v.indexOf("%")));u=(b.creatives[0].duration||0)*(w/100)}else u=n(v);t.skipOffset=u}o(f,"skipReset")&&(t.skipResetTime=n(f.skipReset)),t.lastCompletion=d}if(o(f,"companions")&&o(f.companions,"companion"))for(var x=f.companions.companion,p=0;p<x.length;++p)k(b,x[p]);return b}function k(a,b){var c=null;if(!o(b,"id"))throw new Error("VPTP Companion AdInfo is missing id");for(var d=0;d<a.companions.length;++d)if(a.companions[d].id===b.id){c=a.companions[d];break}if(null!==c){if(o(b,"customaid")&&(c.customId=b.customaid),!o(b,"zone"))throw new Error("VPTP Companion AdInfo is missing zone");c.zone=b.zone}}function l(b){var c=new a.adresponse.Ad;return c.type=a.adresponse.Ad.AdType.INVENTORY,b.type==a.adresponse.Ad.AdType.SPOT_SELECTOR?c.trackingEvents.error=b.ads[0].trackingEvents.error:c.trackingEvents.error=b.trackingEvents.error,c.parentSlot=b.parentSlot,c}function m(b){var c=[];if("[object Array]"!==Object.prototype.toString.call(b))throw new Error("VPTP Ticket conditions should be array but is "+Object.prototype.toString.call(b));for(var d=0;d<b.length;d++){var e,f=b[d];if(!o(f,"type"))throw new Error("VPTP condition is missing type property!");if("string"!=typeof f.type)throw new Error("VPTP condition type property should be string but is "+_typeof(f.type));if("EVENT"===f.type)e=new a.adresponse.EventCondition;else{if("PROPERTY"!==f.type)throw new Error("VPTP condition with unknown type: "+f.type);e=new a.adresponse.PropertyCondition}if(!o(f,"name"))throw new Error("VPTP condition is missing name property!");if("string"!=typeof f.name)throw new Error("VPTP condition name property should be string but is "+_typeof(f.name));if(e.type=f.name.toLowerCase().substr(0,1)+f.name.substr(1),e instanceof a.adresponse.PropertyCondition){if(o(f,"value")){if("string"!=typeof f.value)throw new Error("VPTP condition value property should be string but is "+_typeof(f.value));e.value=n(f.value)}if(o(f,"operator")){if("string"!=typeof f.operator)throw new Error("VPTP condition operator property should be string but is "+_typeof(f.operator));e.operator=f.operator.toLowerCase()}}if(o(f,"condition")){if("[object Array]"!==Object.prototype.toString.call(f.condition))throw new Error("VPTP condition condition property should be Array but is "+Object.prototype.toString.call(f.condition));e.conditions=m(f.condition)}c.push(e)}return c}function n(a){if(!a)return Number.NaN;var b=a.split(":");if(!b||0===b.length)return Number.NaN;var c=0;b.length>=1&&!1===isNaN(parseFloat(b[b.length-1]))&&(c=parseFloat(b[b.length-1]));var d=0;b.length>=2&&!1===isNaN(parseFloat(b[b.length-2]))&&(d=parseInt(b[b.length-2]));var e=0;return b.length>=3&&!1===isNaN(parseFloat(b[b.length-3]))&&(e=parseInt(b[b.length-3])),c+60*d+3600*e}function o(a,b){var c=[];for(var d in a)c.push({actual:d,lowerCase:d.toLowerCase()});for(var e=0;e<c.length;e++)if(c[e].lowerCase===b.toLowerCase()){if(c[e].actual===b)return!0;throw new Error("Invalid object property key! Expected: "+b+" but was: "+c[e].actual)}return!1}var p=function b(c){if(!(this instanceof a.adrequest.VPTP3Parser))return new b(c);this._previewMode=c};return p.prototype.parse=function(d){var e=new a.adresponse.Session;if(e.id=d.tid||"",e.language=d.lang||"",o(d,"trackingEvents")&&(e.trackingEvents=b(d.trackingEvents)),!o(d,"insertionPoint"))throw new Error("VPTP Ticket is missing insertionPoints!");return e.insertionPoints=c(d.insertionPoint,e,this._previewMode),e},p}()}(c),function(b){b.tracking.Tracker=function(){function c(a){var b;for(var c in a.trackingEvents)a.trackingEvents[c].blocked=!0;for(var d=0;d<a.creatives.length;++d){b=a.creatives[d];for(var c in b.trackingEvents)if("progress"===c)for(var e in b.trackingEvents.progress)b.trackingEvents.progress[e].blocked=!0;else b.trackingEvents[c].blocked=!0}}function d(a,c){if(!a.hasOwnProperty("trackingEvents")){var d=new b.LogItem;throw d.source=b.LogItem.SourceType.TRACKER,d.event=b.LogItem.EventType.INVALID_ARGUMENT,d.message="Missing trackingEvents property on the passed Session Object. Can not track event '"+c+"'.",s(this,d),new Error("Abort execution")}if(!a.trackingEvents.hasOwnProperty(c)){var d=new b.LogItem;throw d.source=b.LogItem.SourceType.TRACKER,d.event=b.LogItem.EventType.REQUEST_FAILED,d.message="Event '"+c+"' does not exist on the passed Session Object.",s(this,d),new Error("Abort execution")}if(a.trackingEvents[c].blocked){var d=new b.LogItem;throw d.source=b.LogItem.SourceType.TRACKER,d.event=b.LogItem.EventType.ILLEGAL_OPERATION,d.message="Can not track '"+c+"' more than once on the passed Session Object.",s(this,d),new Error("Abort execution")}a.trackingEvents[c].blocked=!0,f.apply(this,[a.secure,a.trackingEvents[c].urls])}function e(a,c){return function(error){if(!c){var d=new b.LogItem;d.source=b.LogItem.SourceType.TRACKER,d.event=b.LogItem.EventType.REQUEST_FAILED,d.message=error+". Failed to track URL : "+a.url,s(this,d)}}}function f(a,c,d,f){for(var g=this,h=void 0!==a&&a,i=new b.HTTPRequester(h),j=0;j<c.length;j++){var k=c[j];if(k){var l=e(k,f).bind(g),m=k.url.replace(A,encodeURIComponent(d));m=m.replace(B,encodeURIComponent(d)),m=m.replace(D,Math.floor(1e16*Math.random())),i.imgRequest(m,l)}}}function g(a,b,c){for(var d=a;d<y.length;++d)h.apply(this,[b,y[d],c,!0])}function h(a,c,d,e){var g=a,h=k(a);"error"===c&&(a instanceof b.adresponse.LinearCreative||a instanceof b.adresponse.NonLinearCreative)&&(a=a.parentAd);for(var i=Object.keys(a.trackingEvents),j=!1,l=0;l<i.length;l++)if(i[l].toLowerCase()===c.toLowerCase())if(a.trackingEvents[i[l]].blocked){if(!e){var m=new b.LogItem;throw m.source=b.LogItem.SourceType.TRACKER,m.event=b.LogItem.EventType.ILLEGAL_OPERATION,m.message="Can not track '"+c+"' more than once"+u(g),s(this,m),new Error("Abort execution")}}else z[c.toLowerCase()]&&(a.trackingEvents[i[l]].blocked=!0),f.apply(this,[h,a.trackingEvents[i[l]].urls,d,e]),j=!0;if(!j&&!e){var m=new b.LogItem;m.source=b.LogItem.SourceType.TRACKER,m.event=b.LogItem.EventType.WARNING,m.message="Event '"+c+"' does not exist"+u(g),s(this,m)}}function i(a,c){var d,e=!1,g=!1;if(a.trackingEvents.hasOwnProperty("progress")&&a.trackingEvents.progress.hasOwnProperty(c)){if(d=a.trackingEvents.progress[c],g=k(a),d.blocked){var h=new b.LogItem;throw h.source=b.LogItem.SourceType.TRACKER,h.event=b.LogItem.EventType.ILLEGAL_OPERATION,h.message="Can not track progress '"+c+"' more than once"+u(a),s(this,h),new Error("Abort execution")}d.blocked=!0,f.apply(this,[g,d.urls,0]),e=!0}if(!e){var h=new b.LogItem;h.source=b.LogItem.SourceType.TRACKER,h.event=b.LogItem.EventType.WARNING,h.message="Event 'progress' does not exist or offset is invalid"+u(a),s(this,h)}}function j(a){var b=null;try{b=a.parentSlot.parentInsertionPoint.parentSession}catch(c){}return b}function k(a){var c=!1,d=null;return a instanceof b.adresponse.Ad?d=j(a):(a instanceof b.adresponse.LinearCreative||a instanceof b.adresponse.NonLinearCreative)&&(d=j(a.parentAd)),d&&(c=d.secure),c}function l(c,d,e,j,m){var p=k(c);if(!c.hasOwnProperty("trackingEvents")){var q=new b.LogItem;throw q.source=b.LogItem.SourceType.TRACKER,q.event=b.LogItem.EventType.INVALID_ARGUMENT,q.message="Missing trackingEvents property. Can not track event '"+d+"'"+u(c),s(this,q),Error("Abort execution")}if(o(d)&&l.apply(this,[c,"interaction",a,a,!0]),n(d)||"error"===d){"progress"===d.toLowerCase()?i.apply(this,[c,j]):h.apply(this,[c,d,e]);var r;switch(d.toLowerCase()){case"complete":r=1;break;case"thirdquartile":r=2;break;case"midpoint":r=3;break;case"firstquartile":r=4;break;default:r=999}r<y.length&&g.apply(this,[r,c,e])}else if(c.trackingEvents.hasOwnProperty(d))if(z[d])if(c.trackingEvents[d].blocked){if("interaction"!==d&&!m){var q=new b.LogItem;throw q.source=b.LogItem.SourceType.TRACKER,q.event=b.LogItem.EventType.ILLEGAL_OPERATION,q.message="Can not track '"+d+"' more than once"+u(c),s(this,q),Error("Abort execution")}}else c.trackingEvents[d].blocked=!0,f.apply(this,[p,c.trackingEvents[d].urls,e]);else f.apply(this,[p,c.trackingEvents[d].urls,e]);else if(!m){var q=new b.LogItem;throw q.source=b.LogItem.SourceType.TRACKER,q.event=b.LogItem.EventType.INVALID_ARGUMENT,q.message="Custom tracking event '"+d+"' does not exist"+u(c),s(this,q),Error("Abort execution")}}function m(a){var b=a.split(":"),c=0;if(b.length>0)for(var d=0;d<b.length;d++)c+=Number(b[b.length-d-1]*(d?Math.pow(60,d):1));return c}function n(a){for(var c in b.tracking.Tracker.AdEventType)if(b.tracking.Tracker.AdEventType[c].toLowerCase()===a.toLowerCase())return!0;for(var c in b.tracking.Tracker.CreativeEventType)if(b.tracking.Tracker.CreativeEventType[c].toLowerCase()===a.toLowerCase())return!0;return!1}function o(a){for(var b in w)if(w[b].toLowerCase()===a.toLowerCase())return!0;return!1}function p(a){var c=k(a);a.hasOwnProperty("parentSlot")&&a.parentSlot instanceof b.adresponse.Slot&&a.parentSlot.hasOwnProperty("trackingEvents")&&a.parentSlot.trackingEvents.hasOwnProperty("slotStart")&&!a.parentSlot.trackingEvents.slotStart.blocked&&(a.parentSlot.trackingEvents.slotStart.blocked=!0,f.apply(this,[c,a.parentSlot.trackingEvents.slotStart.urls]))}function q(a,error,d){var e=a,f=!1;if((a instanceof b.adresponse.LinearCreative||a instanceof b.adresponse.NonLinearCreative)&&(f=!0,e=a.parentAd),d)if(!0===r("error",e)){var g=new b.LogItem;g.source=b.LogItem.SourceType.TRACKER,g.event=b.LogItem.EventType.ILLEGAL_OPERATION,g.message="Can not track 'error' more than once"+u(a),f&&(g.message=g.message.substring(0,g.message.length-1)+"'s parent ad."),s(this,g)}else if(!0===r("impression",e)){var g=new b.LogItem;g.source=b.LogItem.SourceType.TRACKER,g.event=b.LogItem.EventType.ILLEGAL_OPERATION,g.message="Can't track error since 'impression' has already been tracked for this item.",s(this,g)}else p.apply(this,[e]),l.apply(this,[a,"error",d]),c(e);else if(v.resolveErrorCode(new b.adresponse.Ad,error)||v.resolveErrorCode(new b.adresponse.LinearCreative,error)||v.resolveErrorCode(new b.adresponse.NonLinearCreative,error)){var g=new b.LogItem;g.source=b.LogItem.SourceType.TRACKER,g.event=b.LogItem.EventType.INVALID_ARGUMENT,g.message="Error type not supported for "+t(a)+".",s(this,g)}else{var g=new b.LogItem;g.source=b.LogItem.SourceType.TRACKER,g.event=b.LogItem.EventType.INVALID_ARGUMENT,g.message="Error type not supported.",s(this,g)}}function r(a,b){return b&&b.hasOwnProperty("trackingEvents")&&b.trackingEvents.hasOwnProperty(a)&&b.trackingEvents[a].hasOwnProperty("blocked")&&!0===b.trackingEvents[a].blocked}function s(a,b){for(var c=0;c<a._logCallbacks.length;++c)a._logCallbacks[c](b)}function t(a){return a instanceof b.adresponse.Ad?"Ad":a instanceof b.adresponse.LinearCreative?"LinearCreative":a instanceof b.adresponse.NonLinearCreative?"NonLinearCreative":a instanceof b.adresponse.Companion?"Companion":""}function u(a){return a instanceof b.adresponse.Ad?" on the passed Ad Object.":a instanceof b.adresponse.LinearCreative?" on the passed LinearCreative Object.":a instanceof b.adresponse.NonLinearCreative?" on the passed NonLinearCreative Object.":a instanceof b.adresponse.Companion?" on the passed Companion Object.":""}var v=function a(){if(!(this instanceof b.tracking.Tracker))return new a;this._logCallbacks=[],this.previewMode=!1},w={MUTE:"mute",UNMUTE:"unmute",PAUSE:"pause",REWIND:"rewind",RESUME:"resume",ACCEPT_INVITATION:"acceptinvitation",EXPAND:"expand",FULLSCREEN:"fullscreen",COLLAPSE:"collapse",EXIT_FULLSCREEN:"exitfullscreen",CLICKTHROUGH:"clickthrough",CLOSE:"close"},x={xmlParsingError:100,vastValidationError:101,vastResponseError:102,adTypeNotSupportedError:200,adLinearityError:201,wrapperError:300,wrapperTimeoutError:301,noVASTResponseError:303,generalLinearError:400,linearMediaFileNotFoundError:401,mediaFileTimeoutError:402,noSupportedMediaFileFoundError:403,mediaFileDisplayError:405,generalNonlinearError:500,nonlinearMediaFileNotFoundError:502,noSupportedNonLinearResourceFoundError:503,undefinedError:900},y=["complete","thirdQuartile","midpoint","firstQuartile","start"],z={startcontent:"startcontent",impression:"impression",complete:"complete",thirdquartile:"thirdquartile",midpoint:"midpoint",firstquartile:"firstquartile",start:"start",interaction:"interaction",creativeview:"creativeview"};v.prototype.reportPulseError=function(a,c){var d=function(a){var c=[];return a&&a instanceof b.adresponse.Ad&&a.trackingEvents.hasOwnProperty("report")&&!a.trackingEvents.report.blocked&&a.trackingEvents.report.urls.length>0&&(a.trackingEvents.report.blocked=!0,c.push(a.trackingEvents.report.urls.pop())),c},e=d(a);if(e.length>0){for(var g=0;g<e.length;g++){var h=e[g].url;h&&-1===h.indexOf("PULSE_ERROR")&&-1===h.indexOf("PASSBACK_INDEX")&&(h+=(h.indexOf("?")>-1?"&":"?")+"[AAB_PULSE_ERROR]="+c+"&[AAB_PASSBACK_INDEX]="+a.candidate,e[g].url=h)}f(k(a),e,c||900,!0)}},v.prototype.reportError=function(a,error){var c=v.resolveErrorCode(a,error);if(!this.previewMode)if(a instanceof b.adresponse.Ad||a instanceof b.adresponse.LinearCreative||a instanceof b.adresponse.NonLinearCreative)q.apply(this,[a,error,c]);else if(a instanceof b.adresponse.Companion){
var d=new b.LogItem;d.source=b.LogItem.SourceType.TRACKER,d.event=b.LogItem.EventType.INVALID_ARGUMENT,d.message="Cannot report errors on Companion ads.",s(this,d)}else{var d=new b.LogItem;d.source=b.LogItem.SourceType.TRACKER,d.event=b.LogItem.EventType.INVALID_ARGUMENT,d.message="Not a trackable object.",s(this,d)}},v.prototype.trackEvent=function(a,c,e){if(!this.previewMode){if(!c||""===c){var f=new b.LogItem;return f.source=b.LogItem.SourceType.TRACKER,f.event=b.LogItem.EventType.INVALID_ARGUMENT,f.message="Event passed can not be an empty string.",void s(this,f)}if("error"===c){var f=new b.LogItem;return f.source=b.LogItem.SourceType.TRACKER,f.event=b.LogItem.EventType.INVALID_ARGUMENT,f.message='"error" must be tracked using reportError()',void s(this,f)}if(a instanceof b.adresponse.Session)try{d.apply(this,[a,c])}catch(g){}else if(a instanceof b.adresponse.Ad)if(!0===r("error",a)){var f=new b.LogItem;f.source=b.LogItem.SourceType.TRACKER,f.event=b.LogItem.EventType.ILLEGAL_OPERATION,f.message="Can not track any more events after reporting error on the passed Ad Object.",s(this,f)}else try{p.apply(this,[a]),l.apply(this,[a,c])}catch(g){}else if(a instanceof b.adresponse.LinearCreative||a instanceof b.adresponse.NonLinearCreative||a instanceof b.adresponse.Companion)if(null!=a.parentAd&&!0===r("error",a.parentAd)){var f=new b.LogItem;f.source=b.LogItem.SourceType.TRACKER,f.event=b.LogItem.EventType.ILLEGAL_OPERATION,f.message="Can not track any more events after reporting error on the passed Ad Object.",s(this,f)}else try{l.apply(this,[a,c,0,e])}catch(g){}else{var f=new b.LogItem;f.source=b.LogItem.SourceType.TRACKER,f.event=b.LogItem.EventType.INVALID_ARGUMENT,f.message="Invalid object passed. Can not track event '"+c+"'. Object passed should be of type Session, Ad, Creative or Companion.",s(this,f)}}},v.prototype.addLogListener=function(a){a&&"function"==typeof a&&this._logCallbacks.push(a)};var A=/\[ERRORCODE\]|%5BERRORCODE%5D/g,B=/\[PULSE_ERROR\]|%5BPULSE_ERROR%5D/g,C=/\[c\]|%5Bc%5D/g,D=/\[CACHEBUSTING\]|%5BCACHEBUSTING%5D/g;return v.prototype.trackProgress=function(a,c){if(!(a instanceof b.adresponse.LinearCreative)){var d=new b.LogItem;return d.source=b.LogItem.SourceType.TRACKER,d.event=b.LogItem.EventType.INVALID_ARGUMENT,d.message="Progress can only be tracked on LinearCreative objects.",void s(this,d)}if(a.trackingEvents.progress){var e,f=[];for(var g in a.trackingEvents.progress){if(e=null,g.indexOf("%")>-1&&a.duration>0){var h=parseFloat(String(g).substring(0,g.indexOf("%")));e=isNaN(h)?null:a.duration*(h/100)}else e=m(g);null!==e&&e<=c&&f.push(g)}for(var j=0;j<f.length;++j)if(!a.trackingEvents.progress[f[j]].blocked)try{i.call(this,a,f[j])}catch(k){}}},v.resolveErrorCode=function(a,error){var c;if(a instanceof b.adresponse.Ad)switch(error){case b.tracking.Tracker.AdError.TYPE_NOT_SUPPORTED:c=x.adTypeNotSupportedError;break;case b.tracking.Tracker.AdError.NO_AD:c=x.noVASTResponseError;break;case b.tracking.Tracker.AdError.GENERAL_ERROR:c=x.generalLinearError}else if(a instanceof b.adresponse.LinearCreative)switch(error){case b.tracking.Tracker.CreativeError.MEDIA_FILE_NOT_FOUND:c=x.linearMediaFileNotFoundError;break;case b.tracking.Tracker.CreativeError.MEDIA_FILE_TIMEOUT:c=x.mediaFileTimeoutError;break;case b.tracking.Tracker.CreativeError.NO_SUPPORTED_MEDIA_FILE_FOUND:c=x.noSupportedMediaFileFoundError;break;case b.tracking.Tracker.CreativeError.MEDIA_FILE_DISPLAY_ERROR:c=x.mediaFileDisplayError}else if(a instanceof b.adresponse.NonLinearCreative)switch(error){case b.tracking.Tracker.CreativeError.MEDIA_FILE_NOT_FOUND:c=x.nonlinearMediaFileNotFoundError;break;case b.tracking.Tracker.CreativeError.MEDIA_FILE_TIMEOUT:c=x.mediaFileTimeoutError;break;case b.tracking.Tracker.CreativeError.NO_SUPPORTED_MEDIA_FILE_FOUND:c=x.noSupportedNonLinearResourceFoundError;break;case b.tracking.Tracker.CreativeError.MEDIA_FILE_DISPLAY_ERROR:c=x.mediaFileDisplayError}return c},v.prototype.trackTimeSpent=function(c,d){if(!(d instanceof b.adresponse.LinearCreative||d instanceof b.adresponse.NonLinearCreative)){var e=new b.LogItem;return e.source=b.LogItem.SourceType.TRACKER,e.event=b.LogItem.EventType.INVALID_ARGUMENT,e.message="'timeSpent' can only be tracked on LinearCreative and NonLinearCreative objects.",void s(this,e)}if(!0===r("error",d)){var e=new b.LogItem;return e.source=b.LogItem.SourceType.TRACKER,e.event=b.LogItem.EventType.ILLEGAL_OPERATION,e.message="Can not track any more events after reporting error on the passed creative.",void s(this,e)}if(!d.trackingEvents.hasOwnProperty("timeSpent")){var e=new b.LogItem;return e.source=b.LogItem.SourceType.TRACKER,e.event=b.LogItem.EventType.INVALID_ARGUMENT,e.message="Event 'timeSpent' does not exist on the passed object.",void s(this,e)}if(isNaN(c)||!isFinite(c)||c<0){var e=new b.LogItem;return e.source=b.LogItem.SourceType.TRACKER,e.event=b.LogItem.EventType.INVALID_ARGUMENT,e.message="'timeSpent' must be tracked with a positive number.",void s(this,e)}var g=d.trackingEvents.timeSpent.urls[0].url,h=Math.floor(c),i=g.replace(C,h);i=i.replace(D,Math.floor(1e16*Math.random()));var j=k(d);h>0&&f.call(this,j,[{url:i}],a,!0)},v}(),b.tracking.Tracker.SessionEventType={CONTENT_START:"contentStart"},b.tracking.Tracker.AdEventType={IMPRESSION:"impression"},b.tracking.Tracker.CreativeEventType={CREATIVE_VIEW:"creativeview",START:"start",FIRST_QUARTILE:"firstquartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdquartile",COMPLETE:"complete",PROGRESS:"progress",CLICKTHROUGH:"clickthrough",MUTE:"mute",UNMUTE:"unmute",PAUSE:"pause",REWIND:"rewind",RESUME:"resume",FULLSCREEN:"fullscreen",EXIT_FULLSCREEN:"exitfullscreen",EXPAND:"expand",COLLAPSE:"collapse",ACCEPT_INVITATION:"acceptinvitation",CLOSE:"close",SKIP:"skip"},b.tracking.Tracker.AdError={TYPE_NOT_SUPPORTED:"adTypeNotSupportedError",NO_AD:"noAdError",GENERAL_ERROR:"generalAdError"},b.tracking.Tracker.CreativeError={MEDIA_FILE_NOT_FOUND:"mediaFileNotFoundError",MEDIA_FILE_TIMEOUT:"mediaFileTimeoutError",NO_SUPPORTED_MEDIA_FILE_FOUND:"noSupportedMediaFileFoundError",MEDIA_FILE_DISPLAY_ERROR:"mediaFileDisplayError"},b.tracking.Tracker.PulseError={START_AD_TIMEOUT_ERROR:1,PASSBACK_TIMEOUT_ERROR:2,XML_PARSING_ERROR:100,VAST_VALIDATION_ERROR:101,VAST_RESPONSE_ERROR:102,AD_TYPE_NOT_SUPPORTED_ERROR:200,AD_LINEARITY_ERROR:201,WRAPPER_ERROR:300,WRAPPER_TIMEOUT_ERROR:301,NO_VAST_RESPONSE_ERROR:303,GENERAL_LINEAR_ERROR:400,LINEAR_MEDIA_FILE_NOT_FOUND_ERROR:401,MEDIA_FILE_TIMEOUT_ERROR:402,NO_SUPPORTED_MEDIA_FILE_FOUND_ERROR:403,MEDIA_FILE_DISPLAY_ERROR:405,UNDEFINED_ERROR:900}}(c),function(a){a.LogItem=function(){return function b(c){if(!(this instanceof a.LogItem))return new b;this.source="",this.event=a.LogItem.EventType.GENERAL_ERROR,this.errorCode=null,this.message="",this.thirdPartySourceURLs=[]}}(),a.LogItem.SourceType={AD:"ad",SESSION:"session",TRACKER:"tracker"},a.LogItem.EventType={NO_AD_RESPONSE:"noAd",INVALID_ARGUMENT:"invalidArgument",INVALID_RESPONSE:"invalidResponse",GENERAL_ERROR:"generalError",REQUEST_FAILED:"requestFailed",REQUEST_TIMEOUT:"requestTimeout",REQUEST_CANCELED:"requestCanceled",WARNING:"warning",ILLEGAL_OPERATION:"illegalOperation"}}(c),function(a){a.HTML5HTTPRequester=function(){var b=function b(c){if(!(this instanceof a.HTML5HTTPRequester))return new b(c);c=c||{},this._withoutCredentials=c.withoutCredentials||!1};return b.prototype.request=function(b,c,d,e){var f,g,h="GET";if(e=e||12e3,c||(c=function(){}),d||(d=function(){}),window.XMLHttpRequest)if("withCredentials"in(f=new window.XMLHttpRequest)){if(!0!==this._withoutCredentials)try{f.withCredentials=!0}catch(i){}try{f.open(h,b,!0),f.timeout=e,g=!1}catch(i){return void d(a.httpErrorCodeTranslation[0])}f.onreadystatechange=function(){4===f.readyState&&(200===f.status?c(f.responseText):g||d(a.httpErrorCodeTranslation[f.status]||"unknownError"))};try{f.send()}catch(i){d("unknownError")}}else if(window.XDomainRequest){f=new window.XDomainRequest,f.onload=function(){c(f.responseText)},f.onerror=function(){d(a.httpErrorCodeTranslation.ieError||"unknownError")},f.onprogress=function(){},f.ontimeout=function(){};try{f.open(h,b),f.timeout=e,f.send()}catch(i){d(a.httpErrorCodeTranslation.ieError||"unknownError")}}else d("corsNotSupportedInBrowser");return function(a){g=!0,f.abort(),f=null,c=function(){},d(a)}},b.prototype.postRequest=function(b,c,d,e,f){var g,h,i="POST";f=f||12e3,d||(d=function(){}),e||(e=function(){});var j=[];for(var k in c)j.push(k+"="+c[k]);if(j=j.join("&"),window.XMLHttpRequest)if("withCredentials"in(g=new window.XMLHttpRequest)){try{g.withCredentials=!0}catch(l){}try{g.open(i,b,!0),g.timeout=f,h=!1}catch(l){return void e(a.httpErrorCodeTranslation[0])}g.onreadystatechange=function(){4===g.readyState&&(200===g.status?d(g.responseText):h||e(a.httpErrorCodeTranslation[g.status]||"unknownError"))};try{g.send(j)}catch(l){e("unknownError")}}else if(window.XDomainRequest){g=new window.XDomainRequest,g.onload=function(){d(g.responseText)},g.onerror=function(){e(a.httpErrorCodeTranslation.ieError||"unknownError")},g.onprogress=function(){},g.ontimeout=function(){};try{g.open(i,b),g.timeout=f,g.send(j)}catch(l){e(a.httpErrorCodeTranslation.ieError||"unknownError")}}else e("corsNotSupportedInBrowser");return function(a){h=!0,g.abort(),g=null,d=function(){},e(a)}},b}()}(c),function(a,b){a.HTTPRequester=function(){function c(a){for(var b=0;b<f.length;++b)if(f[b]===a)return void f.splice(b,1)}function d(){return!(!b||!b.Pulse||b.Pulse.Settings.DISABLE_FLASH)&&b.Pulse.Utils.isFlashAvailable()}function e(a){return b&&b.Pulse&&b.Pulse.HTTPRequesterOverride&&b.Pulse.HTTPRequesterOverride.hasOwnProperty(a)}a.httpErrorCodeTranslation={503:"Service unavailable",500:"Internal server error",404:"The requested resource could not be found",400:"Bad request",0:"Request could not be sent to the server",ieError:"Request failed",secureError:"The request could not be sent as the SDK has been configured to only allow requests over HTTPS"};var f=[],g=function(a){return this._secure&&0===a.toLowerCase().indexOf("http:")},h=function c(e,f){if(!(this instanceof a.HTTPRequester))return new c(e);this._secure=void 0!==e&&e,this._HTMLrequester=new a.HTML5HTTPRequester({withoutCredentials:f}),d()&&(this._flashRequester=new b.Pulse.Flash.FlashHTTPRequester)};return h.prototype.request=function(c,f,h,i){var j,k;return g.call(this,c)?void h(a.httpErrorCodeTranslation.secureError||"unknownError"):(j=e("request")?b.Pulse.HTTPRequesterOverride.request(c,f,h,i):this._HTMLrequester.request(c,f,function(error){if(d())if("corsNotSupportedInBrowser"===error||error===a.httpErrorCodeTranslation[0]){"corsNotSupportedInBrowser"===error&&(error="CORS does not appear to be correctly configured on the server.");try{k=this._flashRequester.request(c,f,h,i)}catch(g){h(error)}}else h(error);else e("request")?b.Pulse.HTTPRequesterOverride.request(c,f,h,i):h(error)}.bind(this),i),function(a){k?k(a):j(a)})},h.prototype.postRequest=function(c,f,h,i,j){var k,l;return g.call(this,c)?void i(a.httpErrorCodeTranslation.secureError||"unknownError"):(k=e("postRequest")?b.Pulse.HTTPRequesterOverride.postRequest(c,h,i,j):this._HTMLrequester.request(c,h,function(error){if(d())if("corsNotSupportedInBrowser"===error||error===a.httpErrorCodeTranslation[0]){"corsNotSupportedInBrowser"===error&&(error="CORS does not appear to be correctly configured on the server.");try{l=this._flashRequester.postRequest(c,f,h,i,j)}catch(b){i(error)}}else i(error);else i(error)}.bind(this),j),function(a){l?l(a):k(a)})},h.prototype.imgRequest=function(d,h){if(g.call(this,d))return void h(a.httpErrorCodeTranslation.secureError||"unknownError");if(e("imgRequest"))b.Pulse.HTTPRequesterOverride.imgRequest(d,h);else{var i=document.createElement("img");f.push(i);var j=function(){c(i)};i.onload=j,i.onerror=j,i.setAttribute("src",d)}},h}()}(c,b),function(b){if(null!==b.Pulse&&"object"===_typeof(b.Pulse))return void(b.Pulse.Utils.log&&b.Pulse.Utils.log("The Pulse SDK has already been loaded once; ignoring reload to preserve internal state"));b.Pulse=function(){function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:3&b|8).toString(16)})}function f(a){return b.Pulse.Utils.isFlashAvailable()&&!0!==b.Pulse.Settings.DISABLE_FLASH?a||b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_FIRST:(b.Pulse.Utils.log("Flash is blocked or not available; rendering mode will be HTML5 only"),b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_ONLY)}var g=function(){this._tracker=new c.tracking.Tracker;var a=this;this._tracker.addLogListener(function(b){a._logListener&&a._logListener(b)}),this._adRequester=null,this._logListener=null,this._adPlayers={},this._adPlayerCreationListeners=[]};g.prototype={setPulseHost:function(a,d,e,f){if("string"!=typeof a)throw new Error("pulseHost must be provided and be of type string.");var g=a;b.Pulse.Utils.isPageLevelDebugActivated()&&(b.Pulse.debug=!0);var h=parseInt(b.Pulse.Utils.readKeyValue(b.Pulse.Storage.LAST_AD_TIME));isNaN(h)||h>Date.now()?this._lastAdTime=new Date(0):this._lastAdTime=new Date(h),0===a.lastIndexOf("//")?g=window.location.protocol+a:0!==a.lastIndexOf("http://")&&0!==a.lastIndexOf("https://")&&(g="http://"+a),g.lastIndexOf("/")===g.length-1&&(g=g.slice(0,-1)),b.Pulse.AdPlayer.Settings._FLASH_AD_PLAYER_URL||(b.Pulse.AdPlayer.Settings._FLASH_AD_PLAYER_URL=g+b.Pulse.AdPlayer.Settings._BASE_FLASH_RESOURCES_PATH+b.Pulse.AdPlayer.Settings._FLASH_AD_PLAYER_FILE_NAME),b.Pulse.AdPlayer.Settings._FLASH_AD_REQUESTER_URL||(b.Pulse.AdPlayer.Settings._FLASH_AD_REQUESTER_URL=g+b.Pulse.AdPlayer.Settings._BASE_FLASH_RESOURCES_PATH+b.Pulse.AdPlayer.Settings._FLASH_AD_REQUESTER_FILE_NAME),this._adRequester=new c.adrequest.AdRequester(g,{deviceContainer:d,persistentId:e,ignoreSecure:f}),b.Pulse.Utils.log(b.Pulse.Utils.formatString("Using Pulse host {host}, secure mode {isSecure}; SDK version is {version}",{host:g,version:b.Pulse.Version,isSecure:f?"off":"on"}));var i=this;this._adRequester.addLogListener(function(a){i._logListener&&i._logListener(a)})},requestSession:function(a,c){c&&c.loadAdRequesterTimeout&&b.Pulse.Flash.HTTPRequesterManager.setRequesterTimeout(c.loadAdRequesterTimeout||b.Pulse.Settings.DEFAULT_FLASH_REQUESTER_LOAD_TIMEOUT);var d=b.Pulse.Utils.getAdPreviewIfAvailable();return d&&(b.Pulse._instance.previewMode=!0,b.Pulse._instance._tracker.previewMode=!0,c?c.pulse_preview=d:c={pulse_preview:d}),c&&!c.maxBitRate&&(c.maxBitRate=b.Pulse.maxBitRate),new b.Pulse.SessionImplementation(a,c)},createAdPlayer:function(a,c,d,f,g,h,i,j,k,l){var m=e(),n=new b.Pulse.AdPlayerController(a,c,d,f,m,g,h,i,j,k,l);return this._adPlayers[m]=n,n},_adPlayed:function(a){a.getTime()>this._lastAdTime.getTime()&&(this._lastAdTime=a,b.Pulse.Utils.saveKeyValue(b.Pulse.Storage.LAST_AD_TIME,a.getTime()))},_getPlayerForUniqueId:function(a){return this._adPlayers[a]},getAdPlayers:function(){return this._adPlayers},setLogListener:function(a){a&&"function"==typeof a&&(this._logListener=a)}};var h={_instance:null,debug:!1,InsertionPointType:{ON_BEFORE_CONTENT:"onBeforeContent",PLAYBACK_POSITION:"playbackPosition",ON_CONTENT_END:"onContentEnd",ON_PAUSE:"onPause",PLAYBACK_TIME:"playbackTime"},ContentForm:{SHORT_FORM:"shortForm",LONG_FORM:"longForm"},AdBreakPosition:{PREROLL:"preroll",MIDROLL:"midroll",POSTROLL:"postroll"},createSession:function(a,b){if(!h._instance)throw"You must set your Pulse host before creating a session.";return h._instance.requestSession(a,b)},createAdPlayer:function(a,c,d,e,i){var j,k;if(a instanceof HTMLElement);else{if(!(a instanceof Object))throw new Error("Expected first argument to be instance of HTMLElement or Object");var l=a;a=l.adContainerElement,c=l.uiOptions,d=l.sharedVideoElement,e=l.customBehaviours,i=l.identifier,j=l.setAutoplayAttributes,k=l.playInline}!b.Pulse.Settings.DISABLE_FLASH&&c&&c.renderingMode===b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_ONLY?b.Pulse.Settings.DISABLE_FLASH=!0:!0===b.Pulse.Settings.DISABLE_FLASH&&c&&c.renderingMode!==b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_ONLY&&b.Pulse.Utils.log(b.Pulse.Utils.formatString("Rendering mode {renderingMode} can not be used, since Flash has been disabled, the only valid rendering mode is 'HTML5_ONLY'!",{renderingMode:c.renderingMode}));var m=c||{},n=m.width||b.Pulse.AdPlayer.Settings.SCALING.AUTO,o=m.height||b.Pulse.AdPlayer.Settings.SCALING.AUTO,p=m.VPAIDViewMode||b.Pulse.AdPlayer.Settings.VPAIDViewMode.NORMAL,q=f(m.renderingMode),r=null;null===h._instance&&(h._instance=new g),r=h._instance.createAdPlayer(a,n,o,p,q,d,e,i,j,k);for(var s=0,t=h._instance._adPlayerCreationListeners.length;s<t;s++)try{h._instance._adPlayerCreationListeners[s](r)}catch(u){console.error("Error in ad player listener ",u.stack)}return r},adPlayerReady:function(a){null===h._instance&&(h._instance=new g),h._instance._adPlayerCreationListeners.push(a)},setPulseHost:function(a,c,d,e,f){null===h._instance&&(h._instance=new g),!1!==f&&!0!==f||(b.Pulse.Settings.DISABLE_FLASH=f),h._instance.setPulseHost(a,c,d,e),b.Pulse.Utils.testBandwidthKbps(a+b.Pulse.AdPlayer.Settings._BW_DETECTION_IMAGE,function(a){a>0&&(b.Pulse.maxBitRate=a,b.Pulse.Utils.log("Available bandwidth (kbps/s) detected: "+a))})},setLogListener:function(a){null===h._instance&&(h._instance=new g),this._instance.setLogListener(a)},canAutoplay:function(){return("undefined"==typeof bowser?"undefined":_typeof(bowser))===a?(b.Pulse.Utils.log("canAutoplay: bowser is not present, going to assume false"),!1):bowser.mobile||bowser.tablet?(b.Pulse.Utils.log("canAutoplay: "+(bowser.mobile?"Mobile":"Tablet")+" detected"),!1):bowser.safari&&bowser.version>=11?(b.Pulse.Utils.log("Safari 11+ detected"),!1):(b.Pulse.Utils.log("Autoplay-supporting browser detected: ",bowser.name,bowser.version),!0)},getAutoplayMode:function(){if(("undefined"==typeof bowser?"undefined":_typeof(bowser))===a)return b.Pulse.Utils.log("getAutoplayMode: bowser is not present, going to recommend shared mode"),"shared";if(bowser.mobile||bowser.tablet)return b.Pulse.Utils.log("getAutoplayMode: "+(bowser.mobile?"Mobile":"Tablet")+"detected; recommend shared mode"),"shared";for(var c=0;c<d.length;++c){var e=d[c];if(bowser[e.name]&&bowser.version>=e.minVersion)return"muted"}return"normal"},_fromFlash:function(a,b,c){null!==h._instance&&this._instance._getPlayerForUniqueId(a)._onFlashPlayerEvent(b,c)}};return h}();var d=[{name:"safari",minVersion:"11"},{name:"chrome",minVersion:"66"}];b.Pulse.Storage={LAST_AD_TIME:"pulseLastAdTime"},b.Pulse.Settings={DEFAULT_FLASH_REQUESTER_LOAD_TIMEOUT:1e3,VPAID_COMPLETE_DELAY:0,DISABLE_FLASH:!1,DISABLE_WO:!1},b.Pulse.Version="2.1.19.4.0",b.Pulse.maxBitRate=800,b.PulseAdError={REQUEST_FAILED:"requestFailed",TIMED_OUT:"timedOut",NO_SUPPORTED_MEDIA_FILE:"noSupportedMediaFile",COULD_NOT_PLAY:"couldNotPlay"},b.Pulse.AutoplayMode={NORMAL:"normal",MUTED:"muted",SHARED:"shared"},b.Pulse.SeekMode={IGNORE:"ignore",PLAY_FIRST:"playFirst",PLAY_LAST:"playLast",PLAY_ALL:"playAll"},b.Pulse.Live={DISABLE_ALL:"disableAll",ALL_TRACKINGS:"allTrackings",SESSION_LOOKUP:"sessionLookup",LOCATION_LOOKUP:"locationLookup",REAL_TIME_BIDDING:"realTimeBidding"},b.Pulse.PreferredMediaFormat={WEBM:"video/webm",MP4:"video/mp4",OGG:"video/ogg"},b.Pulse.AdPlayer={Linear:{Video:{},VPAID:{}},Settings:{VPAIDViewMode:{NORMAL:"normal",FULLSCREEN:"fullscreen",THUMBNAIL:"thumbnail"},RenderingMode:{HTML5_FIRST:"HTML5_FIRST",FLASH_FIRST:"FLASH_FIRST",HTML5_ONLY:"HTML5_ONLY",FLASH_ONLY:"FLASH_ONLY"},SCALING:{AUTO:-1},_FLASH_AD_PLAYER_FILE_NAME:"pulse_flash_ad_player_2.1.19.4.0.swf",_FLASH_AD_REQUESTER_FILE_NAME:"pulse_flash_ad_requester_2.1.19.4.0.swf",_BASE_FLASH_RESOURCES_PATH:"/proxy/pulse-sdk-html5/2.1/",_FLASH_AD_PLAYER_URL:"",_FLASH_AD_REQUESTER_URL:"",_BW_DETECTION_IMAGE:"/proxy/bwtest.jpg"},Events:{SESSION_STARTED:"sessionStarted",LINEAR_AD_STARTING:"linearAdStarting",LINEAR_AD_STARTED:"linearAdStarted",LINEAR_AD_IMPRESSION:"linearAdImpression",LINEAR_AD_FIRST_QUARTILE:"linearAdFirstQuartile",LINEAR_AD_MIDPOINT:"linearAdMidpoint",LINEAR_AD_THIRD_QUARTILE:"linearAdThirdQuartile",AD_BREAK_STARTING:"linearAdBreakStarting",AD_BREAK_STARTED:"linearAdBreakStarted",AD_BREAK_FINISHING:"linearAdBreakFinishing",AD_BREAK_FINISHED:"linearAdBreakFinished",AD_BREAK_EMPTY:"linearAdBreakEmpty",LINEAR_AD_SKIPPED:"linearAdSkipped",LINEAR_AD_FINISHED:"linearAdFinished",LINEAR_AD_ERROR:"linearAdError",AD_CLICKTHROUGH:"adClickThrough",LINEAR_AD_PROGRESS:"linearAdProgress",SHOW_SKIP_BUTTON:"showSkipButton",LINEAR_AD_PAUSED:"linearAdPaused",LINEAR_AD_PLAYING:"linearAdPlaying",AD_VOLUME_CHANGED:"adVolumeChanged",AD_CLICKED:"adClicked",AD_AUTOPLAY_BLOCKED:"adAutoplayBlocked",FLASH_AD_BLOCKED:"flashAdBlocked",AD_SESSION_FINISHED:"adSessionFinished",PAUSE_AD_SHOWN:"pauseAdShown",PAUSE_AD_CLOSED:"pauseAdClosed",PAUSE_AD_PLAYER_HIDDEN:"pauseAdPlayerHidden",OVERLAY_AD_SHOWN:"overlayAdShown",OVERLAY_AD_CLICKED:"overlayAdClicked",OVERLAY_AD_COLLAPSED:"overlayAdCollapsed",OVERLAY_AD_CLOSED:"overlayAdClosed",OVERLAY_AD_ERROR:"overlayAdError",AD_PLAY_PROMISE_REJECTED:"adPlayPromiseRejected"}}}(b),function(a,b){function c(){try{try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{a.AllowScriptAccess="always"}catch(b){return"6,0,0"}}catch(b){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){}}return"0,0,0"}function d(){if(navigator){if(/MSIE 10/i.test(navigator.userAgent))return!0;if(/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent))return!0;if(/Edge\/\d./i.test(navigator.userAgent))return!0}return!1}function e(){return void 0!==window.__karma__}function f(){var a={},b=[];try{window&&(b=window.top&&window.top.location?window.top.location.search.split("&"):window.location.search.split("&"))}catch(e){return b}b&&b[0]&&(b[0]=b[0].slice(1));for(var c=0;c<b.length;c++)if(b[c]){var d=b[c].split(/=/);a[d[0]]=d[1]}return a}function g(a,b,c){if(d()||e())a.unshift(b.join(" / ")+": ");else{for(var f=0;f<c.length;++f)a.unshift("padding:1px;border-radius:3px;margin-left:1px;background:"+c[f]+";color:#fff;");a.unshift("%c "+b.join("%c"))}}function h(a){return Array.prototype.slice.call(a)}a.Pulse.Utils={isFlashAvailable:function(){return c().split(",").shift()>=11},logTagged:function(){if(void 0!==window.console&&"function"==typeof window.console.log&&a.Pulse.debug){for(var b=["Pulse "],c=["#3d5c8e"],d=h(arguments),e=d.splice(0,1)[0],f=0;f<e.length;++f)e[f].tag&&e[f].color&&(b.push(e[f].tag),c.push(e[f].color));c.reverse(),g(d,b,c),window.console.log.apply(window.console,d)}},log:function(){var b=h(arguments);b.unshift([]),a.Pulse.Utils.logTagged.apply(null,b)},logNewline:function(){void 0!==window.console&&"function"==typeof window.console.log&&a.Pulse.debug&&console.log("")},isPageLevelDebugActivated:function(){var a=f();return a&&a.hasOwnProperty("pulse_debug")},getAdPreviewIfAvailable:function(){var a=f();return a&&a.hasOwnProperty("pulse-preview")?a["pulse-preview"]:a&&a.hasOwnProperty("pulse_preview")?a.pulse_preview:a&&a.hasOwnProperty("vp-preview")?a["vp-preview"]:null},saveKeyValue:function(b,c){if(a.Pulse.Utils.log("Saving value "+c+" for key "+b+" to local storage"),"undefined"!=typeof Storage)try{localStorage.setItem(b,c)}catch(d){a.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],"Error saving "+b+". The following exception was thrown:",d)}else a.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],"Couldn't save value "+c+" for key "+b+" to local storage")},readKeyValue:function(b){if("undefined"==typeof Storage)return a.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],"Couldn't read key "+b+" from local storage"),null;try{return localStorage.getItem(b)}catch(c){return a.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],"Error reading "+b+". The following exception was thrown:",c),null}},formatString:function(a,b){if(!a||!b||!Object.keys)return a;for(var c,d,e=Object.keys(b),f=0;f<e.length;++f)c=e[f],(d=b[e[f]])&&(a=a.replace("{"+c+"}",d));return a},getStaticResourceFlashHTML:function(a){return'<object codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" width="$WIDTH" height="$HEIGHT" id="banner_$ZONE"> <param name="movie" value="$URL"/> <param name="allowScriptAccess" value="always"/> <param name="flashvars" value="clickTAG=$CLICKTHROUGH_URL&clickTag=$CLICKTHROUGH_URL&clicktag=$CLICKTHROUGH_URL"/> <embed src="$URL" width="$WIDTH" height="$HEIGHT" name="banner_$ZONE" flashvars="clickTAG=$CLICKTHROUGH_URL&clickTag=$CLICKTHROUGH_URL&clicktag=$CLICKTHROUGH_URL" type="application/x-shockwave-flash" allowscriptaccess="always" pluginspace="http://get.adobe.com/flashplayer/"></object>'.replace("$WIDTH",a.width).replace("$HEIGHT",a.height).replace("$ZONE",a.zone).replace("$URL",a.resources[0].url).replace("$CLICKTHROUGH_URL",a.resources[0].clickThroughUrl)},getStaticResourceImageHTML:function(a){return'<a target="_blank" href="$CLICKTHROUGH_URL"><img src="$URL" border="0"></a>'.replace("$URL",a.resources[0].url).replace("$CLICKTHROUGH_URL",a.resources[0].clickThroughUrl)},getIFrameResourceHTML:function(a){return'<iframe border="0" frameborder="0" src="$URL" scrolling="no" marginwidth="0" marginheight="0" hspace="0" vspace="0" width="$WIDTH" height="$HEIGHT"></iframe>'.replace("$WIDTH",a.width).replace("$HEIGHT",a.height).replace("$URL",a.resources[0].url)},testBandwidthKbps:function(b,c){var d=Date.now(),e=0,f=new XMLHttpRequest;try{f.open("GET",b),f.responseType="blob",f.onreadystatechange=function(){4===f.readyState&&(200===f.status?(e=Date.now()-d,c(Math.floor(8*f.response.size/1e3/(e/1e3)))):c(-1))},f.send()}catch(g){a.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],"Could not test bandwidth",g),c(-1)}}},a.Pulse.Utils.testBandwidthKbps("https://service.videoplaza.tv"+a.Pulse.AdPlayer.Settings._BW_DETECTION_IMAGE,function(b){b>0&&(a.Pulse.maxBitRate=b,a.Pulse.Utils.log("Available bandwidth (kbps/s) detected: "+b))})}(b),function(a){a.Pulse.AdLoader=function(){var b=function(a){this.ad=a,this.successCallbacks=[]};return b.prototype={load:function(){if(!this.ad.ready)try{a.Pulse._instance._adRequester.requestThirdParty(this.ad,function(a){this.requestSucceeded(a)}.bind(this))}catch(b){}},requestSucceeded:function(a){for(var b=0;b<this.successCallbacks.length;++b)this.successCallbacks[b](a);this.successCallbacks=[]},waitForAd:function(a){this.ad.ready?a(this.ad):(this.successCallbacks.push(a),this.load())}},b}()}(b),function(a){var b=c.adresponse.EventCondition.ConditionName.ON_BEFORE_CONTENT,d=c.adresponse.EventCondition.ConditionName.ON_CONTENT_END,e=c.adresponse.EventCondition.ConditionName.ON_PAUSE,f=c.adresponse.PropertyCondition.ConditionName.PLAYBACK_POSITION,g=c.adresponse.PropertyCondition.ConditionName.TIME_SINCE_LINEAR,h=c.adresponse.PropertyCondition.ConditionName.PLAYBACK_TIME,i=.3;a.Pulse.SessionPlaybackState=function(){var a=function(){this.lastAdTime=new Date(0),this.previousPlaybackPosition=0,this.playbackPosition=0,this.playbackTime=0};return a.prototype={valueForPropertyType:function(a){switch(a){case f:return this.playbackPosition;case h:return this.playbackTime;case g:return(Date.now()-this.lastAdTime.getTime())/1e3}}},a}(),a.Pulse.ConditionEngine=function(){function j(a,b){for(var c=0;c<b.length;++c)if(b[c]===a)return!0;return!1}function k(a){for(var b=0,d=a.slots[0].ads,e=0;e<d.length;++e)d[e].type!==c.adresponse.Ad.AdType.INVENTORY&&++b;return b}function l(a){switch(a){case"onBeforeContent":return"preroll";case"onContentEnd":return"postroll";case"onPause":return"pause";case"playbackTime":return"overlay";default:return a}}var m=function(a){this.insertionPointsByType={},this.setSession(a,!1)};return m.prototype={setSession:function(b,c){a.Pulse.Utils.log("Session response received; "+(c?"extending current":"loading")+" session .. "),this._session=b;for(var d,e,f=0;f<b.insertionPoints.length;++f)if(0!==b.insertionPoints[f].length&&(d=b.insertionPoints[f].conditions[0].type,e=l(d),this.insertionPointsByType[d]||(this.insertionPointsByType[d]=[]),!j(b.insertionPoints[f],this.insertionPointsByType[d])&&!b.insertionPoints[f]._used)){try{var g=k(b.insertionPoints[f]);"playbackPosition"===d?g>0?a.Pulse.Utils.log("  Inserted "+g+" midroll/overlay ads at "+b.insertionPoints[f].conditions[0].value+"(s)"):a.Pulse.Utils.log("  Couldn't insert midroll/overlay ads at "+b.insertionPoints[f].conditions[0].value+"s; no ad(s) received"):g>0?a.Pulse.Utils.log("  Inserted "+g+" "+e+" ad(s)"):a.Pulse.Utils.log("  No "+e+" ad(s) received")}catch(h){}this.insertionPointsByType[d].push(b.insertionPoints[f])}a.Pulse.Utils.log("Session "+(c?"extended.":"ready.")),a.Pulse.Utils.logNewline(),this.currentEventType=null},hasSeekMode:function(){switch(this._session.seekMode){case a.Pulse.SeekMode.PLAY_FIRST:case a.Pulse.SeekMode.PLAY_LAST:case a.Pulse.SeekMode.PLAY_ALL:return!0}return!1},findPrerollAds:function(a){return this.findAds(b,a)},findMidrollAds:function(a){var b=this.findAds(f,a),c=this.findAds(h,a);return b&&c?b.concat(c):b||(c||null)},findPauseAd:function(a){return this.findAds(e,a)},findPostrollAds:function(a){return this.findAds(d,a)},findAds:function(b,c){var d=[],e=this.insertionPointsByType[b];if(e){this.currentEventType=b;for(var g=void 0,h=0;h<e.length;++h)if(g=e[h],!g._used&&this.testConditions(g.conditions,c)){var i=-1;if(b===f&&(i=g.conditions[0].value),d.push({position:i,ads:g.slots[0].ads.slice()}),!this.hasSeekMode())break}}var j=d[0];if(d.length>1&&this.hasSeekMode()&&b===f)switch(d=d.filter(function(a){return"overlay_standard"!==a.ads[0].type}).sort(function(a,b){return a.position-b.position}),this._session.seekMode){case a.Pulse.SeekMode.PLAY_FIRST:j=d[0];break;case a.Pulse.SeekMode.PLAY_LAST:j=d[d.length-1];break;case a.Pulse.SeekMode.PLAY_ALL:for(var k=[],l=0;l<d.length;++l)k=k.concat(d[l].ads);j={position:-1,ads:k}}if(j)for(var m=0;m<j.ads.length;++m){var n=j.ads[m];n.parentSlot.parentInsertionPoint._used=!0}return j?j.ads:null},testConditions:function(a,b){if(a.length>0){for(var c=0;c<a.length;++c)if(this.testCondition(a[c],b))return!0;return!1}return!0},testCondition:function(a,j){var k=!1;switch(a.type){case b:case e:case d:k=this.currentEventType===a.type;break;case f:case h:case g:if(a instanceof c.adresponse.PropertyCondition){var l=j.valueForPropertyType(a.type);switch(a.operator){case c.adresponse.PropertyCondition.Operator.EQ:k=l<=a.value+i&&l>a.value-i;break;case c.adresponse.PropertyCondition.Operator.GEQ:k=l>=a.value-i}}}return k?this.testConditions(a.conditions,j):!!(this.hasSeekMode()&&a.type===f&&j.previousPlaybackPosition<a.value+i&&j.playbackPosition>=a.value-i)&&this.testConditions(a.conditions,j)}},m}()}(b),function(a){function b(a,b){if(!a)return!0;if(!a.insertionPointFilter)return!0;for(var c=0;c<a.insertionPointFilter.length;++c)if(a.insertionPointFilter[c]===b)return!0;return!1}function d(a){var b=a.match(m);return b&&b[1]?b[1]:null}function e(a){var b=document.createElement("script");b.setAttribute("type","text/javascript"),b.setAttribute("src",a),document.head.appendChild(b)}function f(){if(l.rules.script&&l.rules.startTime&&l.rules.endTime&&l.rules.hosts){var b=Date.now();try{var c=new Date(l.rules.startTime).getTime(),f=new Date(l.rules.endTime).getTime();if(c>b||f<b)return}catch(r){return void j([{tag:"warning",color:i.ErrorLog}],"failed to determine wo time limit")}var g=d(a.Pulse._instance._adRequester._vpHost);if(!g)return void j([{tag:"warning",color:i.ErrorLog}],"failed to resolve wo site id");for(var h=!1,k=0;k<l.rules.hosts.length;++k)if(l.rules.hosts[k]===g){h=!0;break}if(h){var m=l.rules.script,n="",o=0;l.pulseSession._contentMetadata&&(l.pulseSession._contentMetadata.hasOwnProperty("id")&&(n=l.pulseSession._contentMetadata.id),
l.pulseSession._contentMetadata.hasOwnProperty("duration")&&(o=l.pulseSession._contentMetadata.duration));var p;try{p={"${campaign.id}":l.pulseAd.getCoreAd().campaignId,"${timestamp}":b,"${content.duration}":o,"${content.id}":n,"${ad.id}":l.pulseAd.getCoreAd().id,"${site.id}":g,"${tid}":l.pulseSession._currentSession.id,"${pid}":a.Pulse._instance._adRequester._pid||0,"${request.referrerurl}":window.location.toString()}}catch(r){return void j([{tag:"warning",color:i.ErrorLog}],"failed to resolve wo macros")}for(var q in p)m=m.replace(q,p[q]);e(m)}}}function g(){new c.HTTPRequester(!1,!0).request(l.rulesURL,function(a){l.state=k.INSERTED;try{l.rules=JSON.parse(a)}catch(b){return void j([{tag:"warning",color:i.ErrorLog}],"wo ruleset is broken")}f()},function(error){})}function h(b,c){switch(!0===a.Pulse.Settings.DISABLE_WO&&(l.state=k.INSERTED),l.state){case k.NOT_INITIALIZED:l.state=k.WAITING,l.pulseSession=b,l.pulseAd=c,g();break;case k.WAITING:l.pulseSession=b,l.pulseAd=c;break;case k.INSERTED:}}var i={ErrorLog:"#B82F00"},j=a.Pulse.Utils.logTagged,k=(a.Pulse.Utils.log,{NOT_INITIALIZED:0,WAITING:1,INSERTED:2}),l={rulesURL:"https://service.videoplaza.tv/proxy/pulse-sdk-html5/wo/rules.json",rules:null,state:k.NOT_INITIALIZED,pulseSession:null,pulseAd:null},m=/^(?:https?\:\/\/)?([0-9a-zA-Z-]*)/;a.Pulse.SessionImplementation=function(){function d(a){return!a.ready||(a.type===c.adresponse.Ad.AdType.SPOT_STANDARD||a.type===c.adresponse.Ad.AdType.SPOT_IPTV)}function e(a){if(!a)throw new Error("A session listener must be provided to requestSession().");if("function"!=typeof a.startContentPlayback)throw new Error("The provided PulseSessionListener implementation does not implement the required method startContentPlayback.");if("function"!=typeof a.startAdPlayback)throw new Error("The provided PulseSessionListener implementation does not implement the required method startAdPlayback.");if("function"!=typeof a.startAdBreak)throw new Error("The provided PulseSessionListener implementation does not implement the required method startAdBreak.");if("function"!=typeof a.sessionEnded)throw new Error("The provided PulseSessionListener implementation does not implement the required method sessionEnded.");if("function"!=typeof a.illegalOperationOccurred)throw new Error("The provided PulseSessionListener implementation does not implement the required method illegalOperationOccurred.")}function f(b){var c=this._currentSession.insertionPoints.length,d=c;if(0===c)return void b();for(var e=0;e<c;++e)a.Pulse._instance._adRequester.requestThirdParty(this._currentSession.insertionPoints[e],function(){if(0===d)return j([{tag:"error",color:i.ErrorLog}],"preload() processed more than the expected number of insertion points; calling ready()"),void b();0===--d&&b()}.bind(this))}function g(){this._state=I.BEFORE_CONTENT_PLAYBACK,this._sessionListener.startContentPlayback()}function k(b,c){this._sessionRequest=a.Pulse._instance._adRequester.requestSession(b,c,function(a){o.call(this,a)}.bind(this),function(error){setTimeout(function(){j([{tag:"error",color:i.ErrorLog}],error),this._sessionRequest=null,this._currentSession=null,this._sessionListener&&g.call(this)}.bind(this),0)}.bind(this))}function l(b,c,d){this._sessionRequest=a.Pulse._instance._adRequester.requestSessionExtension(this._currentSession,b,c,function(a){p.call(this,a,d)}.bind(this))}function m(){this._currentSession?(z.call(this),this._adBreakType=a.Pulse.AdBreakPosition.PREROLL,this._availableAdLoaders=D(this._conditionEngine.findPrerollAds(this._playbackState)),this._availableAdLoaders?s.call(this):g.call(this)):g.call(this)}function n(){a.Pulse.Utils.log("Session ended"),this._state=I.DONE,this._sessionListener.sessionEnded()}function o(b){this._sessionRequest=null,this._currentSession=b,this._conditionEngine=new a.Pulse.ConditionEngine(b);for(var c=0;c<this._preloads.length;++c)f.call(this,this._preloads[c]);this._preloads=[],this._state===I.WAITING&&m.call(this)}function p(a,b){this._sessionRequest=null,this._conditionEngine.setSession(a,!0),b&&b()}function q(b){var c=new a.Pulse.OverlayAd(b,this);this._sessionListener.showOverlayAd&&(this._currentOverlayAd=c,this._sessionListener.showOverlayAd(c))}function r(b){for(var c=0;c<this._availableNonLinearAdLoaders.length;++c)this._availableNonLinearAdLoaders[c].load();var d;if(this._availableNonLinearAdLoaders&&this._availableNonLinearAdLoaders.length>0)return d=this._availableNonLinearAdLoaders.shift(),void d.waitForAd(function(a){q.call(this,a)}.bind(this));if(b&&b[0]){new a.Pulse.OverlayAd}}function s(){this._availableNonLinearAdLoaders=this._availableAdLoaders.filter(function(a){return"overlay_standard"===a.ad.type}),this._availableAdLoaders=this._availableAdLoaders.filter(function(a){return"overlay_standard"!==a.ad.type}),r.call(this,this._availableNonLinearAdLoaders),this._playableAdsRemaining=u(this._availableAdLoaders),this._playableAdsTotal=this.getPlayableAdsRemaining();for(var a=0;a<this._availableAdLoaders.length;++a)this._availableAdLoaders[a].load();this._playableAdsTotal>0?!1===this._sessionListener.startAdBreak(this)?(this._state=I.WAITING_FOR_AD_BREAK_STARTED,t.call(this,function(){this._state=I.BEFORE_AD_PLAYBACK,this._adBreakStartedCallback=null,x.call(this)}.bind(this))):(this._state=I.BEFORE_AD_PLAYBACK,x.call(this)):("function"==typeof this._sessionListener.emptyAdBreak&&this._sessionListener.emptyAdBreak(),x.call(this))}function t(a){this._adBreakStartedCallback=a}function u(a){for(var b=[],c=0;c<a.length;++c)d(a[c].ad)&&b.push(a[c].ad);return b}function v(b){b.type===c.adresponse.Ad.AdType.INVENTORY?a.Pulse._instance._tracker.reportError(b,c.tracking.Tracker.AdError.NO_AD):(this._currentPauseAd=new a.Pulse.PauseAd(b,this),this._state=I.DURING_PAUSE_AD,this._sessionListener.showPauseAd(this._currentPauseAd))}function w(b){var d=this.getPlayableAdsTotal()-this.getPlayableAdsRemaining()+1;if(b.type===c.adresponse.Ad.AdType.SPOT_STANDARD||b.type===c.adresponse.Ad.AdType.SPOT_IPTV){this._currentAd=new a.Pulse.StandardSpotAd(b,this),this._state=I.BEFORE_AD_PLAYBACK;var e=1e3*(b.startTimeout||4);return this._sessionListener.startAdPlayback(this._currentAd,e,d),void h(this,this._currentAd)}b.type===c.adresponse.Ad.AdType.INVENTORY?(a.Pulse._instance._tracker.reportPulseError(b,c.tracking.Tracker.PulseError.NO_VAST_RESPONSE_ERROR),a.Pulse.Utils.log("No ad available: tracking inventory"),a.Pulse._instance._tracker.reportError(b,c.tracking.Tracker.AdError.NO_AD)):b.type!==c.adresponse.Ad.AdType.OVERLAY_STANDARD&&(j([{tag:"error",color:i.ErrorLog}],"Encountered unsupported ad type: "+b.type),a.Pulse._instance._tracker.reportError(b,c.tracking.Tracker.AdError.TYPE_NOT_SUPPORTED)),x.call(this)}function x(){var a;if(this._availableAdLoaders&&this._availableAdLoaders.length>0)return a=this._availableAdLoaders.shift(),void a.waitForAd(function(a){w.call(this,a)}.bind(this));this._currentAd=null,this._availableAdLoaders=null,this._contentState!==H.POST?this._state!==I.DURING_CONTENT_PLAYBACK&&g.call(this):n.call(this)}function y(){this._timeSpentStartTime&&(this._timeSpent+=((new Date).getTime()-this._timeSpentStartTime.getTime())/1e3)}function z(){this._playbackState.lastAdTime=a.Pulse._instance._lastAdTime}function A(b){var c=b+E(this._state);this._sessionListener?this._sessionListener.illegalOperationOccurred(c):a.Pulse.Utils.log("onIllegalOperation without session listener:",c)}function B(a){this._sessionListener[a]&&"function"==typeof this._sessionListener[a]&&this._sessionListener[a](a)}function C(a){switch(a){case 1:B.call(this,"firstQuartileReached");break;case 2:B.call(this,"midpointReached");break;case 3:B.call(this,"thirdQuartileReached")}}function D(b){if(!b)return null;for(var c=[],d=0;d<b.length;++d)c.push(new a.Pulse.AdLoader(b[d]));return c}function E(a){switch(a){case I.BEFORE_START:return"before starting a content session.";case I.DURING_PAUSE_AD:return"while showing a pause ad";case I.CONTENT_PAUSED:return"while the content is paused";case I.BEFORE_CONTENT_PLAYBACK:return"while waiting for content to start.";case I.DURING_CONTENT_PLAYBACK:return"while content is playing.";case I.BEFORE_AD_PLAYBACK:return"while waiting for ad to start.";case I.DURING_AD_PLAYBACK:return"while ad is playing.";case I.DURING_AD_PLAYBACK_PAUSED:return"while ad is paused.";case I.DONE:return"after session completed."}}function F(b){if(b.getCoreAd().companions.length>0){a.Pulse.Utils.log("Showing "+b.getCoreAd().companions.length+" companions for ad "+b.getCoreAd().id);for(var c=0;c<b.getCoreAd().companions.length;c++)G(b.getCoreAd().companions[c])}}function G(b){function d(a){var c="";try{c=top.document.getElementById(a)}catch(d){j([{tag:"error",color:i.ErrorLog}],'Unable to show companion ad; zone "'+b.zone+'" not found')}return c}a.Pulse.Utils.log("Trying to show companion ad in div '"+b.zone+"':",b);var e=b.resources[0],f=e.url,g=d(b.zone),h=b.resources[0]instanceof c.adresponse.StaticResource,k=e.hasOwnProperty("mimeType")&&"application/x-shockwave-flash"==e.mimeType;return g?(a.Pulse._instance._tracker.trackEvent(b,c.tracking.Tracker.CreativeEventType.CREATIVE_VIEW),h?(a.Pulse.Utils.log("  Showing static resource companion ad with source URL "+f),g.innerHTML=k?a.Pulse.Utils.getStaticResourceFlashHTML(b):a.Pulse.Utils.getStaticResourceImageHTML(b)):(a.Pulse.Utils.log("  Showing iframe companion ad with source URL "+f),g.innerHTML=a.Pulse.Utils.getIFrameResourceHTML(b)),!0):(j([{tag:"error",color:i.ErrorLog}],'Unable to show companion ad, zone "'+b.zone+'" not found!'),!1)}var H={PRE:0,MID:1,POST:2},I={BEFORE_START:0,WAITING:1,BEFORE_CONTENT_PLAYBACK:2,DURING_CONTENT_PLAYBACK:3,CONTENT_PAUSED:4,WAITING_FOR_AD_BREAK_STARTED:5,BEFORE_AD_PLAYBACK:6,DURING_AD_PLAYBACK:7,DURING_AD_PLAYBACK_PAUSED:8,DURING_PAUSE_AD:9,DONE:10},J=function(b,c){this._conditionEngine=null,this._playbackState=new a.Pulse.SessionPlaybackState,this._currentSession=null,this._sessionRequest=null,this._currentAd=null,this._currentPauseAd=null,this._currentInsertionPoint=null,this._adBreakStartedCallback=null,this._availableNonLinearAdLoaders=[],this._quartilesTracked=0,this._timeSpent=0,this._timeSpentStartTime=null,this._state=I.BEFORE_START,this._contentState=H.PRE,this._playableAdsRemaining=null,this._playableAdsTotal=0,this._contentMetadata=b,this._requestSettings=c,this._preloads=[],k.call(this,b,c)};return J.prototype={extendSession:function(a,b,c){if(this._state===I.DONE)return void A.call(this,"Did not expect session to get extended ");if(this._contentMetadata)for(var d in this._contentMetadata)a[d]||(a[d]=this._contentMetadata[d]);if(this._requestSettings)for(var d in this._requestSettings)b[d]||(b[d]=this._requestSettings[d]);l.call(this,a,b,c)},startSession:function(a){if(e(a),this._sessionListener=a,this._state!==I.BEFORE_START)return void A.call(this,"Did not expect 'startSession' to be called ");this._sessionRequest?this._state=I.WAITING:m.call(this)},stopSession:function(){if(this._state===I.DONE)return void A.call(this,"Did not expect session to be stopped ");this._sessionListener=null,this._sessionRequest&&this._sessionRequest("PulseSession.stopSession() called."),this._state=I.DONE},preload:function(a){var b=function(){"function"==typeof a?a():j([{tag:"error",color:i.ErrorLog}],"preload() finished, but was not provided a ready() function to call")};this._currentSession?f.call(this,b):this._preloads.push(b)},contentStarted:function(){if(this._state!==I.BEFORE_CONTENT_PLAYBACK&&this._state!==I.CONTENT_PAUSED&&this._state!==I.DURING_PAUSE_AD)return void A.call(this,"Did not expect content to start playing ");if(this._state===I.DURING_PAUSE_AD&&this._currentPauseAd&&this._currentPauseAd instanceof a.Pulse.PauseAd&&(y.call(this),a.Pulse._instance._tracker.trackTimeSpent(this._timeSpent,this._currentPauseAd.getCoreAd().creatives[0]),this._currentPauseAd=null),b(this._requestSettings,a.Pulse.InsertionPointType.ON_PAUSE)){var d=this._requestSettings?JSON.parse(JSON.stringify(this._requestSettings)):{};d.insertionPointFilter=[c.adrequest.AdRequester.InsertionPointType.ON_PAUSE],a.Pulse.Utils.log("Requesting new pause ad .."),a.Pulse._instance._adRequester.requestSessionExtension(this._currentSession,this._contentMetadata,d,function(a){this._conditionEngine.setSession(a,!0)}.bind(this))}this._state=I.DURING_CONTENT_PLAYBACK,this._contentState===H.PRE&&(a.Pulse._instance._tracker.trackEvent(this._currentSession,c.tracking.Tracker.SessionEventType.CONTENT_START),this._contentState=H.MID)},contentPaused:function(){if(this._state===I.DONE)return void A.call(this,"Did not expect content to be paused ");if(this._currentSession&&(z.call(this),this._state===I.DURING_CONTENT_PLAYBACK)){this._state=I.CONTENT_PAUSED;var a=this._conditionEngine.findPauseAd(this._playbackState);a&&1===a.length&&v.call(this,a[0])}},contentFinished:function(){return this._state!==I.DURING_CONTENT_PLAYBACK?void A.call(this,"Did not expect content to finish playing "):(this._contentState=H.POST,this._currentSession?(z.call(this),this._availableAdLoaders=D(this._conditionEngine.findPostrollAds(this._playbackState)),this._adBreakType=a.Pulse.AdBreakPosition.POSTROLL,void(this._availableAdLoaders?s.call(this):n.call(this))):void n.call(this))},contentPositionChanged:function(b){if(this._state!==I.DURING_CONTENT_PLAYBACK)return void A.call(this,"Did not expect content to progress ");this._availableAdLoaders||this._currentSession&&(this._playbackState.previousPlaybackPosition=this._playbackState.playbackPosition,this._playbackState.playbackPosition=b,this._playbackState.playbackTime=b,z.call(this),this._availableAdLoaders=D(this._conditionEngine.findMidrollAds(this._playbackState)),this._adBreakType=a.Pulse.AdBreakPosition.MIDROLL,this._availableAdLoaders&&s.call(this))},adStarted:function(){if(this._state!==I.BEFORE_AD_PLAYBACK)return void A.call(this,"Did not expect ad to start playing ");this._state=I.DURING_AD_PLAYBACK,a.Pulse._instance._tracker.trackEvent(this._currentAd.getCoreAd(),c.tracking.Tracker.AdEventType.IMPRESSION),a.Pulse._instance._tracker.trackEvent(this._currentAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CREATIVE_VIEW),a.Pulse._instance._tracker.trackEvent(this._currentAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.START),F(this._currentAd),this._quartilesTracked=0,this._timeSpent=0,this._timeSpentStartTime=new Date},adFinished:function(){if(this._state!==I.DURING_AD_PLAYBACK&&this._state!==I.BEFORE_AD_PLAYBACK)return void A.call(this,"Did not expect ad to finish playing ");var b=this._currentAd.getCoreAd().creatives[0];b.duration>0&&this.adPositionChanged(b.duration),y.call(this),a.Pulse._instance._tracker.trackTimeSpent(this._timeSpent,b),a.Pulse._instance._tracker.trackEvent(b,c.tracking.Tracker.CreativeEventType.COMPLETE),a.Pulse._instance._adPlayed(new Date);var d=this._playableAdsRemaining.indexOf(this._currentAd.getCoreAd());d>-1&&this._playableAdsRemaining.splice(d,1),x.call(this)},adSkipped:function(){if(this._state!==I.DURING_AD_PLAYBACK&&this._state!==I.BEFORE_AD_PLAYBACK)return void A.call(this,"Did not expect ad to be skipped ");var b=this._currentAd.getCoreAd().creatives[0];y.call(this),a.Pulse._instance._tracker.trackTimeSpent(this._timeSpent,b),a.Pulse._instance._tracker.trackEvent(b,c.tracking.Tracker.CreativeEventType.CLOSE),a.Pulse._instance._tracker.trackEvent(b,c.tracking.Tracker.CreativeEventType.SKIP);var d=this._playableAdsRemaining.indexOf(this._currentAd.getCoreAd());d>-1&&this._playableAdsRemaining.splice(d,1),x.call(this)},adStopped:function(){if(this._state!==I.DURING_AD_PLAYBACK&&this._state!==I.BEFORE_AD_PLAYBACK)return void A.call(this,"Did not expect ad to be stopped ");var b=this._currentAd.getCoreAd().creatives[0];y.call(this),a.Pulse._instance._tracker.trackTimeSpent(this._timeSpent,b);var c=this._playableAdsRemaining.indexOf(this._currentAd.getCoreAd());c>-1&&this._playableAdsRemaining.splice(c,1),x.call(this)},adPositionChanged:function(b){if(this._state!==I.DURING_AD_PLAYBACK)return void A.call(this,"Did not expect ad to progress ");var d=this._currentAd.getCoreAd().creatives[0],e=d.duration;e>0&&(b>=.75*e&&this._quartilesTracked<3?(a.Pulse._instance._tracker.trackEvent(d,c.tracking.Tracker.CreativeEventType.THIRD_QUARTILE),this._quartilesTracked=3,C.call(this,3)):b>=.5*e&&this._quartilesTracked<2?(a.Pulse._instance._tracker.trackEvent(d,c.tracking.Tracker.CreativeEventType.MIDPOINT),this._quartilesTracked=2,C.call(this,2)):b>=.25*e&&this._quartilesTracked<1&&(a.Pulse._instance._tracker.trackEvent(d,c.tracking.Tracker.CreativeEventType.FIRST_QUARTILE),this._quartilesTracked=1,C.call(this,1))),a.Pulse._instance._tracker.trackProgress(d,b)},adPaused:function(){if(this._state!==I.DURING_AD_PLAYBACK)return void A.call(this,"Did not expect user ad pause ");y.call(this),this._state=I.DURING_AD_PLAYBACK_PAUSED,a.Pulse._instance._tracker.trackEvent(this._currentAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.PAUSE)},adResumed:function(){if(this._state!==I.DURING_AD_PLAYBACK_PAUSED)return void A.call(this,"Did not expect user ad resume ");this._timeSpentStartTime=new Date,this._state=I.DURING_AD_PLAYBACK,a.Pulse._instance._tracker.trackEvent(this._currentAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.RESUME)},overlayClickThroughTriggered:function(b){if(this._state===I.DONE)return void A.call(this,"Did not expect an overlay click through ");a.Pulse._instance._tracker.trackEvent(b.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CLICKTHROUGH)},pauseAdClickThroughTriggered:function(b){if(this._state!==I.DURING_PAUSE_AD)return void A.call(this,"Did not expect a pause ad click through ");a.Pulse._instance._tracker.trackEvent(b.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CLICKTHROUGH)},adClickThroughTriggered:function(){if(this._state!==I.DURING_AD_PLAYBACK&&this._state!==I.DURING_AD_PLAYBACK_PAUSED)return void A.call(this,"Did not expect user click through ");a.Pulse._instance._tracker.trackEvent(this._currentAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CLICKTHROUGH)},adFailed:function(b){if(this._state!==I.BEFORE_AD_PLAYBACK&&this._state!==I.DURING_AD_PLAYBACK&&this._state!==I.DURING_PAUSE_AD)return void A.call(this,"Did not expect ad to fail ");switch(b){case a.PulseAdError.REQUEST_FAILED:b=c.tracking.Tracker.CreativeError.MEDIA_FILE_NOT_FOUND,a.Pulse._instance._tracker.reportPulseError(this._currentAd.getCoreAd(),c.tracking.Tracker.PulseError.LINEAR_MEDIA_FILE_NOT_FOUND_ERROR);break;case a.PulseAdError.TIMED_OUT:b=c.tracking.Tracker.CreativeError.MEDIA_FILE_TIMEOUT,a.Pulse._instance._tracker.reportPulseError(this._currentAd.getCoreAd(),c.tracking.Tracker.PulseError.START_AD_TIMEOUT_ERROR);break;case a.PulseAdError.NO_SUPPORTED_MEDIA_FILE:b=c.tracking.Tracker.CreativeError.NO_SUPPORTED_MEDIA_FILE_FOUND,a.Pulse._instance._tracker.reportPulseError(this._currentAd.getCoreAd(),c.tracking.Tracker.PulseError.NO_SUPPORTED_MEDIA_FILE_FOUND_ERROR);break;case a.PulseAdError.COULD_NOT_PLAY:b=c.tracking.Tracker.CreativeError.MEDIA_FILE_DISPLAY_ERROR,a.Pulse._instance._tracker.reportPulseError(this._currentAd.getCoreAd(),c.tracking.Tracker.PulseError.MEDIA_FILE_DISPLAY_ERROR);break;default:return}var d=this.getPlayableAdsTotal()-this.getPlayableAdsRemaining()+1;j([{tag:"error",color:i.ErrorLog}],"Ad #"+d+" playback failed: "+b,this._currentAd);var e=function(){var c=this._playableAdsRemaining.indexOf(this._currentAd.getCoreAd());c>-1&&this._playableAdsRemaining.splice(c,1),a.Pulse._instance._tracker.reportError(this._currentAd.getCoreAd().creatives[0],b),x.call(this)};if(c.adresponse.Ad.hasPassback(this._currentAd.getCoreAd())){a.Pulse.Utils.log("   > Requesting a passback ad ..");try{a.Pulse._instance._adRequester.requestPassback(this._currentAd.getCoreAd(),b,function(a){setTimeout(function(){w.call(this,a)}.bind(this,0))}.bind(this))}catch(f){j([{tag:"error",color:i.ErrorLog}],"> Exception requesting passback ad: ",f.message),e.call(this)}}else a.Pulse.Utils.log("   > No passback ad sources available"),e.call(this)},overlayDisplayed:function(b){if(this._state===I.DONE)return void A.call(this,"Did not expect an overlay to be displayed ");a.Pulse._instance._tracker.trackEvent(b.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CREATIVE_VIEW),a.Pulse._instance._tracker.trackEvent(b.getCoreAd(),c.tracking.Tracker.AdEventType.IMPRESSION)},overlayFinished:function(b){if(this._state===I.DONE)return void A.call(this,"Did not expect an overlay to finish ");a.Pulse._instance._tracker.trackTimeSpent(b.timeSpent,b.getCoreAd().creatives[0])},overlayCollapsed:function(b){if(this._state===I.DONE)return void A.call(this,"Did not expect an overlay to collapse ");a.Pulse._instance._tracker.trackEvent(b.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.COLLAPSE)},overlayClosed:function(b){if(this._state===I.DONE)return void A.call(this,"Did not expect an overlay to close ");a.Pulse._instance._tracker.trackEvent(b.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CLOSE),a.Pulse._instance._tracker.trackTimeSpent(b.timeSpent,b.getCoreAd().creatives[0])},overlayFailed:function(b,d){if(this._state===I.DONE)return void A.call(this,"Did not expect an overlay to fail ");switch(j([{tag:"error",color:i.ErrorLog}],"Overlay ad failed ",d),d){case a.PulseAdError.REQUEST_FAILED:d=c.tracking.Tracker.CreativeError.MEDIA_FILE_NOT_FOUND;break;case a.PulseAdError.TIMED_OUT:d=c.tracking.Tracker.CreativeError.MEDIA_FILE_TIMEOUT;break;case a.PulseAdError.NO_SUPPORTED_MEDIA_FILE:d=c.tracking.Tracker.CreativeError.NO_SUPPORTED_MEDIA_FILE_FOUND;break;case a.PulseAdError.COULD_NOT_PLAY:d=c.tracking.Tracker.CreativeError.MEDIA_FILE_DISPLAY_ERROR;break;default:return}a.Pulse._instance._tracker.reportError(b.getCoreAd().creatives[0],d)},pauseAdFailed:function(b){if(this._state!==I.DURING_PAUSE_AD)return void A.call(this,"Did not expect pause ad to fail ");switch(j([{tag:"error",color:i.ErrorLog}],"Pause ad failed ",b),b){case a.PulseAdError.REQUEST_FAILED:b=c.tracking.Tracker.CreativeError.MEDIA_FILE_NOT_FOUND;break;case a.PulseAdError.TIMED_OUT:b=c.tracking.Tracker.CreativeError.MEDIA_FILE_TIMEOUT;break;case a.PulseAdError.NO_SUPPORTED_MEDIA_FILE:b=c.tracking.Tracker.CreativeError.NO_SUPPORTED_MEDIA_FILE_FOUND;break;case a.PulseAdError.COULD_NOT_PLAY:b=c.tracking.Tracker.CreativeError.MEDIA_FILE_DISPLAY_ERROR;break;default:return}a.Pulse._instance._tracker.reportError(this._currentPauseAd.getCoreAd().creatives[0],b),this._state=I.CONTENT_PAUSED},pauseAdDisplayed:function(){if(this._state!==I.DURING_PAUSE_AD)return void A.call(this,"Did not expect pause ad to be displayed ");a.Pulse.Utils.log("Pause ad displayed"),this._timeSpent=0,this._timeSpentStartTime=new Date,a.Pulse._instance._tracker.trackEvent(this._currentPauseAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CREATIVE_VIEW),a.Pulse._instance._tracker.trackEvent(this._currentPauseAd.getCoreAd(),c.tracking.Tracker.AdEventType.IMPRESSION),a.Pulse._instance._tracker.trackEvent(this._currentPauseAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.START)},pauseAdClosed:function(){if(this._state!==I.DURING_PAUSE_AD)return void A.call(this,"Did not expect pause ad to be closed ");a.Pulse.Utils.log("Pause ad closed"),y.call(this),a.Pulse._instance._tracker.trackTimeSpent(this._timeSpent,this._currentPauseAd.getCoreAd().creatives[0]),a.Pulse._instance._tracker.trackEvent(this._currentPauseAd.getCoreAd().creatives[0],c.tracking.Tracker.CreativeEventType.CLOSE),this._currentPauseAd=null,this._state=I.CONTENT_PAUSED},getBreakPosition:function(){return this._adBreakType},getPlayableAdsRemaining:function(){return this._state===I.DONE?void A.call(this,"Did not expect 'getPlayableAdsRemaining' to get called "):this._playableAdsRemaining.length},getPlayableAdsTotal:function(){return this._state===I.DONE?void A.call(this,"Did not expect 'getPlayableAdsTotal' to get called "):this._playableAdsTotal},stopAdBreak:function(){if(this._state!==I.BEFORE_AD_PLAYBACK&&this._state!==I.DURING_AD_PLAYBACK&&this._state!==I.DURING_AD_PLAYBACK_PAUSED)return void A.call(this,"Did not expect ad break to stop ");this._availableAdLoaders=null,this._playableAdsRemaining=[],this._playableAdsTotal=0,x.call(this)},adBreakStarted:function(){if(this._state!==I.WAITING&&this._state!==I.DURING_CONTENT_PLAYBACK&&this._state!==I.WAITING_FOR_AD_BREAK_STARTED)return void A.call(this,"Did not expect ad break to start ");this._adBreakStartedCallback&&this._adBreakStartedCallback()}},J}()}(b),function(a){function b(a){if(!a)return Number.NaN;var b=a.split(":");if(!b||0===b.length)return Number.NaN;var c=0;b.length>=1&&!1===isNaN(parseFloat(b[b.length-1]))&&(c=parseFloat(b[b.length-1]));var d=0;b.length>=2&&!1===isNaN(parseFloat(b[b.length-2]))&&(d=parseInt(b[b.length-2]));var e=0;return b.length>=3&&!1===isNaN(parseFloat(b[b.length-3]))&&(e=parseInt(b[b.length-3])),c+60*d+3600*e}a.Pulse.StandardSpotAd=function(){var a={BEFORE_START:0,WAITING:1,BEFORE_CONTENT_PLAYBACK:2,DURING_CONTENT_PLAYBACK:3,CONTENT_PAUSED:4,WAITING_FOR_AD_BREAK_STARTED:5,BEFORE_AD_PLAYBACK:6,DURING_AD_PLAYBACK:7,DURING_AD_PLAYBACK_PAUSED:8,DURING_PAUSE_AD:9,DONE:10},d=function(a,b){this._ad=a,this._pulseSession=b,this._skipButtonShown=!1,this._calculateSkipOffset()};return d.prototype={_calculateSkipOffset:function(){var a=this._ad.creatives[0];a._originalSkipOffset||(a._originalSkipOffset=a.skipOffset);var c=0;if(a._originalSkipOffset){var d=a._originalSkipOffset.toString();if(d.indexOf("%")>-1){var e=parseFloat(String(d).substring(0,d.indexOf("%")));c=(a.duration||0)*(e/100)}else c=b(d)}a.skipOffset=c},adStarted:function(){this.isStopped()||this._pulseSession.adStarted()},adFinished:function(){this.isStopped()||(this._pulseSession.adFinished(),this._pulseSession=null)},adSkipped:function(){this.isStopped()||(this._pulseSession.adSkipped(),this._pulseSession=null)},adPositionChanged:function(b){this.isStopped()||this._pulseSession._state==a.DURING_AD_PLAYBACK&&this._pulseSession.adPositionChanged(b)},adClickThroughTriggered:function(){this.isStopped()||this._pulseSession.adClickThroughTriggered()},adPaused:function(){this.isStopped()||this._pulseSession.adPaused()},adResumed:function(){this.isStopped()||this._pulseSession.adResumed()},adFailed:function(error){this.isStopped()||(this._pulseSession.adFailed(error),this._pulseSession=null)},adStopped:function(){this.isStopped()||(this._pulseSession.adStopped(),this._pulseSession=null)},getMediaFiles:function(){return this._ad.creatives[0].mediaFiles.slice()},getClickthroughURL:function(){return this._ad.creatives[0].clickThroughUrl},getCoreAd:function(){return this._ad},getSkipOffset:function(){return this._ad.creatives[0].skipOffset},isSkippable:function(){var a=this._ad.creatives[0];switch(a.skipButtonMode){case c.adresponse.LinearCreative.SkipButtonMode.ALWAYS:return!0;case c.adresponse.LinearCreative.SkipButtonMode.AFTER_FIRST_COMPLETION:if(Date.now()/1e3-a.lastCompletion/1e3<a.skipResetTime)return!0}return!1},isStopped:function(){return!this._pulseSession}},d}()}(b),function(a){a.Pulse.OverlayAd=function(){var a=function(a,b){this._ad=a,this._pulseSession=b,this._timeSpentStart=0,this.timeSpent=0};return a.prototype={getResourceURL:function(){return this._ad.creatives[0].resources[0].url},getResourceMimeType:function(){return this._ad.creatives[0].resources[0].mimeType},getClickthroughURL:function(){return this._ad.creatives[0].resources[0].clickThroughUrl},getWidth:function(){return this._ad.creatives[0].resources[0].width},getHeight:function(){return this._ad.creatives[0].resources[0].height},getDuration:function(){return this._ad.creatives[0].duration},getCoreAd:function(){return this._ad},adClickThroughTriggered:function(){this._pulseSession.overlayClickThroughTriggered(this)},adDisplayed:function(){this._pulseSession.overlayDisplayed(this),this._timeSpentStart=Date.now()},adClicked:function(){},adClosed:function(){this.timeSpent=(Date.now()-this._timeSpentStart)/1e3,this._pulseSession.overlayClosed(this)},adCollapsed:function(){this._pulseSession.overlayCollapsed(this)},adFailedWithError:function(error){this._pulseSession.overlayFailed(this,error)},adFinished:function(){this.timeSpent=(Date.now()-this._timeSpentStart)/1e3,this._pulseSession.overlayFinished(this)}},a}()}(b),function(a){a.Pulse.PauseAd=function(){var a=function(a,b){this._coreAd=a,this._session=b};return a.prototype={adDisplayed:function(){this._session.pauseAdDisplayed()},adClosed:function(){this._session.pauseAdClosed()},adClickThroughTriggered:function(){this._session.pauseAdClickThroughTriggered(this)},adFailedWithError:function(error){this._session.pauseAdFailed(error)},getResourceMimeType:function(){return this._coreAd.creatives[0].resources[0].mimeType},getType:function(){return this._coreAd.creatives[0].type},getResourceURL:function(){return this._coreAd.creatives[0].resources[0].url},getClickthroughURL:function(){return this._coreAd.creatives[0].resources[0].clickThroughUrl},getCoreAd:function(){return this._coreAd}},a}()}(b),function(a){a.Pulse.Flash=function(){function b(){f=[],j="notLoading",k=[],g=0;try{document.body.removeChild(l)}catch(a){console.log("Failed to remove requester swf")}}function d(){b()}function e(){if(!a.Pulse.Settings||!a.Pulse.Settings.DISABLE_FLASH){var b=document.createElement("param"),c=document.createElement("param");h&&d(),l=document.createElement("object"),j="loading",i=!0,b.name="allowscriptaccess",b.value="always",l.style.position="absolute",l.style.width="1px",l.style.height="1px",l.style.float="left",l.style.top="-9999px",l.style.left="-9999px",l.style.display="block",l.type="application/x-shockwave-flash",l.data=a.Pulse.AdPlayer.Settings._FLASH_AD_REQUESTER_URL,c.name="FlashVars",c.value="readyCallback=OO.Pulse.Flash.HTTPRequesterManager.onReady",h=l,h.appendChild(b),h.appendChild(c),document.body.appendChild(h),a.Pulse.Flash.RequesterSWF=h,a.Pulse.Flash.RequesterObject=h}}var f=[],g=0,h=null,i=!1,j="notLoading",k=[],l=null;return{HTTPRequesterManager:function(){function b(){setTimeout(function(){"loaded"!==j&&(j="timedOut",a.Pulse.Flash.HTTPRequesterManager.handlePendingRequests())},d)}var d;return{setRequesterTimeout:function(a){d=a},loadSwf:function(a){d=a,e(),b()},getAvailableRequestIndex:function(){return++g-1},addNewRequest:function(a,b,c,d){f[d]={onSuccess:b,onError:c}},onSuccess:function(a,b){f[b].onSuccess(decodeURIComponent(a)),delete f[b]},onError:function(a,b){f[b].onError(a),delete f[b]},onReady:function(){j="loaded",a.Pulse.Flash.HTTPRequesterManager.handlePendingRequests()},pushPendingRequest:function(a,b,c,d,e,f){k.push({type:a,uri:b,data:c,onSuccess:d,onError:e,timeout:f})},cancel:function(a,error){k[a]?(k[a].onError(error),delete k[a]):f[a]&&(f[a].onError(error),delete f[a])},handlePendingRequests:function(){for(var a=new c.HTTPRequester,b=0,d=k.length;b<d;b++){var request=k[b];request&&"GET"===request.type?(a.request(request.uri,request.onSuccess,request.onError,request.timeout),delete k[b]):request&&"POST"===request.type&&(a.postRequest(request.uri,request.onSuccess,request.onError,request.timeout),delete k[b])}}}}(),FlashHTTPRequester:function(){var b=function b(c){if(!(this instanceof a.Pulse.Flash.FlashHTTPRequester))return new b(c);h||i||e()};return b.prototype.request=function(b,c,d,e){var f=a.Pulse.Flash.HTTPRequesterManager.getAvailableRequestIndex();switch(j){case"loaded":a.Pulse.Flash.HTTPRequesterManager.addNewRequest(b,c,d,f),a.Pulse.Flash.RequesterSWF.request(b,"OO.Pulse.Flash.HTTPRequesterManager.onSuccess","OO.Pulse.Flash.HTTPRequesterManager.onError",e||0,f);break;case"timedOut":throw new Error("Flash ad requester not available");case"loading":a.Pulse.Flash.HTTPRequesterManager.pushPendingRequest("GET",b,null,c,d,e)}return function(b){a.Pulse.Flash.HTTPRequesterManager.cancel(f,b)}},b.prototype.postRequest=function(b,c,d,e,f){var g=a.Pulse.Flash.HTTPRequesterManager.getAvailableRequestIndex();switch(j){
case"loaded":a.Pulse.Flash.HTTPRequesterManager.addNewRequest(b,d,e,g),a.Pulse.Flash.RequesterSWF.request(c,"OO.Pulse.Flash.HTTPRequesterManager.onSuccess","OO.Pulse.Flash.HTTPRequesterManager.onError",f||0,g);break;case"timedOut":throw new Error("Flash ad requester not available");case"loading":a.Pulse.Flash.HTTPRequesterManager.pushPendingRequest("POST",b,c,d,e,f)}return function(b){a.Pulse.Flash.HTTPRequesterManager.cancel(g,b)}},b}(),FLASH_REQUESTER_LOAD_TIMEOUT:1e3,RequesterSWF:h,RequesterObject:h}}()}(b),function(b){var d=b.Pulse.Utils.log,e=b.Pulse.Utils.logTagged,f=b.Pulse.Utils.logNewline,g=b.Pulse.Utils.formatString;b.Pulse.AdPlayerController=function(){function h(){this._currentAd=null,this._previousAd=null,this._lastPlayedAd=null,this._currentOverlayAd=null,this._currentPauseAd=null,this._currentAdDuration=0,this._currentAdPosition=a,this._isInAdBreak=!1,this._allowUserInteraction=!1,this._sessionEnded=!1,this._currentAdPlayer=null,this._currentAdBreak=null,this._adBreakDeferred=!1,this._showSkipButtonFired=!1,this._isWaitingForAdBreakToStart=!1,this._sessionStarted=!1}function i(a){this._sessionStarted||(this._sessionStarted=!0,x.call(this,b.Pulse.AdPlayer.Events.SESSION_STARTED,{isPlayingPrerolls:a}))}function j(a){var c=C.FLASH;return a!==b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_ONLY&&a!==b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_FIRST||(c=C.HTML5),c}function k(){t.call(this);try{var a=this._currentAdPlayer;x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_ERROR),this._currentAd.adFailed(b.PulseAdError.TIMED_OUT),a.cancel(D.PlaybackTimeout)}catch(c){e([{tag:"error",color:B.ErrorLog}],"Ad player threw an error: ",c)}}function l(c){c!==a&&c.catch(function(error){t.call(this),x.call(this,b.Pulse.AdPlayer.Events.AD_PLAY_PROMISE_REJECTED,{error:error})}.bind(this))}function m(){return this._isFullScreen?b.Pulse.AdPlayer.Settings.VPAIDViewMode.FULLSCREEN:b.Pulse.AdPlayer.Settings.VPAIDViewMode.NORMAL}function n(a){if("DIV"!==a.tagName)throw new Error("The provided adContainerElement should be an HTML div.")}function o(a){if("function"!=typeof a.startContentPlayback)throw new Error("The provided OO.Pulse.AdPlayerListener implementation does not implement the required method startContentPlayback.");if("function"!=typeof a.pauseContentPlayback)throw new Error("The provided OO.Pulse.AdPlayerListener implementation does not implement the required method pauseContentPlayback.");if("function"!=typeof a.sessionEnded)throw new Error("The provided OO.Pulse.AdPlayerListener implementation does not implement the required method sessionEnded.");if("function"!=typeof a.illegalOperationOccurred)throw new Error("The provided OO.Pulse.AdPlayerListener implementation does not implement the required method illegalOperationOccurred.");if("function"!=typeof a.openClickThrough)throw new Error("The provided OO.Pulse.AdPlayerListener implementation does not implement the required method openClickThrough.")}function p(){d("Hiding ad player"),this._adContainer.style.display="none",this._playersContainer.style.display="none",this._flashAdPlayer&&this._flashAdPlayer.hide(),this._HTML5AdPlayer.hide(),this._pauseAdPlayer&&this._pauseAdPlayer.hide(),this._overlayAdPlayer&&this._overlayAdPlayer.hide()}function q(a,b){this._HTML5AdPlayer.hide(),d("Showing ad player"),this._adContainer.style.display="block",this._playersContainer.style.display="block",a===C.FLASH?this._flashAdPlayer&&this._flashAdPlayer.show(b):(this._HTML5AdPlayer.show(),b())}function r(a){return!(!a||!a.apiFramework)&&"VPAID"===a.apiFramework}function s(a,b){t.call(this),this._startAdTimeout=setTimeout(a,b)}function t(){null!==this._startAdTimeout&&(clearTimeout(this._startAdTimeout),this._startAdTimeout=null)}function u(a,g,h){f();var i=!1,j=function(){i=!0,d("Trying to start linear ad #"+h+" in the next "+g+" milliseconds",a);var c=y.call(this,a,this._platformMode);if(0===c.length)return e([{tag:"error",color:B.ErrorLog}],"No playable media files found for ad ",a),void a.adFailed(b.PulseAdError.NO_SUPPORTED_MEDIA_FILE);var f=z(c,this._platform);s.call(this,k.bind(this),g),this._currentAd=a,this._lastPlayedAd=a,this._currentAd.playableMediaFiles=c,this._currentAd.selectedMediaFile=c[0],this._showSkipButtonFired=!1,this._currentAdDuration=a.getCoreAd().creatives[0].duration,this._currentAdPosition=h,this._currentAdPlayer=f===C.HTML5?this._HTML5AdPlayer:this._flashAdPlayer,r(c[0])?q.call(this,f,function(){var b=-1!==this._width?this._width:this._adContainer.clientWidth,e=-1!==this._height?this._height:this._adContainer.clientHeight;d("Playing VPAID "+c[0].url),this._currentAdPlayer.playVPAID(c[0].url,a.getCoreAd().creatives[0].adParameters,b,e,m.call(this),this._preferredBitrate),this._currentAdPlayer.setVolume(this._muted?0:this._volume)}.bind(this)):(d("Playing linear video ad "+c[0].url),q.call(this,f,function(){this._currentAdPlayer.playVideoAd(c[0],function(a){l.call(this,a)}.bind(this)),this._currentAdPlayer.setVolume(this._muted?0:this._volume)}.bind(this)))}.bind(this),n=!1,o=function(){return i?(e([{tag:"error",color:B.ErrorLog}],"Tried to start ad after defer, but already started"),!1):(j(),!0)}.bind(this),p=function(){return n||d("Linear ad #"+h+" prevented from starting by a call to defer()",a),n=!0,o}.bind(this),t=!1;switch(this._currentAdBreak.getBreakPosition()){case b.Pulse.AdBreakPosition.POSTROLL:if(1===h)break;this._previousAd&&this._previousAd.getCoreAd().variant===c.adresponse.Ad.Variant.SPONSOR&&(t=!0);break;default:a.getCoreAd().variant===c.adresponse.Ad.Variant.SPONSOR&&(t=!0)}this._previousAd=a,x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_STARTING,{ad:a,adPosition:this._currentAdPosition,isBumperPosition:t,defer:p}),n||i||j()}function v(){this._isWaitingForAdBreakToStart&&(this._isWaitingForAdBreakToStart=!1,this._session.adBreakStarted(),this._isInAdBreak&&(i.call(this,!0),x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_STARTED,{adBreak:this._currentAdBreak})))}function w(a,c){var d=document.createElement("div"),e=document.createElement("div");d.style.width="100%",d.style.height="100%",d.style.position="absolute",d.style.top="0px",d.style.left="0px",d.id="pulseAdPlayerPlugin_"+this._uniqueId,d.style.pointerEvents="none",e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.display="block",e.id="pulseAdPlayerVideo_"+this._uniqueId,this._adContainer.style.width=a===b.Pulse.AdPlayer.Settings.SCALING.AUTO?"100%":a+"px",this._adContainer.style.height=c===b.Pulse.AdPlayer.Settings.SCALING.AUTO?"100%":c+"px",this._adContainer.style.display="none",this._adContainer.id="pulseAdPlayer_"+this._uniqueId,this._adContainer.appendChild(d),this._adContainer.appendChild(e),this._skinContainer=d,this._playersContainer=e}function x(a,b){if("linearAdProgress"!=a&&(b?e([{tag:"event",color:B.EventFiring}],A(a),b):e([{tag:"event",color:B.EventFiring}],A(a))),this._eventListeners[a])for(var c=0,d=this._eventListeners[a].length;c<d;c++)this._eventListeners[a][c](a,b)}function y(a,c){d("Checking playable media files for ad ",a.getCoreAd().id);var e=a.getMediaFiles(),h=e.length,i=0,j=null,k=null,l=[],m=[],n=[],o=document.createElement("video"),p=null,q=null,r=null;if(0===h)return[];if(!0===this._disableMediaFileFiltering)return d("Media file filtering has been deactivated. Returning all media files."),e;for(var s=0,t=e.length;s<t;s++)if(j=e[s],d(g("- Media file {index}, MIME type {mimeType}",{index:s+1,mimeType:j.mimeType})),this._session._requestSettings&&this._session._requestSettings.maxBitRate<j.bitRate)d(g("  Ignored; bitrate {bitrate} is higher than session maximum of {maxBitrate}",{bitrate:j.bitRate,maxBitrate:this._session._requestSettings.maxBitRate})),++i;else switch(j.mimeType){case"application/javascript":d("  Looks ok; should be a VPAID 2.0 creative (requires HTML5)"),m.push(j);break;case"application/x-shockwave-flash":d("  Looks ok; should be a VPAID 1.0 creative (requires Flash)"),l.push(j);break;case"video/x-flv":d("  Looks ok; should be a Flash video (requires Flash)"),l.push(j);break;default:o.canPlayType(j.mimeType)?"video/mp4"===j.mimeType?(d("  Looks ok; canPlayType() says it can be played"),n.push(j)):(d("  Looks ok; canPlayType() says it can be played (requires HTML5)"),m.push(j)):d("  Ignored; canPlayType() says it cannot be played")}if(i===h){d("All media files were discarded because their bitrate was too high; picking the one with the lowest bitrate");for(var s=0;s<e.length;++s)switch(j=e[s],j.mimeType){case"video/x-flv":(!q||j.bitRate<q.bitRate)&&(q=j);break;default:o.canPlayType(j.mimeType)&&("video/mp4"===j.mimeType?(!r||j.bitRate<r.bitRate)&&(r=j):(!p||j.bitRate<p.bitRate)&&(p=j))}p&&m.push(p),q&&l.push(q),r&&n.push(r)}switch(c){case b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_FIRST:d("HTML5_FIRST is set, going to prefer HTML5-compatible media files"),k=m.concat(n).concat(l);break;case b.Pulse.AdPlayer.Settings.RenderingMode.HTML5_ONLY:d("HTML5_ONLY is set, discarding all Flash-only media files"),k=m.concat(n);break;case b.Pulse.AdPlayer.Settings.RenderingMode.FLASH_FIRST:d("FLASH_FIRST is set, going to prefer Flash-compatible media files"),k=l.concat(n).concat(m);break;case b.Pulse.AdPlayer.Settings.RenderingMode.FLASH_ONLY:d("FLASH_ONLY is set, discarding all HTML5-only media files"),k=l.concat(n)}if(i===h&&0===k.length&&(d("All platform-compatible media files were filtered out; nothing to play"),l.length>0&&x.call(this,b.Pulse.AdPlayer.Events.FLASH_AD_BLOCKED)),f(),this._preferredMediaFormat){var u=[],v=[];for(var j in k)k[j].mimeType==this._preferredMediaFormat?u.push(k[j]):v.push(k[j]);u.length>0&&(k=u.concat(v))}return k}function z(a,b){var c=a[0],b=b;return"application/x-shockwave-flash"===c.mimeType||"video/x-flv"===c.mimeType?b=C.FLASH:"application/javascript"===c.mimeType&&(b=C.HTML5),b}function A(a){for(var c in b.Pulse.AdPlayer.Events)if(a===b.Pulse.AdPlayer.Events[c])return c;return a}var B={ApiCall:"#B8434A",EventFiring:"#249459",ErrorLog:"#B82F00"},C={HTML5:1,FLASH:2},D={Unknown:"unknown",AdSkipped:"ad_skipped",PlaybackTimeout:"playback_timeout"},E=function(a,f,g,k,l,m,o,q,s,y,z){var A=this;n(a),this._platformMode=m,this._platform=j(this._platformMode),this._startAdTimeout=null,this._adContainer=a,this._width=f,this._height=g,this._viewMode=k,this._preferredBitrate=b.Pulse.maxBitRate,this._preferredMediaFormat=null,this._disableMediaFileFiltering=!1,this._canAutoplay=!0,this._adPlayerListener=null,this._flashAdPlayer=null,this._uniqueId=l,this._eventListeners={},this._volume=y?0:1,this._muted=!!y,this._isFullScreen=!1,this._skinContainer=null,this._playersContainer=null,this._customBehaviours=q||{},this._identifier=s||"",h.call(this),this._sessionListener={startContentPlayback:function(){var a=function(){this._currentAdPlayer&&this._currentAdPlayer.cancel&&this._currentAdPlayer.cancel(),p.call(this);var a=!1,c=function(){a||(a=!0,d("Requesting content playback start .."),this._adPlayerListener.startContentPlayback(),this._isInAdBreak=!1,this._allowUserInteraction=!1,i.call(this,!1))}.bind(this),f=!1,g=function(){return f?(e([{tag:"error",color:B.ErrorLog}],"Tried to finish ad break after defer, but already finished"),!1):(f=!0,d("Ad break finished."),x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_FINISHED,{adBreak:this._currentAdBreak}),c(),!0)}.bind(this);if(this._isInAdBreak){var h=!1,j=function(){if(h)return function(){return!1};h=!0;var a=!1;return function(){return!a&&(a=!0,g(),!0)}.bind(this)}.bind(this);x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_FINISHING,{adBreak:this._currentAdBreak,isBumperPosition:!1,defer:j}),h||f||g()}else c()}.bind(this);this._currentAd&&r(this._currentAd.getMediaFiles()[0])&&b.Pulse.Settings&&b.Pulse.Settings.VPAID_COMPLETE_DELAY&&b.Pulse.Settings.VPAID_COMPLETE_DELAY>0?(d("VPAID_COMPLETE_DELAY is present, delaying content start by "+b.Pulse.Settings.VPAID_COMPLETE_DELAY+"ms"),setTimeout(a,b.Pulse.Settings.VPAID_COMPLETE_DELAY)):a()}.bind(this),emptyAdBreak:function(){x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_EMPTY)}.bind(this),startAdBreak:function(a){d("Starting linear ad break with "+a.getPlayableAdsTotal()+" playable ad position(s)"),this._lastPlayedAd=null,this._previousAd=null,this._isInAdBreak=!0,this._currentAdBreak=a,this._overlayAdPlayer&&this._overlayAdPlayer.pauseOverlay(),d("Requesting content playback pause ..");var c=this._adPlayerListener.pauseContentPlayback(),f=!1,g=!1,h=function(){return f?function(){}:(f=!0,this._adBreakDeferred=!0,this._isWaitingForAdBreakToStart=!0,function(){return g?(e([{tag:"error",color:B.ErrorLog}],"Tried to start ad break after defer, but already started"),!1):(g=!0,v.call(this),!0)}.bind(this))}.bind(this);if(i.call(this,!0),x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_STARTING,{adBreak:a,defer:h}),!1===c||this._isWaitingForAdBreakToStart)return this._isWaitingForAdBreakToStart=!0,!1;g||x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_STARTED,{adBreak:a})}.bind(this),startAdPlayback:function(a,b,c){u.call(A,a,b,c)},showPauseAd:function(a){d("Showing pause ad ",a),this._pauseAdPlayer?(this._adContainer.style.display="block",this._overlayAdPlayer.pauseOverlay(),this._pauseAdPlayer.showPauseAd(a)):this._adPlayerListener.showPauseAd?this._adPlayerListener.showPauseAd(a):(e([{tag:"error",color:B.ErrorLog}],"Can not show pause ad, no pause ad player registered",a),a.adFailedWithError(b.PulseAdError.COULD_NOT_PLAY))}.bind(this),showOverlayAd:function(a){d("Showing overlay ad ",a),this._currentOverlayAd=a,this._overlayAdPlayer?(this._adContainer.style.display="block",this._overlayAdPlayer.showOverlay(a)):this._adPlayerListener.showOverlayAd?this._adPlayerListener.showOverlayAd(a):(e([{tag:"error",color:B.ErrorLog}],"Can not show overlay ad ",a),this._currentOverlayAd.adFailedWithError(b.PulseAdError.COULD_NOT_PLAY))}.bind(this),sessionEnded:function(){p.call(this);var a=function(){this._sessionEnded||(this._sessionEnded=!0,d("Ad session ended"),this._adPlayerListener.sessionEnded(),x.call(this,b.Pulse.AdPlayer.Events.AD_SESSION_FINISHED))}.bind(this),f=!1,g=function(){return f?(e([{tag:"error",color:B.ErrorLog}],"Tried to finish ad break after defer, but already finished"),!1):(f=!0,x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_FINISHED,{adBreak:this._currentAdBreak}),a(),!0)}.bind(this),h=!1,i=function(){return h?function(){}:(h=!0,g)}.bind(this);if(this._isInAdBreak){var j=!1;this._currentAdBreak.getBreakPosition()===b.Pulse.AdBreakPosition.POSTROLL&&this._lastPlayedAd&&this._lastPlayedAd.getCoreAd().variant===c.adresponse.Ad.Variant.SPONSOR&&(j=!0),x.call(this,b.Pulse.AdPlayer.Events.AD_BREAK_FINISHING,{adBreak:this._currentAdBreak,isBumperPosition:j,defer:i}),h||g()}else a()}.bind(this),illegalOperationOccurred:function(a){d(" ! illegalOperationOccurred: ",a),this._adPlayerListener.illegalOperationOccurred(a)}.bind(this),firstQuartileReached:function(){x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_FIRST_QUARTILE,{ad:this._currentAd})}.bind(this),midpointReached:function(){x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_MIDPOINT,{ad:this._currentAd})}.bind(this),thirdQuartileReached:function(){x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_THIRD_QUARTILE,{ad:this._currentAd})}.bind(this)},this._adVideoPlayerListener={onVideoStarted:function(a){this._isInAdBreak&&(t.call(this),d("Ad started",this._currentAd),a&&a.duration&&(d("Controller is changing ad's duration from "+this._currentAd.getCoreAd().creatives[0].duration+" to "+a.duration),this._currentAd.getCoreAd().creatives[0].duration=a.duration,this._currentAd._calculateSkipOffset()),this._currentAd.adStarted(),x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_STARTED,{ad:this._currentAd,adPosition:this._currentAdPosition,selectedMediaFile:this._currentAd.selectedMediaFile}),x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_IMPRESSION,{ad:this._currentAd}),this._allowUserInteraction=!0)}.bind(this),onAdSkipped:function(){this._isInAdBreak&&(d("Ad skipped",this._currentAd),this._allowUserInteraction=!1,x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_SKIPPED),this._currentAd.adSkipped())}.bind(this),onTimeUpdate:function(a,c){this._isInAdBreak&&(c&&(this._currentAdDuration=c),this._currentAd.adPositionChanged(a),x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_PROGRESS,{position:a,duration:this._currentAdDuration}),this._currentAd.isSkippable()&&this._currentAd.getSkipOffset()<=a&&!this._showSkipButtonFired&&this._allowUserInteraction&&(this._showSkipButtonFired=!0,x.call(this,b.Pulse.AdPlayer.Events.SHOW_SKIP_BUTTON)))}.bind(this),onAdPaused:function(){this._isInAdBreak&&(d("Ad paused",this._currentAd),x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_PAUSED))}.bind(this),onAdStopped:function(){this._isInAdBreak&&(d("Ad stopped",this._currentAd),this._allowUserInteraction=!1,x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_FINISHED),this._currentAd.adStopped())}.bind(this),onAdPlaying:function(){this._isInAdBreak&&(d("Ad playing",this._currentAd),x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_PLAYING))}.bind(this),onAdVolumeChanged:function(a){this._isInAdBreak&&(d("Ad volume changed",this._currentAd),this._currentAdPlayer.changeAdVolume(a.volume),x.call(this,b.Pulse.AdPlayer.Events.AD_VOLUME_CHANGED,{volume:a.volume}))}.bind(this),onAdMuteStateChanged:function(a){this._muted=a.muteState}.bind(this),onAdAutoplayBlocked:function(){this._isInAdBreak&&(t.call(this),x.call(this,b.Pulse.AdPlayer.Events.AD_AUTOPLAY_BLOCKED))}.bind(this),onVideoError:function(error){this._isInAdBreak&&(t.call(this),this._allowUserInteraction=!1,e([{tag:"error",color:B.ErrorLog}],"Ad error: ",error,this._currentAd),x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_ERROR),this._currentAd.adFailed(b.PulseAdError.COULD_NOT_PLAY))}.bind(this),onClickThrough:function(a,b){if(this._isInAdBreak){var c=b||this._currentAd.getClickthroughURL();a&&c?this._adPlayerListener.openClickThrough(c):this.adClickThroughOpened()}}.bind(this),onAdClicked:function(){if(this._allowUserInteraction){var a=this._currentAd.getClickthroughURL();x.call(this,b.Pulse.AdPlayer.Events.AD_CLICKED,{url:a})}}.bind(this),onEnded:function(){this._isInAdBreak&&(d("Ad ended",this._currentAd),this._allowUserInteraction=!1,this._HTML5AdPlayer.applyDefaultVideoCSS(),x.call(this,b.Pulse.AdPlayer.Events.LINEAR_AD_FINISHED),this._currentAd.adFinished())}.bind(this),onVPAIDFirstQuartile:function(){if(this._isInAdBreak){var a=this._currentAd.getCoreAd().creatives[0].duration;this._currentAd.adPositionChanged(a/4+.1)}}.bind(this),onVPAIDMidpoint:function(){if(this._isInAdBreak){var a=this._currentAd.getCoreAd().creatives[0].duration;this._currentAd.adPositionChanged(a/2+.1)}}.bind(this),onVPAIDThirdQuartile:function(){if(this._isInAdBreak){var a=this._currentAd.getCoreAd().creatives[0].duration;this._currentAd.adPositionChanged(.75*a+.1)}}.bind(this),onAdProgress:function(a){var b=a.timeSeconds;this._adVideoPlayerListener.onTimeUpdate(b)}.bind(this),onAdTimeRemainingUpdate:function(a){var b=a.duration,c=b-a.timeRemainingSeconds;this._adVideoPlayerListener.onTimeUpdate(c,b)}.bind(this)},this._pauseAdPlayerListener={onClick:function(a){this._adPlayerListener.openClickThrough(a.getClickthroughURL())}.bind(this),onShow:function(a){this._currentPauseAd=a,a.adDisplayed(),x.call(this,b.Pulse.AdPlayer.Events.PAUSE_AD_SHOWN,{ad:a})}.bind(this),onClose:function(a){a.adClosed(),x.call(this,b.Pulse.AdPlayer.Events.PAUSE_AD_CLOSED,{ad:a})}.bind(this),onHide:function(){x.call(this,b.Pulse.AdPlayer.Events.PAUSE_AD_PLAYER_HIDDEN)}.bind(this),onFailed:function(a,error){error?a.adFailedWithError(error):a.adFailedWithError(b.PulseAdError.COULD_NOT_PLAY),x.call(this,b.Pulse.AdPlayer.Events.OVERLAY_AD_ERROR)}.bind(this)},this._overlayAdPlayerListener={onShow:function(a){a.adDisplayed(),x.call(this,b.Pulse.AdPlayer.Events.OVERLAY_AD_SHOWN,{ad:a})}.bind(this),onClose:function(a){a.adClosed(),x.call(this,b.Pulse.AdPlayer.Events.OVERLAY_AD_CLOSED,{ad:a})}.bind(this),onClick:function(a){this._currentOverlayAd=a,a.adClicked(),this._adPlayerListener.openClickThrough(a.getClickthroughURL()),x.call(this,b.Pulse.AdPlayer.Events.OVERLAY_AD_CLICKED,{ad:a})}.bind(this),onCollapse:function(a){a.adCollapsed(),x.call(this,b.Pulse.AdPlayer.Events.OVERLAY_AD_COLLAPSED,{ad:a})}.bind(this),onFailed:function(a,error){error?a.adFailedWithError(error):a.adFailedWithError(b.PulseAdError.COULD_NOT_PLAY),x.call(this,b.Pulse.AdPlayer.Events.OVERLAY_AD_ERROR)}.bind(this)},w.call(this,f,g),b.Pulse.Settings.DISABLE_FLASH||(this._flashAdPlayer=new b.Pulse.AdPlayer.FlashAdPlayer(this._playersContainer,this._uniqueId,this._adVideoPlayerListener)),this._HTML5AdPlayer=new b.Pulse.AdPlayer.HTML5AdPlayer(this._playersContainer,f,g,this._adVideoPlayerListener,o,this._preferredBitrate,this._canAutoplay,this._uniqueId,this._customBehaviours,y,z),this._pauseAdPlayer=new b.Pulse.AdPlayer.PauseAdPlayer(this._adContainer,this._pauseAdPlayerListener),this._overlayAdPlayer=new b.Pulse.AdPlayer.OverlayAdPlayer(this._adContainer,this._overlayAdPlayerListener)};return E.prototype={startSession:function(a,c){if(e([{tag:"API",color:B.ApiCall}],"startSession()",a,c),o(c),h.call(this),this._adPlayerListener=c,this._session=a,this._session&&this._session._requestSettings&&(this._session._requestSettings.disableMediaFileFiltering?this._disableMediaFileFiltering=!0:this._disableMediaFileFiltering=!1,this._session._requestSettings.maxBitRate&&(this._preferredBitrate=this._session._requestSettings.maxBitRate),this._session._requestSettings.preferredMediaFormat))switch(this._session._requestSettings.preferredMediaFormat){case"video/mp4":this._preferredMediaFormat=b.Pulse.PreferredMediaFormat.MP4;break;case"video/webm":this._preferredMediaFormat=b.Pulse.PreferredMediaFormat.WEBM;break;case"video/ogg":this._preferredMediaFormat=b.Pulse.PreferredMediaFormat.OGG;break;default:this._preferredMediaFormat=null}this._adPlayerListener.showOverlayAd&&(this._overlayAdPlayer=null),this._adPlayerListener.showPauseAd&&(this._pauseAdPlayer=null),this._HTML5AdPlayer.onFirstUserAction(),setTimeout(function(){this._session.startSession(this._sessionListener)}.bind(this),0)},stopSession:function(){e([{tag:"API",color:B.ApiCall}],"stopSession()");try{t.call(this)}catch(a){}this._isInAdBreak&&this._currentAdPlayer.cancel(),this._session.stopSession()},contentStarted:function(){e([{tag:"API",color:B.ApiCall}],"contentStarted()"),this._session.contentStarted(),this._overlayAdPlayer&&this._overlayAdPlayer.hasAdToShow()?(d("Hiding video ad player, resuming overlay"),this._flashAdPlayer&&this._flashAdPlayer.hide(),this._HTML5AdPlayer.hide(),this._pauseAdPlayer&&this._pauseAdPlayer.hide(),this._adContainer.style.display="block",this._overlayAdPlayer&&this._overlayAdPlayer.resumeOverlay()):p.call(this)},contentFinished:function(){e([{tag:"API",color:B.ApiCall}],"contentFinished()"),this._session.contentFinished()},contentPositionChanged:function(a){this._session.contentPositionChanged(a)},resize:function(a,c,d){a===this._width&&c===this._height&&d===this._isFullScreen||(e([{tag:"API",color:B.ApiCall}],"resize()",a,c,d),a===b.Pulse.AdPlayer.Settings.SCALING.AUTO?this._adContainer.style.width="100%":this._adContainer.style.width=a+"px",c===b.Pulse.AdPlayer.Settings.SCALING.AUTO?this._adContainer.style.height="100%":this._adContainer.style.height=c+"px",this._width=a,this._height=c,this._isFullScreen=d,this._currentAdPlayer&&this._currentAdPlayer.resize&&this._currentAdPlayer.resize(a,c,d))},addEventListener:function(a,b){this._eventListeners[a]||(this._eventListeners[a]=[]),this._eventListeners[a].push(b)},removeEventListener:function(a,b){this._eventListeners[a]&&-1!==this._eventListeners[a].indexOf(b)&&this._eventListeners[a].splice(this._eventListeners[a].indexOf(b),1)},pause:function(){e([{tag:"API",color:B.ApiCall}],"pause()"),this._currentAdPlayer&&this._currentAdPlayer.pause&&this._currentAd&&this._currentAdPlayer.pause()},play:function(){if(e([{tag:"API",color:B.ApiCall}],"play()"),this._currentAdPlayer&&this._currentAdPlayer.play&&this._currentAd){var a=this._currentAdPlayer.play();return l.call(this,a),a}},adClickThroughOpened:function(){e([{tag:"API",color:B.ApiCall}],"adClickThroughOpened()"),this._currentAd&&!this._currentAd.isStopped()?(this._currentAd.adClickThroughTriggered(),x.call(this,b.Pulse.AdPlayer.Events.AD_CLICKTHROUGH,{url:this._currentAd.getClickthroughURL()})):this._currentOverlayAd?(this._currentOverlayAd.adClickThroughTriggered(),x.call(this,b.Pulse.AdPlayer.Events.AD_CLICKTHROUGH,{url:this._currentOverlayAd.getClickthroughURL()})):this._currentPauseAd&&(this._currentPauseAd.adClickThroughTriggered(),x.call(this,b.Pulse.AdPlayer.Events.AD_CLICKTHROUGH,{url:this._currentPauseAd.getClickthroughURL()}))},setVolume:function(a){e([{tag:"API",color:B.ApiCall}],"setVolume()"+a),0===a?this._muted=!0:(this._volume=a,this._muted=!1),this._currentAdPlayer&&this._currentAdPlayer.setVolume&&this._currentAd&&this._currentAdPlayer.setVolume(a)},getVolume:function(){return this._muted?0:this._volume},mute:function(){e([{tag:"API",color:B.ApiCall}],"mute()"),this._muted||(this._muted=!0,this._currentAdPlayer&&this._currentAdPlayer.setVolume&&this._currentAd&&this._currentAdPlayer.setVolume(0))},unmute:function(){e([{tag:"API",color:B.ApiCall}],"unmute()"),this._muted&&(this._muted=!1,this._currentAdPlayer&&this._currentAdPlayer.setVolume&&this._currentAd&&this._currentAdPlayer.setVolume(this._volume))},seek:function(a){e([{tag:"API",color:B.ApiCall}],"seek()"+a),this._currentAdPlayer&&this._currentAdPlayer.seek&&this._currentAd&&this._currentAdPlayer.seek(a)},destroy:function(){e([{tag:"API",color:B.ApiCall}],"destroy()"),this._sessionEnded||this._session.stopSession();try{this._adContainer.parentElement.removeChild(this._adContainer)}catch(a){}},skipButtonClicked:function(){e([{tag:"API",color:B.ApiCall}],"skipButtonClicked()"),this._currentAdPlayer&&this._currentAdPlayer.cancel&&this._currentAdPlayer.cancel(D.AdSkipped)},contentPaused:function(){if(e([{tag:"API",color:B.ApiCall}],"contentPaused()"),this._isWaitingForAdBreakToStart){if(this._adBreakDeferred)return;v.call(this)}else this._session.contentPaused()},pauseAdClosed:function(a){e([{tag:"API",color:B.ApiCall}],"pauseAdClosed()"),this._pauseAdPlayer?(this._pauseAdPlayer.close(),p.call(this)):this._pauseAdPlayerListener.onClose(a)},pauseAdShown:function(a){this._pauseAdPlayerListener.onShow(a)},pauseAdError:function(a){this._pauseAdPlayerListener.onError(a,b.PulseAdError.COULD_NOT_PLAY)},overlayAdShown:function(a){this._overlayAdPlayerListener.onShow(a)},overlayAdError:function(a){this._overlayAdPlayerListener.onFailed(a,b.PulseAdError.COULD_NOT_PLAY)},overlayAdClosed:function(a){e([{tag:"API",color:B.ApiCall}],"overlayAdClosed()"),this._overlayAdPlayer?(this._overlayAdPlayer.closeOverlay(),p.call(this)):this._overlayAdPlayerListener.onClose(a)},overlayAdClicked:function(a){this._overlayAdPlayerListener.onClick(a)},getSkinElement:function(){return this._skinContainer},getOverlayDiv:function(){return this._overlayAdPlayer.div},getIdentifier:function(){return this._identifier},getContainer:function(){return this._adContainer},isFlashAvailable:function(){return b.Pulse.Utils.isFlashAvailable()},_onFlashPlayerEvent:function(a,b){this._flashAdPlayer._onFlashPlayerEvent(a,b)}},E}()}(b),function(b){b.Pulse.AdPlayer.Linear.Video.AdPlaybackController=function(){function b(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function c(){return b()?"touchend":"click"}function d(){this._videoElement.addEventListener("timeupdate",this.onTimeUpdate),this._videoElement.addEventListener("canplay",this.onCanPlay),this._videoElement.addEventListener("ended",this.onEnded),this._videoElement.addEventListener("play",this.onPlay),this._videoElement.addEventListener("pause",this.onPause),this._videoElement.addEventListener("volumechange",this.onVolumeChanged),this._videoElement.addEventListener(c(),this.onClick),this._videoElement.addEventListener("error",this.onError),this._videoElement.addEventListener("touchstart",this.onTouchStart),this._videoElement.addEventListener("touchmove",this.onTouchMove)}function e(){this._videoElement.removeEventListener("timeupdate",this.onTimeUpdate),this._videoElement.removeEventListener("canplay",this.onCanPlay),this._videoElement.removeEventListener("ended",this.onEnded),this._videoElement.removeEventListener("play",this.onPlay),this._videoElement.removeEventListener("pause",this.onPause),this._videoElement.removeEventListener("volumechange",this.onVolumeChanged),this._videoElement.removeEventListener(c(),this.onClick),this._videoElement.removeEventListener("error",this.onError),this._videoElement.removeEventListener("touchstart",this.onTouchStart),this._videoElement.removeEventListener("touchmove",this.onTouchMove)}var f=function(b,c,f,g,h,i,j){var k=this;this._videoElement=c,this._hasStarted=!1,this._hasTriggeredPlay=!1,this._paused=!1,this._stopped=!1,this._usingSharedElement=!!h,this._customBehaviours=i||{},this._onPlayCalled=j,this._userScrolled=!1,this._currentMuteState=!1,this.onTimeUpdate=function(){""===this._videoElement.src&&this._videoElement.src!==this._videoElement.currentSrc?(this._videoElement.src=b.url,this._videoElement.load()):(this._usingSharedElement&&this._videoElement.src===b.url&&this._videoElement.currentTime>0&&this.onPlay(),this._adPlayerListener.onTimeUpdate(this._videoElement.currentTime))}.bind(this),this.onCanPlay=function(){if(!this._hasTriggeredPlay){this._hasTriggeredPlay=!0;var a=this._videoElement.play();this._onPlayCalled&&this._onPlayCalled(a)}}.bind(this),this.onEnded=function(){e.call(this),this._usingSharedElement||(this._videoElement.src=""),this._adPlayerListener.onEnded()}.bind(this),this.onPlay=function(){if(this._hasStarted)return void(this._paused&&(this._adPlayerListener.onAdPlaying(),this._paused=!1));this._hasStarted=!0;var a={};!isNaN(this._videoElement.duration)&&this._videoElement.duration>0&&(a.duration=this._videoElement.duration),this._adPlayerListener.onVideoStarted(a),
this._adPlayerListener.onAdVolumeChanged({volume:this._videoElement.volume}),this._adPlayerListener.onAdPlaying()}.bind(this),this.onPause=function(){this._paused||(this._paused=!0,this._adPlayerListener.onAdPaused())}.bind(this),this.onVolumeChanged=function(b){b.target.muted!=a&&(this._currentMuteState!=b.target.muted&&this._adPlayerListener.onAdMuteStateChanged({muteState:b.target.muted}),this._currentMuteState=b.target.muted)}.bind(this),this.onClick=function(){this._userScrolled||this._adPlayerListener.onAdClicked()}.bind(this),this.onError=function(){var a="Unknown error";this._videoElement.error&&this._videoElement.error.message&&(a=this._videoElement.error.message),e.call(this),this._usingSharedElement||(this._videoElement.src=""),this._adPlayerListener.onVideoError(a)}.bind(this),this.onTouchStart=function(){k._userScrolled=!1},this.onTouchMove=function(){k._userScrolled=!0},d.call(this),this._adPlayerListener=g,"function"==typeof this._customBehaviours.setVideoSource?this._customBehaviours.setVideoSource(b,this._videoElement):this._videoElement.src=b.url,this._usingSharedElement||(this._videoElement.volume=f),this._videoElement.load()};return f.prototype={play:function(){if(!this._stopped)return this._videoElement.play()},pause:function(){this._stopped||this._videoElement.pause()},stop:function(a){this._stopped||(e.call(this),this._stopped=!0,this._usingSharedElement||this._videoElement.pause(),"ad_skipped"===a&&this._adPlayerListener.onAdSkipped())},setVolume:function(a){this._videoElement&&!this._stopped&&(this._videoElement.volume=a,this._videoElement.muted=!a,this._adPlayerListener.onAdVolumeChanged({volume:a}))},seek:function(a){this._stopped||(this._videoElement.currentTime=a)},resize:function(a,b,c){}},f}()}(b),function(a){var b=a.Pulse.Utils.log,c=a.Pulse.Utils.logTagged,d={ErrorLog:"#b82f00",VPAID:"#875527"};a.Pulse.VPAIDWrapper=function(){var a=function(a,b,c,d,e){this._creative=a,this.checkVPAIDInterface(a)&&(this._playbackController=d,this._listener=b,this._adContainer=c,this._adFinishedCallback=e,this.setCallbacksForCreative(),this._isStopped=!1,this._adStarted=!1,this._stopReason=null,this._stopTimeout=null,this._timeUpdateTimerId=null,this._onTimeUpdate=function(){var a=this._creative.getAdDuration(),c=this._creative.getAdRemainingTime();a>0&&c>0&&b.onTimeUpdate(a-c,a)}.bind(this),this._viewMode="normal",this._adResizerId=null)};return a.prototype.startAdResizer=function(){this.stopAdResizer(),this._adResizerId=setInterval(function(){this._creative.getAdWidth()!==this._adContainer.offsetWidth&&this._creative.getAdHeight()!==this._adContainer.offsetHeight&&this.resizeAd(this._adContainer.offsetWidth,this._adContainer.offsetHeight,this._viewMode)}.bind(this),100)},a.prototype.stopAdResizer=function(){this._adResizerId&&(clearInterval(this._adResizerId),this._adResizerId=null)},a.prototype.startTimeUpdateTimer=function(){this._timeUpdateTimerId&&this.stopTimeUpdateTimer(),this._timeUpdateTimerId=setInterval(this._onTimeUpdate,100)},a.prototype.stopTimeUpdateTimer=function(){this._timeUpdateTimerId&&(clearTimeout(this._timeUpdateTimerId),this._timeUpdateTimerId=null)},a.prototype.checkVPAIDInterface=function(a){return!!(a.handshakeVersion&&"function"==typeof a.handshakeVersion&&a.initAd&&"function"==typeof a.initAd&&a.startAd&&"function"==typeof a.startAd&&a.stopAd&&"function"==typeof a.stopAd&&a.skipAd&&"function"==typeof a.skipAd&&a.resizeAd&&"function"==typeof a.resizeAd&&a.pauseAd&&"function"==typeof a.pauseAd&&a.resumeAd&&"function"==typeof a.resumeAd&&a.expandAd&&"function"==typeof a.expandAd&&a.collapseAd&&"function"==typeof a.collapseAd&&a.subscribe&&"function"==typeof a.subscribe&&a.unsubscribe&&"function"==typeof a.unsubscribe)},a.prototype.setCallbacksForCreative=function(){for(var b in a.prototype)this[b]=a.prototype[b].bind(this);var c={AdStarted:this.AdStarted,AdStopped:this.AdStopped,AdSkipped:this.AdSkipped,AdLoaded:this.AdLoaded,AdLinearChange:this.AdLinearChange,AdSizeChange:this.AdSizeChange,AdExpandedChange:this.AdExpandedChange,AdSkippableStateChange:this.AdSkippableStateChange,AdDurationChange:this.AdDurationChange,AdRemainingTimeChange:this.AdRemainingTimeChange,AdVolumeChange:this.AdVolumeChange,AdImpression:this.AdImpression,AdClickThru:this.AdClickThru,AdInteraction:this.AdInteraction,AdVideoStart:this.AdVideoStart,AdVideoFirstQuartile:this.AdVideoFirstQuartile,AdVideoMidpoint:this.AdVideoMidpoint,AdVideoThirdQuartile:this.AdVideoThirdQuartile,AdVideoComplete:this.AdVideoComplete,AdUserAcceptInvitation:this.AdUserAcceptInvitation,AdUserMinimize:this.AdUserMinimize,AdUserClose:this.AdUserClose,AdPaused:this.AdPaused,AdPlaying:this.AdPlaying,AdError:this.AdError,AdLog:this.AdLog};for(var d in c)this._creative.subscribe(c[d],d,this)},a.prototype.initAd=function(a,e,f,g,h,i){b("Initializing VPAID 2.0 ad ..");try{var j=String(this._creative.handshakeVersion("2.0"));if(c([{tag:"vpaid2",color:d.VPAID}],"version:",j),!(j.length>0&&"2"===j[0]))return c([{tag:"vpaid2",color:d.VPAID}],"Unsupported VPAID version, stopping the ad"),void this.stopAd("error")}catch(k){return c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"initAd: exception thrown by the VPAID ad:",k),void this.stopAd("error")}try{this._creative.initAd(a,e,f,g,h,i)}catch(k){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"initAd: exception thrown by the VPAID ad:",k),this.stopAd("error")}},a.prototype.AdPaused=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdPaused"),this.stopAdResizer(),this.stopTimeUpdateTimer(),this._listener.onAdPaused()},a.prototype.AdPlaying=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdPlaying"),this.startAdResizer(),this.startTimeUpdateTimer(),this._listener.onAdPlaying()},a.prototype.AdError=function(a){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"AdError: ",a),this.stopAd("error")},a.prototype.AdLog=function(a){c([{tag:"vpaid2",color:d.VPAID}],"AdLog: ",a)},a.prototype.AdUserAcceptInvitation=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdUserAcceptInvitation")},a.prototype.AdUserMinimize=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdUserMinimize")},a.prototype.AdUserClose=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdUserClose"),this._listener.onAdSkipped(),this.stopAd("stop")},a.prototype.AdSkippableStateChange=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdSkippableStateChange: ",this._creative.getAdSkippableState())},a.prototype.AdExpandedChange=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdExpandedChange: ",this._creative.getAdExpanded())},a.prototype.getAdExpanded=function(){return c([{tag:"vpaid2",color:d.VPAID}],"getAdExpanded"),this._creative.getAdExpanded()},a.prototype.getAdSkippableState=function(){return c([{tag:"vpaid2",color:d.VPAID}],"getAdSkippableState"),this._creative.getAdSkippableState()},a.prototype.AdSizeChange=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdSizeChange: ",this._creative.getAdWidth(),this._creative.getAdHeight())},a.prototype.AdDurationChange=function(){},a.prototype.AdRemainingTimeChange=function(){},a.prototype.getAdRemainingTime=function(){return c([{tag:"vpaid2",color:d.VPAID}],"getAdRemainingTime"),this._creative.getAdRemainingTime()},a.prototype.AdImpression=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdImpression"),this._listener.onVideoStarted(),this._adStarted=!0,this.startTimeUpdateTimer(),this._playbackController.vpaidEvent("AdImpression")},a.prototype.AdClickThru=function(a,b,c){this._listener.onClickThrough(c,a)},a.prototype.AdInteraction=function(a){c([{tag:"vpaid2",color:d.VPAID}],"AdInteraction")},a.prototype.AdVideoStart=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdVideoStart")},a.prototype.AdVideoFirstQuartile=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdVideoFirstQuartile"),this._listener.onVPAIDFirstQuartile()},a.prototype.AdVideoMidpoint=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdVideoMidpoint"),this._listener.onVPAIDMidpoint()},a.prototype.AdVideoThirdQuartile=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdVideoThirdQuartile"),this._listener.onVPAIDThirdQuartile()},a.prototype.AdVideoComplete=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdVideoComplete")},a.prototype.AdLinearChange=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdLinearChange: ",this._creative.getAdLinear())},a.prototype.getAdLinear=function(){return c([{tag:"vpaid2",color:d.VPAID}],"getAdLinear"),this._creative.getAdLinear()},a.prototype.startAd=function(){c([{tag:"vpaid2",color:d.VPAID}],"startAd"),this._creative.startAd()},a.prototype.AdLoaded=function(){var a=this._creative.getAdLinear()?"linear":"non-linear";c([{tag:"vpaid2",color:d.VPAID}],"AdLoaded: ad is "+a),this.startAd()},a.prototype.AdStarted=function(){c([{tag:"vpaid2",color:d.VPAID}],"AdStarted"),this.startAdResizer()},a.prototype.stopAd=function(a){if(!this._isStopped)if(null!=this._stopTimeout)c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"stopAd: Multiple stopAd events triggered. VPAIDWrapper, force stop Ad:",a),this.AdStopped();else{this._stopTimeout=setTimeout(this.AdStopped,1e3),this._stopReason=a;try{this._creative.stopAd()}catch(b){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"stopAd: exception thrown by the VPAID ad:",b),this.AdStopped()}}this.stopAdResizer()},a.prototype.AdStopped=function(){switch(clearTimeout(this._stopTimeout),this.stopTimeUpdateTimer(),this._isStopped=!0,c([{tag:"vpaid2",color:d.VPAID}],"Ad has stopped"),this._stopReason){case"complete":this._listener.onEnded();break;case"error":this._listener.onVideoError();break;case"stop":break;case"ad_skipped":this._listener.onAdSkipped();break;default:this._listener.onEnded()}this.stopAdResizer(),this._adFinishedCallback()},a.prototype.AdSkipped=function(){c([{tag:"vpaid2",color:d.VPAID}],"Ad was skipped"),this.stopAd("ad_skipped")},a.prototype.setAdVolume=function(a){try{this._creative.setAdVolume(a)}catch(b){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"setAdVolume: exception thrown by the VPAID ad.",b),this.stopAd("error")}},a.prototype.getAdVolume=function(){try{return this._creative.getAdVolume()}catch(a){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"setAdVolume: exception thrown by the VPAID ad.",a),this.stopAd("error")}},a.prototype.AdVolumeChange=function(){c([{tag:"vpaid2",color:d.VPAID}],"Ad volume changed: ",this._creative.getAdVolume()),this._listener.onAdVolumeChanged({volume:this._creative.getAdVolume()})},a.prototype.resizeAd=function(a,b,e){try{this._adStarted&&(this._viewMode=e,this._creative.resizeAd(a,b,e))}catch(f){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"resizeAd: exception thrown by the VPAID ad.",f),this.stopAd("error")}},a.prototype.pauseAd=function(){try{this._creative.pauseAd()}catch(a){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"pauseAd: exception thrown by the VPAID ad.",a),this.stopAd("error")}},a.prototype.resumeAd=function(){try{this._creative.resumeAd()}catch(a){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"resumeAd: exception thrown by the VPAID ad.",a),this.stopAd("error")}},a.prototype.expandAd=function(){try{this._creative.expandAd()}catch(a){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"expandAd: exception thrown by the VPAID ad.",a),this.stopAd("error")}},a.prototype.collapseAd=function(){try{this._creative.collapseAd()}catch(a){c([{tag:"vpaid2",color:d.VPAID},{tag:"error",color:d.ErrorLog}],"collapseAd: exception thrown by the VPAID ad.",a),this.stopAd("error")}},a}()}(b),function(a){a.Pulse.AdPlayer.Linear.VPAID.VPAIDAdPlaybackController=function(){function b(b){this._vpaidIframe.contentWindow.OOstartVPAIDPlayback||(this._vpaidIframe.contentWindow.OOstartVPAIDPlayback=function(){var c=this._vpaidIframe.contentWindow.getVPAIDAd;if(c&&"function"==typeof c){var e=c();this._vpaidAd=new a.Pulse.VPAIDWrapper(e,this._adPlayerListener,this._adContainer,this,function(){this._vpaidIframe.parentElement&&this._vpaidIframe.parentElement.removeChild(this._vpaidIframe),this._vpaidContainer.parentElement&&this._vpaidContainer.parentElement.removeChild(this._vpaidContainer),this._videoElement.removeEventListener("timeupdate",this.onTimeUpdate),this._videoElement.pause(),this._vpaidAd=null}.bind(this)),d.call(this,this._vpaidAd,b)}}.bind(this))}function c(a){var b=document.createElement("div");return b.id="vpaidContainer_"+Math.random(),b.style.width="100%",b.style.height="100%",b.style.position="absolute",b.style.top="0px",b.style.left="0px",b.style.left="0px",b.style.display="block",a.appendChild(b),b}function d(b,c){var d=function(){var d={AdParameters:c},f={};if(this._stopped)this._adContainer.removeChild(this._vpaidContainer);else{f.slot=e.getElementById("vpaid_slot");var g=function(b){this._impressionTriggered||(a.Pulse.Utils.log("Detected blocked autoplay in VPAID iframe"),this._adPlayerListener.onAdAutoplayBlocked(),f.slot.removeEventListener("suspend",g,!0))}.bind(this);f.slot.addEventListener("suspend",g,!0),f.slot.addEventListener("playing",function(){f.slot.removeEventListener("suspend",g,!0)},!0),f.videoSlot=this._videoElement,f.videoSlotCanAutoplay=this._canAutoplay,b.initAd(this._adContainer.offsetWidth,this._adContainer.offsetHeight,this._viewMode,this._desiredBitrate,d,f),this._videoElement.addEventListener("timeupdate",this.onTimeUpdate)}}.bind(this),e=this._vpaidIframe.contentWindow.document;e.addEventListener("DOMContentLoaded",d)}var e=function(a,d,e,f,g,h,i,j,k,l,m){this._vpaidIframe=document.createElement("iframe"),this._vpaidIframe.id="pulse-vpaid-frame",this._vpaidIframe.frameBorder=0,this._vpaidIframe.style.width="100%",this._vpaidIframe.style.height="100%",this._vpaidIframe.style["pointer-events"]="auto",this._adPlayerListener=g,this._volume=f,this._adContainer=e,this._videoElement=h,this._canAutoplay=i,this._width=k,this._height=l,this._viewMode=m,this._desiredBitrate=j,this._vpaidContainer=c(this._adContainer),this._vpaidContainer.appendChild(this._vpaidIframe),this._stopped=!1,this._impressionTriggered=!1;var n=this._vpaidIframe.contentWindow.document;this.onTimeUpdate=function(){this._adPlayerListener.onTimeUpdate(this._videoElement.currentTime)}.bind(this),b.call(this,d),n.open(),n.write('<head><style>body { overflow: hidden; margin: 0px; } #vpaid_slot { height: 100% }</style></head><body><div id="vpaid_slot"><script onload="OOstartVPAIDPlayback()" src="'+a+'"><\/script></div></body>'),n.close(),b.call(this,d)};return e.prototype={play:function(){!this._stopped&&this._vpaidAd&&this._vpaidAd.resumeAd()},pause:function(){!this._stopped&&this._vpaidAd&&this._vpaidAd.pauseAd()},stop:function(a){"ad_skipped"===a?this._vpaidAd.stopAd(a):this._vpaidAd&&this._vpaidAd.stopAd("stop"),this._stopped=!0},setVolume:function(a){!this._stopped&&this._vpaidAd&&this._vpaidAd.setAdVolume(a)},seek:function(a){},resize:function(b,c,d){!this._stopped&&this._vpaidAd&&(this._viewMode=d?a.Pulse.AdPlayer.Settings.VPAIDViewMode.FULLSCREEN:a.Pulse.AdPlayer.Settings.VPAIDViewMode.NORMAL,this._vpaidAd.resizeAd(b,c,this._viewMode))},vpaidEvent:function(a){"AdImpression"===a&&(this._impressionTriggered=!0)}},e}()}(b),function(a){a.Pulse.AdPlayer.HTML5AdPlayer=function(){function b(a,b,c){d.call(this,a,b,c)}function c(a){return!(!a||"function"!=typeof a.canPlayType||"function"!=typeof a.play||"function"!=typeof a.pause||"function"!=typeof a.load||"function"!=typeof a.addEventListener||"function"!=typeof a.removeEventListener)}function d(a,b,d){if(a){if(!c(a))throw new Error("If provided, sharedVideoElement must be a valid HTML5 video element.");this._video=a}else{var e=this._adContainer;e.style.width=this._width+"px",e.style.height=this._height+"px",this._video=document.createElement("video"),this._video.id="pulseAdPlayerHTML5_"+this._uniqueId,this.applyDefaultVideoCSS(),this._isUsingSharedElement||(this._video.style.display="none"),b&&(this._video.setAttribute("autoplay",""),this._video.setAttribute("muted",""),this.changeAdVolume(0)),d&&this._video.setAttribute("playsinline",""),e.style.display="none",e.appendChild(this._video)}}var e=function(a,c,d,e,f,g,h,i,j,k,l){this._adContainer=a,this._width=c,this._height=d,this._video=null,this._vpaidIframe=null,this._currentAd=null,this._adPlayerListener=e,this._vpaidAd=null,this._adsVolume=1,this._preferredBitrate=g,this._canAutoplay=h,this._isUsingSharedElement=!!f,this._uniqueId=i,this._customBehaviours=j||{},b.call(this,f,k,l)};return e.prototype={onFirstUserAction:function(){this._isUsingSharedElement&&0===this._video.readyState&&this._video.load()},applyDefaultVideoCSS:function(){this._isUsingSharedElement||(this._video.style.position="absolute",this._video.style.width="100%",this._video.style.opacity="1",this._video.style.height="100%",this._video.style.float="left",this._video.style.top="0px",this._video.style.left="0px",this._video.style.background="black")},playVideoAd:function(b,c){this._currentAd=new a.Pulse.AdPlayer.Linear.Video.AdPlaybackController(b,this._video,this._adsVolume,this._adPlayerListener,this._isUsingSharedElement,this._customBehaviours,c)},playVPAID:function(b,c,d,e,f,g){this._width=d,this._height=e,this._preferredBitrate=g,this.applyDefaultVideoCSS(),this._currentAd=new a.Pulse.AdPlayer.Linear.VPAID.VPAIDAdPlaybackController(b,c,this._adContainer,this._adsVolume,this._adPlayerListener,this._video,this._canAutoplay,this._preferredBitrate,this._width,this._height,f)},show:function(){this._isUsingSharedElement||(this._video.style.display="block")},hide:function(){this._isUsingSharedElement||(this._video.style.display="none")},cancel:function(a){this._currentAd.stop(a)},pause:function(){this._currentAd.pause()},play:function(){return this._currentAd.play()},setVolume:function(a){this._adsVolume=a,this._currentAd.setVolume(a)},changeAdVolume:function(a){this._video.volume=a},seek:function(a){this._currentAd.seek(a)},resize:function(b,c,d){b!==a.Pulse.AdPlayer.Settings.SCALING.AUTO&&c!==a.Pulse.AdPlayer.Settings.SCALING.AUTO?this._currentAd.resize(b,c,d):this._currentAd.resize(this._adContainer.offsetWidth,this._adContainer.offsetHeight,d)}},e}()}(b),function(a){a.Pulse.AdPlayer.FlashAdPlayer=function(){function b(){this._flashCallbacks[e.ERROR]=this._adVideoPlayerListener.onVideoError,this._flashCallbacks[e.AD_STARTED]=this._adVideoPlayerListener.onVideoStarted,this._flashCallbacks[e.IMPRESSION]=this._adVideoPlayerListener.onVideoStarted,this._flashCallbacks[e.FIRST_QUARTILE]=this._adVideoPlayerListener.onVPAIDFirstQuartile,this._flashCallbacks[e.MIDPOINT]=this._adVideoPlayerListener.onVPAIDMidpoint,this._flashCallbacks[e.THIRD_QUARTILE]=this._adVideoPlayerListener.onVPAIDThirdQuartile,this._flashCallbacks[e.COMPLETE]=this._adVideoPlayerListener.onEnded,this._flashCallbacks[e.PROGRESS]=this._adVideoPlayerListener.onAdProgress,this._flashCallbacks[e.AD_CLICKED]=this._adVideoPlayerListener.onAdClicked,this._flashCallbacks[e.CLICKTHROUGH]=function(a){this._onClickThrough.call(this,a)}.bind(this),this._flashCallbacks[e.TIME_REMAINING]=this._adVideoPlayerListener.onAdTimeRemainingUpdate,this._flashCallbacks[e.PAUSED]=this._adVideoPlayerListener.onAdPaused,this._flashCallbacks[e.PLAYING]=this._adVideoPlayerListener.onAdPlaying,this._flashCallbacks[e.VOLUME_CHANGED]=this._adVideoPlayerListener.onAdVolumeChanged,this._flashCallbacks[e.STOPPED]=c.bind(this)}function c(){"ad_skipped"===this._cancelReason?this._adVideoPlayerListener.onAdSkipped():"playback_error"===this._cancelReason||this._adVideoPlayerListener.onAdStopped()}function d(){try{return this._flashObject.isReady()}catch(a){return!1}}var e={READY:1,ERROR:2,FIRST_QUARTILE:3,MIDPOINT:4,THIRD_QUARTILE:5,COMPLETE:6,IMPRESSION:7,AD_STARTED:8,PROGRESS:9,CLICKTHROUGH:10,TIME_REMAINING:11,PAUSED:12,PLAYING:13,VOLUME_CHANGED:14,AD_CLICKED:15,STOPPED:16},f=function(c,d,e){var f=document.createElement("object"),g=document.createElement("param"),h=document.createElement("param");this._adContainer=c,this._uniqueId=d,this._adVideoPlayerListener=e,this._isDisplayed=!1,this._cancelReason=null,g.name="allowscriptaccess",g.value="always",f.id="pulseFlashAdPlayer_"+this._uniqueId,f.style.position="absolute",f.style.width="100%",f.style.opacity="1",f.style.height="100%",f.style.float="left",f.style.top="0px",f.style.left="0px",f.style.display="none",f.type="application/x-shockwave-flash",f.data=a.Pulse.AdPlayer.Settings._FLASH_AD_PLAYER_URL,h.name="FlashVars",h.value="playerId="+this._uniqueId+"&jsCallback=OO.Pulse._fromFlash",f.appendChild(g),f.appendChild(h),this._adContainer.appendChild(f),this._flashObject=f,this._flashCallbacks=[],b.call(this)};return f.prototype={playVideoAd:function(a){this._cancelReason=null;try{this._isDisplayed&&this._flashObject.playVideoAd(a.url)}catch(b){this._adVideoPlayerListener.onVideoError()}},playVPAID:function(a,b,c,d,e,f){this._cancelReason=null;try{this._isDisplayed&&this._flashObject.playVPAID(a,b,c,d,e,f)}catch(g){this._adVideoPlayerListener.onVideoError()}},show:function(a){d.call(this)?(this._isDisplayed=!0,this._flashObject.style.display="block",a()):(this._flashCallbacks[e.READY]=function(){this._isDisplayed=!0,a()}.bind(this),this._flashObject.style.display="block")},hide:function(){try{this._isDisplayed=!1,this._flashObject.style.display="none"}catch(a){}},cancel:function(b){this._cancelReason=b;try{this._isDisplayed&&this._flashObject.cancel(b)}catch(c){a.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],"Could not stop Flash ad player: ",c)}},pause:function(){try{this._isDisplayed&&this._flashObject.pause()}catch(a){this._adVideoPlayerListener.onVideoError()}},play:function(){try{this._isDisplayed&&this._flashObject.play()}catch(a){this._adVideoPlayerListener.onVideoError()}},setVolume:function(a){try{this._isDisplayed&&this._flashObject.setVolume(a)}catch(b){this._adVideoPlayerListener.onVideoError()}},changeAdVolume:function(a){},seek:function(a){try{this._isDisplayed&&this._flashObject.seek(a)}catch(b){this._adVideoPlayerListener.onVideoError()}},resize:function(b,c,d){try{this._isDisplayed&&b!==a.Pulse.AdPlayer.Settings.SCALING.AUTO&&c!==a.Pulse.AdPlayer.Settings.SCALING.AUTO&&this._flashObject.resize(b,c,d)}catch(e){this._adVideoPlayerListener.onVideoError()}},_onFlashPlayerEvent:function(a,b){this._flashCallbacks[a]&&this._flashCallbacks[a](b)},_onClickThrough:function(a){this._adVideoPlayerListener.onClickThrough(a.playerHandles,a.url)}},f}()}(b),function(a){a.Pulse.AdPlayer.PauseAdPlayer=function(){function b(a){var b=document.createElement("div");return b.style.width="100%",b.style.height="100%",b.style.position="absolute",b.style.top="0px",b.style.float="left",b.style.left="0px",b.style.display="none",b}function c(a,b,c){var d=document.createElement("object");d.style.width="100%",d.style.margin="auto",d.style.display="block",d.style.top="0px",d.style.left="0px",d.style.right="0px",d.style.bottom="0px",d.type="application/x-shockwave-flash",d.data=a.getResourceURL(),d.onload=function(){c(a)},b.appendChild(d)}function d(a,b,c){var d=document.createElement("img");d.style.width="100%",d.style.margin="auto",d.style.display="block",d.style.top="0px",d.style.left="0px",d.style.right="0px",d.style.bottom="0px",d.style.position="absolute",d.style.cursor="pointer",d.src=a.getResourceURL(),d.onload=function(){c(a)},b.appendChild(d)}var e=function(a,c){this._container=a,this._div=b(a),this._container.appendChild(this._div),this._ad=null,this._pauseAdPlayerListener=c,this._div.addEventListener("click",function(){this._pauseAdPlayerListener.onClick(this._ad)}.bind(this))};return e.prototype={showPauseAd:function(b){"splash"!==b.getType()&&b.adFailedWithError(a.PulseAdError.NO_SUPPORTED_MEDIA_FILE),"application/x-shockwave-flash"===b.getResourceMimeType()?a.Pulse.Utils.isFlashAvailable()&&!a.Pulse.Settings.DISABLE_FLASH?(c(b,this._div,this._pauseAdPlayerListener.onShow),this._ad=b,this._div.style.display="block"):b.adFailedWithError(a.PulseAdError.NO_SUPPORTED_MEDIA_FILE):/image\/.*/.test(b.getResourceMimeType())?(this._div.style.display="block",d(b,this._div,this._pauseAdPlayerListener.onShow),this._ad=b):(a.Pulse.Utils.logTagged([{tag:"error",color:"#B82F00"}],"Pause ad type not supported",b.getResourceMimeType()),b.adFailedWithError(a.PulseAdError.NO_SUPPORTED_MEDIA_FILE))},hide:function(a){this._div.style.display="none",this._div.innerHTML="",(a||this._ad)&&(this._pauseAdPlayerListener.onHide(),this._ad=null)},close:function(){this.hide(!0),this._ad&&this._pauseAdPlayerListener.onClose(this._ad)}},e}()}(b),function(a){var b=a.Pulse.Utils.log,c=a.Pulse.Utils.logTagged;a.Pulse.AdPlayer.OverlayAdPlayer=function(){function d(a,b){var c=document.createElement("img");c.style.width="100%",c.style.height="auto",c.style.position="relative",c.style.left="0px",c.style.right="0px",c.style.display="block",c.style.marginRight="auto",c.style.marginLeft="auto",c.style.pointerEvents="all",c.style.cursor="pointer",c.onload=function(){e.call(this)}.bind(this),c.onclick=function(){f.call(this)}.bind(this),c.onerror=function(){g.call(this)}.bind(this),c.src=a.getResourceURL(),this._imageOverlayDiv=c,b.appendChild(c)}function e(){b("Overlay ad loaded"),this._overlayListener.onShow(this._currentAd),this._currentAdTimeLeftMillis=1e3*this._currentAd.getDuration(),j.call(this)}function f(){b("Overlay ad clicked"),this._overlayListener.onClick(this._currentAd)}function g(){b("Failed to display overlay ad"),this._overlayListener.onFailed(this._currentAd),i.call(this)}function h(){var a=document.createElement("div");return a.style.width="70%",a.style.position="absolute",a.style.left="0px",a.style.right="0px",a.style.bottom="10%",a.style.display="none",a.style.marginRight="auto",a.style.marginLeft="auto",a.style.pointerEvents="none",a.className="pulse-overlay",a}function i(){this.div.style.display="none",this._flashOverlayDiv&&this._flashOverlayDiv.parentNode&&this._flashOverlayDiv.parentNode.removeChild(this._flashOverlayDiv),this._imageOverlayDiv&&this._imageOverlayDiv.parentNode&&this._imageOverlayDiv.parentNode.removeChild(this._imageOverlayDiv),this._currentAd=null}function j(){this._lastAdStart=Date.now(),this._closeTimeout=setTimeout(function(){i.call(this)}.bind(this),this._currentAdTimeLeftMillis)}var k=function(a,b){this.div=h(),this._overlayListener=b,a.appendChild(this.div),this._lastAdStart=0,this._currentAdTimeLeftMillis=0,this._closeTimeout=null,this._currentAd=null,this._flashOverlayDiv=null,this._imageOverlayDiv=null};return k.prototype={showOverlay:function(e){b("Showing an overlay ad for "+e.getDuration()+" seconds. URL is  "+e.getResourceURL(),e),clearTimeout(this._closeTimeout),this._currentAd=e,this._flashOverlayDiv&&this._flashOverlayDiv.parentNode&&this._flashOverlayDiv.parentNode.removeChild(this._flashOverlayDiv),this._imageOverlayDiv&&this._imageOverlayDiv.parentNode&&this._imageOverlayDiv.parentNode.removeChild(this._imageOverlayDiv),this.div.style.display="block","application/x-shockwave-flash"===this._currentAd.getResourceMimeType()?(this._overlayListener.onFailed(this._currentAd,a.PulseAdError.NO_SUPPORTED_MEDIA_FILE),i.call(this)):/image\/.*/.test(this._currentAd.getResourceMimeType())?d.call(this,this._currentAd,this.div):(c([{tag:"error",color:"#B82F00"}],"Overlay ad type not supported",this._currentAd.getResourceMimeType()),this._overlayListener.onFailed(this._currentAd,a.PulseAdError.NO_SUPPORTED_MEDIA_FILE))},hide:function(){this.div.style.display="none"},pauseOverlay:function(){b("Pausing overlay ad"),this.div.style.display="none",this._currentAdTimeLeftMillis=this._currentAdTimeLeftMillis-(Date.now()-this._lastAdStart),clearTimeout(this._closeTimeout)},resumeOverlay:function(){this._currentAd&&"none"===this.div.style.display&&(b("Resuming overlay ad. Still has "+this._currentAdTimeLeftMillis/1e3+" seconds to show"),this.div.style.display="block",j.call(this))},closeOverlay:function(){b("Closing overlay ad."),this._overlayListener.onClose(this._currentAd),i.call(this)},hasAdToShow:function(){return!!this._currentAd}},k}()}(b),window.videoplaza=c,window.videoplaza.buildDate="20190402",window.videoplaza.versionNumber="2.1.19.4.0",window.OO=b;var d=document.createEvent("Event");d.initEvent("pulseready",!0,!0),document.dispatchEvent(d)}(window);