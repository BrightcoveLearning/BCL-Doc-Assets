<article class="bcls-article">
    <section class="bcls-section">
        <h2 id="Install_insomnia">Install Insomnia</h2>

        <p>Get Insomnia from <a href="https://insomnia.rest">https://insomnia.rest</a>. Insomnia can be installed on Mac, Linux, or Windows systems.</p>

        <p>Insomnia can be used to make requests to any of Brightcove's RESTful APIs. Most of the APIs use OAuth2 for authentication, and that is what we will demonstrate in this document. However, you can also use it for the APIs that do not use OAuth, by simply setting the appropriate header.</p>
        <figure class="bcls-figure">
            <img class="bcls-image" src="https://learning-services-media.brightcove.com.s3.amazonaws.com/doc-assets/node/18462-use-insomnia-api-requests/18462-set-header.png" alt="Set Header in Insomnia">
            <figcaption class="bcls-caption--image">Set Header in Insomnia</figcaption>
        </figure>
        <p>Here is what that header will look like for non-OAuth API requests:</p>
        <dl>
            <dt><a href="/node/18376">OAuth API</a> (create credentials request <strong>only</strong>)</dt>
            <dd>
<pre><code class="language-http">Authorization: BC_TOKEN <span class="bcls-input">YOUR_BC_TOKEN</span></code></pre>
            </dd>
            <dt><a href="/node/18380">Playback API</a></dt>
            <dd>
<pre><code class="language-http">BCOV-Policy: <span class="bcls-input">YOUR_POLICY_KEY</span></code></pre>
            </dd>
            <dt><a href="/node/18369">Live API</a></dt>
            <dd>
<pre><code class="language-http">X-API-KEY: <span class="bcls-input">YOUR_API_KEY</span></code></pre>
            </dd>
            <dt><a href="/node/18331">Zencoder API</a></dt>
            <dd>
<pre><code class="language-http">Zencoder-Api-Key: <span class="bcls-input">YOUR_API_KEY</span></code></pre>
            </dd>
            <dt><a href="/node/18437">Once APIs</a></dt>
            <dd>
<pre><code class="language-http">X-BC-ONCE-API-KEY: <span class="bcls-input">YOUR_API_KEY</span></code></pre>
            </dd>
        </dl>
    </section>

    <section class="bcls-section">
        <h2 id="getCredentials">Get client credentials</h2>

        <p>To work with most of the Brightcove APIs, you will need client credentials for the account and API(s) you wish to use. Get you client credentials in Studio by following the directions in <a href="/node/14056">Managing API Authentication Credentials</a>. In the steps below, we will be making Player Management API requests using Insomnia, so your credentials should have at least the following permissions:</p>

        <ul>
            <li><strong>Players</strong>: <strong>Read/Write</strong></li>
        </ul>

        <p>You can add as many additional permissions as you like to get credentials that will be usable for a wider range of API requests. Also note that you get credentials that will work for multiple accounts if you like.</p>

        <aside class="bcls-aside bcls-aside--information">In order to generate client credentials you must have Admin permissions for Studio, or get someone in your organization who has Admin permissions to generate the credentials for you.</aside>
    </section>

    <section class="bcls-section">
        <h2 id="usingInsomnia">Using Insomnia</h2>

        <p>Once you have your client credentials, you are ready to start using Insomnia. The steps below will walk you through making some <strong>Player Management API</strong> requests using Insomnia.</p>

        <h3>Setting up an Insomnia workspace</h3>
        <p>In case you work with other APIs, you may want to create a workspace just for Brightcove requests.</p>
        <ol class="bcls-tasklist">
            <li>Launch the Insomnia app.</li>
            <li>Click the dropdown beside Insomnia and select <strong>New Workspace</strong>:
                <figure class="bcls-figure"><img class="bcls-image" alt="Create Workspace" src="https://learning-services-media.brightcove.com.s3.amazonaws.com/doc-assets/node/18462-use-insomnia-api-requests/18462-new-workspace.png" />
                    <figcaption class="bcls-caption--image">Insomnia Authorization Section</figcaption>
                </figure>
            </li>
            <li>Enter the name <strong>Brightcove</strong> and click <strong>Create</strong>:
                <figure class="bcls-figure"><img class="bcls-image" alt="Name Workspace" src="https://learning-services-media.brightcove.com.s3.amazonaws.com/doc-assets/node/18462-use-insomnia-api-requests/18462-set-workspace-name.png" />
                    <figcaption class="bcls-caption--image">Authorization Type</figcaption>
                </figure>
            </li>
            <li>Click the <strong>plus sign</strong> and select <strong>New Folder</strong>:
                <figure class="bcls-figure">
                    <img class="bcls-image" src="https://learning-services-media.brightcove.com.s3.amazonaws.com/doc-assets/node/18462-use-insomnia-api-requests/18462-new-folder.png" alt="Create New Folder">
                    <figcaption class="bcls-caption--image">Create New Folder</figcaption>
                </figure>
            </li>
            <li>Give your folder the name <strong>Player Management API</strong></li>
        </ol>

    </section>

    <section class="bcls-section">
        <h2 id="getRequest">Send GET request</h2>

        <p>Now we are ready to make some API requests.</p>

        <h3>Make a GET request</h3>

        <ol class="bcls-tasklist">
            <li>Click the dropdown menu icon on your new folder, and select <strong>New Request</strong>:
                <figure class="bcls-figure">
                    <img class="bcls-image" src="https://learning-services-media.brightcove.com.s3.amazonaws.com/doc-assets/node/18462-use-insomnia-api-requests/18462-new-request.png" alt="New Request">
                    <figcaption class="bcls-caption--image">New Request</figcaption>
                </figure>
            </li>
            <li>Now enter the following URL into the <strong>Enter request URL</strong> field, substituting your account id for {account_id}:

                <pre class="line-numbers">
<code class="language-http">https://players.api.brightcove.com/v1/accounts/{account_id}/players
</code>
</pre>
            </li>
            <li>Leave the method as GET, and click <strong>Send</strong>:
                <figure class="bcls-figure"><img class="bcls-image" alt="GET Request" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-get-request-pm.png" />
                    <figcaption class="bcls-caption--image">GET Request</figcaption>
                </figure>
            </li>
            <li>The response should look something like this:
                <figure class="bcls-figure"><img class="bcls-image" alt="GET Response" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-get-response-pm.png" />
                    <figcaption class="bcls-caption--image">GET Response</figcaption>
                </figure>

                <aside class="bcls-aside bcls-aside--information">If you get an Unauthorized error, remember that you may need to get a new access token.</aside>
            </li>
        </ol>
    </section>

    <section class="bcls-section">
        <h2 id="postRequest">Send POST request</h2>

        <p>Now we will send a POST request with some data. In this case we will create a new video object using the Player Management API.</p>

        <h3>Make a POST request</h3>

        <ol class="bcls-tasklist">
            <li>Use the same URL as you did for the GET request steps above, but now choose <strong>POST</strong> to be the selected HTTP method.

                <figure class="bcls-figure"><img class="bcls-image" alt="POST Request" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-post-request-pm.png" />
                    <figcaption class="bcls-caption--image">POST Request</figcaption>
                </figure>
            </li>
            <li>Click the <strong>Headers</strong> button:
                <figure class="bcls-figure"><img class="bcls-image" alt="Headers Section" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-headers-section.png" />
                    <figcaption class="bcls-caption--image">Headers Section</figcaption>
                </figure>
            </li>
            <li>Click on "key" to enter a new <strong>key - value</strong> pair <strong>Content-Type - application/json</strong>. Simply begin typing in the input areas and you will be supplied with options from which you can choose the indicated values.
                <figure class="bcls-figure"><img class="bcls-image" alt="Add Header" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-post-add-header.png" />
                    <figcaption class="bcls-caption--image">Add Header</figcaption>
                </figure>
            </li>
            <li>Click the <strong>Body</strong> section just under the URL, then the <strong>raw</strong> radio button:
                <figure class="bcls-figure"><img class="bcls-image" alt="Request Body" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-post-request-body-select.png" />
                    <figcaption class="bcls-caption--image">Request Body</figcaption>
                </figure>
            </li>
            <li>For the raw data, enter the following JSON code for the body (the screenshot following the JSON shows how the request should appear):
                <pre class="line-numbers player-only">
<code class="language-json">{
"name": "MySamplePlayer",
"configuration": {
"media": {
"sources": [{
"src":"http://solutions.brightcove.com/bcls/assets/videos/Tiger.mp4",
"type":"video/mp4"
}]
}
}
}
</code>
</pre>

                <pre class="line-numbers video-cloud-only">
<code class="language-json">{
"name": "MySamplePlayer",
"configuration": {}
}
}
</code>
</pre>

                <figure class="bcls-figure player-only"><img class="bcls-image" alt="Request Body" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-post-request-body-pm.png" />
                    <figcaption class="bcls-caption--image">Request Body</figcaption>
                </figure>

                <figure class="bcls-figure video-cloud-only"><img class="bcls-image" alt="Request Body" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-post-request-body-vc.png" />
                    <figcaption class="bcls-caption--image">Request Body</figcaption>
                </figure>
            </li>
            <li>Click <strong>Send</strong>.
                <aside class="bcls-aside bcls-aside--information">If you have recently submitted a request you may not be asked to authenticate again. If you get an Unauthorized error, request a new access token and click Send again.</aside>
            </li>
            <li>
                <p>Your response will look similar to the following (You can click the <strong>Pretty</strong> button for more nicely formatted JSON):</p>

                <figure class="bcls-figure"><img class="bcls-image" alt="POST Response" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-post-response-pm.png" />
                    <figcaption class="bcls-caption--image">POST Response</figcaption>
                </figure>
            </li>
            <li>You can verify that your player was created by checking in the Players section of Studio.</li>
        </ol>
    </section>

    <section class="bcls-section">
        <h2 id="environmentVariables">Environment variables</h2>

        <p>Although you can create client credentials for multiple accounts and any combination of API operations, you may wish to maintain greater security by limiting the scope of your credentials to a single account and API (or even specific API operations).
            If so, you can take advantage of Insomnia's <strong>environment variables</strong> to simplify testing requests across multiple accounts and APIs. The key is to set up environments corresponding to each set of client credentials that you use.</p>

        <p>Below are the steps for creating and using environment variables for the <code>client_id </code> and <code>client_secret </code>.</p>

        <ol class="bcls-tasklist">
            <li>Click the gear menu in the top-right Insomnia and select <strong>Manage Environments.</strong>

                <figure class="bcls-figure"><img class="bcls-image" alt="Environments Menu" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-environments-menu.png" />
                    <figcaption class="bcls-caption--image">Environments Menu</figcaption>
                </figure>
            </li>
            <li>In the <strong>Manage Environments</strong> dialog, click <strong>Add</strong>.
                <figure class="bcls-figure"><img class="bcls-image" alt="Add Environment" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-add-environment.png" />
                    <figcaption class="bcls-caption--image">Add Environment</figcaption>
                </figure>
            </li>
            <li>For the new environment, enter:
                <ul>
                    <li>A name (whatever you like)</li>
                    <li>An environment variable called <code>client_id </code> with a value of your client id</li>
                    <li>An environment variable called <code>client_secret </code> with a value of your client secret</li>
                </ul>

                <figure class="bcls-figure"><img class="bcls-image" alt="Add Environment Variables" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-add-environment-variables.png" />
                    <figcaption class="bcls-caption--image">Add Environment Variables</figcaption>
                </figure>
            </li>
            <li>Click <strong>Add</strong> to add the environment</li>
            <li>Optionally, if you use Insomnia on multiple systems, you can share the environment and be able to access it on your other systems if you upgrade to Insomnia Pro. To do this, click the <strong>Share</strong> button in the environment listing.
                <figure class="bcls-figure"><img class="bcls-image" alt="Share an Environment" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-share-environment.png" />
                    <figcaption class="bcls-caption--image">Share an Environment</figcaption>
                </figure>
            </li>
            <li>If you do share, in the <strong>Environment Templates</strong> dialog, click <strong>Share</strong> to share the environment.
                <figure class="bcls-figure"><img class="bcls-image" alt="Add Environment to Shared Environments" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-share-environment2.png" />
                    <figcaption class="bcls-caption--image">Add Environment to Shared Environments</figcaption>
                </figure>
            </li>
            <li>Add more environments for additional client credentials</li>
            <li>Close the <strong>Manage Environments</strong> dialog to return to Insomnia and select one of your environments from the menu.
                <figure class="bcls-figure"><img class="bcls-image" alt="Select an Enviroment" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-environments-menu2.png" />
                    <figcaption class="bcls-caption--image">Select an Environment</figcaption>
                </figure>
            </li>
            <li>Now click <strong>Get New Access Token</strong> again, but change the hard-coded values for Client ID and Client Secret to point to the environment variables <code>{{client_id}} </code> and <code>{{client_secret}} </code>
                <figure class="bcls-figure"><img class="bcls-image" alt="Use Environment Variables" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/general-information/Insomnia/Insomnia-use-environment-variables.png" />
                    <figcaption class="bcls-caption--image">Use Environment Variables</figcaption>
                </figure>
            </li>
            <li>Insomnia will remember these values, so when you change to a different environment for another API or account, you will be able to get access tokens without changing the client id and client secret values.</li>
        </ol>
    </section>
</article>
