<article class="bcls-article">
    <section id="Overview" class="bcls-section">
        <h2>Overview</h2>
        <p>The Job Status API allows you to query the Once system and get back information about the status of a job in JSON format. The status request is defined by query string parameters, and you can obtain the status for any step of a job. The status returned will be:</p>
        <ul>
            <li>PENDING</li>
            <li>PROCESSING</li>
            <li>ERROR</li>
            <li>WARN</li>
            <li>COMPLETE</li>
        </ul>
    </section>
<section class="bcls-section" id="baseURL">
<h2>Base URL</h2>

<p>The base URL for the Job Status API is:</p>

<p><code>http://statusapi.unicornmedia.com</code></p>
</section>

<div class="bcls-section" id="authentication">
<h2>Authentication</h2>

<p>Login Credentials are passed via an apikey constructed by base64 encoding the login credentials.</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<td>Header</td>
			<td>Value</td>
		</tr>
		<tr>
			<td>X-BC-ONCE-API-KEY</td>
			<td>Apikey is made up of the login credentials seperated by a colon and base64 encoded.
			<p>Plain text format: user@email.com:password:domain</p>

			<p>Base64 Encoded: dXNlckBlbWFpbC5jb206cGFzc3dvcmQ6ZG9tYWluTmFtZQ==</p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<div class="bcls-section" id="syntax">
<h2>Syntax</h2>

<h3>Summary of available operations:</h3>

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th>HTTP Method</th>
			<th>Syntax</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td>GET</td>
			<td><code>api/Status/Job?mediaItemGUID={mediaItemGUID}</code></td>
			<td>Returns the Job details of a specified media item.</td>
		</tr>
		<tr>
			<td>GET</td>
			<td><code>api/Status/Job?catalogGUID={catalogGUID}&amp;foreignKey={foreignKey}</code></td>
			<td>Returns the Job details of a specified media item.</td>
		</tr>
		<tr>
			<td>GET</td>
			<td><code>api/Status/Job?itemCount={itemCount}&amp;pageNumber={pageNumber}</code></td>
			<td>Returns a list of summarized job details for the domain specified in the login credentials.</td>
		</tr>
		<tr>
			<td>GET</td>
			<td><code>api/Status/Job?catalogGUID={catalogGUID}&amp;itemCount={itemCount}&amp;pageNumber={pageNumber}</code></td>
			<td>Returns a list of summarized job details for a given catalog.</td>
		</tr>
	</tbody>
</table>

<h3>Summary of query string parameters</h3>

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th>Argument</th>
			<th>Type</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td><code><a href="#qMediaItemGuid">mediaItemGUID</a></code></td>
			<td>string</td>
			<td>Unique Identifier for a media item with in the Once system</td>
		</tr>
		<tr>
			<td><code><a href="#qcatalogGuid">catalogGUID</a></code></td>
			<td>string</td>
			<td>Unique Identifier for a catalog with in the Once system</td>
		</tr>
		<tr>
			<td><code><a href="#qForeignKey">foreignKey</a></code></td>
			<td>string</td>
			<td>Unique Identifier for a media item that was provided by the customer.</td>
		</tr>
		<tr>
			<td><code>itemCount</code></td>
			<td>int</td>
			<td>Number of items that are returned in the request. Maximum value is 50 and the default is 10.</td>
		</tr>
		<tr>
			<td><code>pageNumber</code></td>
			<td>int</td>
			<td>page number of the items defined by item count. If item count is 10 and page number is 3, the result will be items 30 to 39 of media items by update date newest to oldest.</td>
		</tr>
	</tbody>
</table>
</div>

<div class="bcls-section" id="queryTypes">
<h2>Query types</h2>

<h3 id="qMediaItemGuid">Query by MediaItemGuid</h3>

<p>Allow the user to query a specific domain by the mediaitemguid. The mediaitemguid should be anything from:</p>

<ul>
	<li>Caption</li>
	<li>Thumbnail</li>
	<li>Mediaitem</li>
	<li>MMI</li>
</ul>

<h3 id="qForeignKey">Query by ForeignKey</h3>

<p>Allows the user to query a specific domain by the foreignkey. If duplicate foreign keys are returned both should be returned in the status. These foreignkeys can be everything from:</p>

<ul>
	<li>Caption</li>
	<li>Thumbnail</li>
	<li>Mediaitem</li>
	<li>MMI</li>
</ul>

<p>The response will include (up to) the 100 most recent assets, and <code>previousPage</code> url to get the previous 100 (and so forth). The earliest set of assets will include the <code>request_id</code>.</p>

<h3 id="qCatalogGuid">Query by CatalogGuid</h3>

<p>Allows the user to query a specific domain by a catalog guid to return a collection of summarized outputs of media items created in order of newest to oldest. The user can define an item count and a page number to return media item results that is less than the default item count as defined in the application config (Currently set to 50 as the max number of items).</p>

<p>The response will include (up to) the 100 most recent assets, and <code>previousPage</code> url to get the previous 100 (and so forth). The earliest set of assets will include the <code>request_id</code>.</p>

<h3 id="qDomain">Query by Domain</h3>

<p>Allows the user to query all items within a domain&nbsp;to return a collection of summarized outputs of media items created in order of newest to default item count as defined in the application config&nbsp;(Currently set to 50 as the max number of items).</p>
</div>

<div class="bcls-section" id="responseData">
<h2>Response data</h2>

<ul>
	<li><a href="#mediaItemData">Media Item Data</a></li>
	<li><a href="#metaMediaItemData">Meta Media Item Data</a></li>
	<li><a href="#captionsMediaItemData">Captions Media Item Data</a></li>
	<li><a href="#imageMediaItemData">Image Media Item Data</a></li>
</ul>

<h3 id="mediaItemData">Media Item Data</h3>

<ul>
	<li>Foreignkey</li>
	<li>Title</li>
	<li>CatalogGuid</li>
	<li>CreateDate (epoch time in seconds)</li>
	<li>UpdateDate (epoch time in seconds)</li>
	<li>Source URL</li>
	<li>Source FPS</li>
	<li>Status (overall)
	<ul>
		<li>PENDING
		<ul>
			<li>No jobs have been created to start work</li>
		</ul>
		</li>
		<li>PROCESSING
		<ul>
			<li>1 or more jobs have begun processing</li>
		</ul>
		</li>
		<li>ERROR
		<ul>
			<li>A job has failed</li>
		</ul>
		</li>
		<li>WARN
		<ul>
			<li>A job failed and the video is playable, but there was a problem processing an asset (usually timed text)</li>
		</ul>
		</li>
		<li>COMPLETE
		<ul>
			<li>Content is ready to deliver</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>jobDetails
	<ul>
		<li>Asset Ingest
		<ul>
			<li>startTime (epoch time in seconds)</li>
			<li>completeTime (epoch time in seconds)</li>
			<li>Status</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>
	<p>AvFileDownload</p>

	<ul>
		<li>startTime (epoch time in seconds)</li>
		<li>completeTime (epoch time in seconds)</li>
		<li>Status:</li>
	</ul>
	</li>
	<li>Collection Caption Creation
	<ul>
		<li>Per Caption
		<ul>
			<li>Language</li>
			<li>Start Time (epoch time in seconds)</li>
			<li>CompleteTime (epoch time in seconds)</li>
			<li>Source Url</li>
			<li>Status</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Transcoding/External Transcoding
	<ul>
		<li>Per Profile:
		<ul>
			<li>profile name / guid</li>
			<li>startTime (epoch time in seconds)</li>
			<li>completeTime (epoch time in seconds)</li>
			<li>Status</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Collection &nbsp;File Replication
	<ul>
		<li>Per profile
		<ul>
			<li>Profile name /guid</li>
			<li>startTime (epoch time in seconds)</li>
			<li>completeTime (epoch time in seconds)</li>
			<li>Status</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>ItemNotification
	<ul>
		<li>startTime (epoch time in seconds)</li>
		<li>completeTime (epoch time in seconds)</li>
		<li>Notification URL</li>
		<li>Status</li>
	</ul>
	</li>
</ul>

<h3 id="metaMediaItemData">Meta Media Item Data</h3>

<ul>
	<li>Foreignkey</li>
	<li>Title</li>
	<li>Catalog</li>
	<li>CreateDate (epoch time in seconds)</li>
	<li>UpdateDate (epoch time in seconds)</li>
	<li>Status:
	<ul>
		<li>PENDING
		<ul>
			<li>Request sitting in a queue OR</li>
			<li>1 or more segments are in a PENDING state</li>
		</ul>
		</li>
		<li>PROCESSING
		<ul>
			<li>1 or more segments are in a PROCESSING state</li>
		</ul>
		</li>
		<li>ERROR
		<ul>
			<li>If any segments error out the MMI should error as well</li>
			<li>If framerates do not match with all segments we should return an error state</li>
		</ul>
		</li>
		<li>COMPLETE
		<ul>
			<li>MMI is ready to deliver</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Notification
	<ul>
		<li>Metadata:
		<ul>
			<li>startTime (epoch time in seconds)</li>
			<li>completeTime (epoch time in seconds)</li>
			<li>Notification URL</li>
		</ul>
		</li>
		<li>Status
		<ul>
			<li>ERROR</li>
			<li>COMPLETE</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>The overall status of each segment
	<ul>
		<li>Metadata
		<ul>
			<li>FPS</li>
			<li>startTime (epoch time in seconds)</li>
			<li>completeTime (epoch time in seconds)</li>
		</ul>
		</li>
		<li>Status
		<ul>
			<li>PENDING</li>
			<li>PROCESSING</li>
			<li>ERROR</li>
			<li>COMPLETE</li>
		</ul>
		</li>
	</ul>
	</li>
</ul>

<h3 id="captionsMediaItemData">Captions Media Item Data</h3>

<ul>
	<li>Language Code</li>
	<li>Metadata</li>
	<li>Foreignkey</li>
	<li>Title</li>
	<li>Source URL</li>
	<li>CreateDate (epoch time in seconds)</li>
	<li>UpdateDate (epoch time in seconds)</li>
	<li>Status
	<ul>
		<li>PENDING</li>
		<li>PROCESSING</li>
		<li>ERROR</li>
		<li>COMPLETE</li>
	</ul>
	</li>
</ul>

<h3 id="imageMediaItemData">Image Media Item Data</h3>

<ul>
	<li>Foreignkey</li>
	<li>Source URL</li>
	<li>CreateDate (epoch time in seconds)</li>
	<li>UpdateDate (epoch time in seconds)</li>
	<li>Status
	<ul>
		<li>PENDING</li>
		<li>PROCESSING</li>
		<li>ERROR</li>
		<li>COMPLETE</li>
	</ul>
	</li>
</ul>
</div>

<div class="bcls-section" id="rateLimiting">
<h2>Rate limiting</h2>

<p>The API will check will check for excessive requests. If the limit is exceeded the api will return no content with a status code of 429 (too many request) along with the limit, request remaining, and the time when the limit will reset in the response header. If content is returned the request made value associated with the domain guid will be incremented.</p>

<p>Values returned in the response header.</p>

<table class="bcls-table">
	<tbody class="bcls-table__body">
		<tr>
			<td>Header</td>
			<td>Value</td>
		</tr>
		<tr>
			<td>X-Rate-Remaining</td>
			<td>The number of requests left for the time window defined in the application config</td>
		</tr>
		<tr>
			<td>X-Retry-After&nbsp;</td>
			<td>The remaining window before the rate limit resets in seconds</td>
		</tr>
	</tbody>
</table>
</div>
</article>
