<article class="bcls-article">
  <section class="bcls-section">
    <h2 id="Introduction">Introduction</h2>
    <p>Getting client credentials is a one-time prerequisite for getting access tokens, which the majority of Brightcove APIs use ato authenticate requests.</p>
    <p>For a full explanation of client credentials, see <a href="/node/17928">how the Brightcove OAuth service works</a>.</p>
    <p>This sample shows you how to get client credentials from a web app. Because the OAuth API is not CORS-enabled and requests must be made from the server side, the app sends necessary information to a proxy, which then makes the api request and sends the response back to the client. The proxy here is written in PHP, but any server-side language will do - you just need to be able to send a POST request to the app over the internet.</p>
  </section>
  <section class="bcls-section">
<h2 id="gettingCredentials" class="bcls-expander-head">Getting your BC_TOKEN</h2>

<div class="bcls-expander-content">
<p>To get a <code>client_id</code> and <code>client_secret</code> via the OAuth API, you will need a <code>BC_TOKEN</code> to authenticate your request. Your BC_TOKEN is set as a cookie when you login to Studio. You can get that cookie any way you like, but to make it easier, we have created the following JavaScript snippet - you can paste it into the developer console when you are logged into Studio, press <strong>return</strong>, and a prompt will appear containing the BC_TOKEN:</p>
<textarea class="bcls-code">var cookiesArray = document.cookie.split(";"), cookiesObj = {}, i, tmpArray = [];
for (i = 0; i < cookiesArray.length; i++) {
    tmpArray = cookiesArray[i].split("=");
    if (tmpArray[0].indexOf('BC_TOKEN') > -1) {
        cookiesObj.BC_TOKEN = tmpArray[1];
    }
}
window.prompt("BC_TOKEN:", cookiesObj.BC_TOKEN);</textarea>
<aside class="bcls-aside bcls-aside--information">Note that you must be an admin for your account (or get an admin's BC_TOKEN) in order to create client credentials. If you do not have an admin BC_TOKEN, the request below will return an error.</aside>
</div>
</section>
<section class="bcls-section">
  <h2 id="app">The app</h2>
  <fieldset>
    <legend>Inputs</legend>
    <p>Name for the credentials (no special characters): <input id="credentialsName" type="text" size="50"></p>
    <p>BC_TOKEN: <input id="bcToken" type="text" size="50"></p>
    <p>Account(s) to create credentials for (comma-delimited list): <input id="accountIds" type="text" size="50" placeholder="57838016001,1752604059001,921483702001"></p>
    <p>Account(s) type: <select name="accountTypeSelector" id="accountTypeSelector">
      <option value="video-cloud-account">Video Cloud</option>
      <option value="video-cloud-account">Brightcove Player</option>
    </select></p>
    <p>API operations to enable (see <a href="/node/17922">API Operations for Client Credentials</a> for more information):</p>
    <div id="operationsList">

    </div>
    <p><button id="submitButton" class="bcls-button">Get Client Credentials</button></p>
    <p>Full API request body:</p>
    <textarea name="apiRequest" id="apiRequest" class="bcls-code"></textarea>
  </fieldset>
  <fieldset>
    <legend>Output</legend>
    <h3>Client ID</h3>
    <textarea name="clientId" id="clientId" class="bcls-code">CLient ID will appear here...</textarea>
    <h3>Client Secret</h3>
    <textarea name="clientSecret" id="clientSecret" class="bcls-code">CLient Secret will appear here...</textarea>
    <h3>Full response</h3>
  <pre class="line-numbers"><code id="apiResponse" class="language-json">Full API response will appear here...</code></pre>
  </fieldset>
</section>
<section class="bcls-section">
  <h2 id="code">Code for the app</h2>
  <h3>HTML</h3>
<pre class="line-numbers"><code class="language-html">&lt;section class="bcls-section"&gt;
  &lt;h2 id="app"&gt;The app&lt;/h2&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Inputs&lt;/legend&gt;
    &lt;p&gt;Name for the credentials (no special characters): &lt;input id="credentialsName" type="text" size="50"&gt;&lt;/p&gt;
    &lt;p&gt;BC_TOKEN: &lt;input id="bcToken" type="text" size="50"&gt;&lt;/p&gt;
    &lt;p&gt;Account(s) to create credentials for (comma-delimited list): &lt;input id="accountIds" type="text" size="50" placeholder="57838016001,1752604059001,921483702001"&gt;&lt;/p&gt;
    &lt;p&gt;Account(s) type: &lt;select name="accountTypeSelector" id="accountTypeSelector"&gt;
      &lt;option value="video-cloud-account"&gt;Video Cloud&lt;/option&gt;
      &lt;option value="video-cloud-account"&gt;Brightcove Player&lt;/option&gt;
    &lt;/select&gt;&lt;/p&gt;
    &lt;p&gt;API operations to enable:&lt;/p&gt;
    &lt;div id="operationsList"&gt;

    &lt;/div&gt;
    &lt;p&gt;&lt;button id="submitButton" class="bcls-button"&gt;Get Client Credentials&lt;/button&gt;&lt;/p&gt;
    &lt;p&gt;Full API request body:&lt;/p&gt;
    &lt;textarea name="apiRequest" id="apiRequest" class="bcls-code"&gt;&lt;/textarea&gt;
  &lt;/fieldset&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Output&lt;/legend&gt;
    &lt;h3&gt;Client ID&lt;/h3&gt;
    &lt;textarea name="clientId" id="clientId" class="bcls-code"&gt;CLient ID will appear here...&lt;/textarea&gt;
    &lt;h3&gt;Client Secret&lt;/h3&gt;
    &lt;textarea name="clientSecret" id="clientSecret" class="bcls-code"&gt;CLient Secret will appear here...&lt;/textarea&gt;
    &lt;h3&gt;Full response&lt;/h3&gt;
  &lt;pre class="line-numbers"&gt;&lt;code id="apiResponse" class="language-json"&gt;Full API response will appear here...&lt;/code&gt;&lt;/pre&gt;
  &lt;/fieldset&gt;
&lt;/section&gt;
</code></pre>
  <h3>JavaScript</h3>
<pre class="line-numbers"><code class="language-javascript">var BCLS = ( function (window, document) {
  var bcToken   = document.getElementById('bcToken'),
    credentialsName = document.getElementById('credentialsName'),
    accountIds = document.getElementById('accountIds'),
    operationsList = document.getElementById('operationsList'),
    submitButton = document.getElementById('submitButton'),
    apiRequest = document.getElementById('apiRequest'),
    clientId  = document.getElementById('clientId'),
    clientSecret = document.getElementById('clientSecret'),
    apiResponse  = document.getElementById('apiResponse'),
    defaultName = 'Credentials from Learning Services App',
    options      = {},
    requestBody = {},
    accountsStr,
    accounts = [],
    operations = ['video-cloud/analytics/read', 'video-cloud/audience/read', 'video-cloud/audience/write', 'video-cloud/player/read', 'video-cloud/player/all', 'video-cloud/ingest-profiles/profile/read', 'video-cloud/ingest-profiles/profile/write', 'video-cloud/ingest-profiles/account/read', 'video-cloud/ingest-profiles/account/write', 'video-cloud/upload-urls/read',  'video-cloud/video/all', 'video-cloud/video/read', 'video-cloud/video/create', 'video-cloud/video/update', 'video-cloud/video/delete', 'video-cloud/asset/delete', 'video-cloud/playlist/all', 'video-cloud/playlist/read', 'video-cloud/playlist/create', 'video-cloud/playlist/update', 'video-cloud/playlist/delete', 'video-cloud/sharing-relationships/read', 'video-cloud/sharing-relationships/create', 'video-cloud/sharing-relationships/update', 'video-cloud/sharing-relationships/delete', 'video-cloud/sharing-relationships/all', 'video-cloud/notifications/all'],
    selectedOperations = [],
    operationsSelectAll,
    operationsCollection,
    proxyURL     = 'https://solutions.brightcove.com/bcls/bcls-proxy/client-credentials-proxy.php',
    client_id,
    client_secret,
    input,
    space,
    br,
    label,
    fragment = document.createDocumentFragment(),
    i,
    iMax;

// set initial requestBody properties
requestBody.type = 'credential';
requestBody.maximum_scope = [];

// generate operations options
input = document.createElement('input');
space = document.createTextNode(' ');
label = document.createElement('label');
input.setAttribute('name', 'operationsChkAll');
input.setAttribute('id', 'operationsChkAll');
input.setAttribute('type', 'checkbox');
input.setAttribute('value', 'all');
label.setAttribute('for', 'operationsChkAll');
label.setAttribute('style', 'color:#F3951D;');
text = document.createTextNode('Select All');
label.appendChild(text);
br = document.createElement('br');
fragment.appendChild(input);
fragment.appendChild(space);
fragment.appendChild(label);
fragment.appendChild(br);
iMax = operations.length;
for (i = 0; i &lt; iMax; i++) {
  input = document.createElement('input');
  space = document.createTextNode(' ');
  label = document.createElement('label');
  input.setAttribute('name', 'operationsChk');
  input.setAttribute('id', operations[i]);
  input.setAttribute('type', 'checkbox');
  input.setAttribute('value', operations[i]);
  label.setAttribute('for', operations[i]);
  text = document.createTextNode(operations[i]);
  label.appendChild(text);
  br = document.createElement('br');
  fragment.appendChild(input);
  fragment.appendChild(space);
  fragment.appendChild(label);
  fragment.appendChild(br);
}
operationsList.appendChild(fragment);
// get references to checkboxes
operationsCollection = document.getElementsByName('operationsChk');
operationsSelectAll = document.getElementById('operationsChkAll');
// add event listener for select allows
operationsSelectAll.addEventListener('change', function() {
  if (this.checked) {
    selectAllCheckboxes(operationsCollection);
  } else {
    deselectAllCheckboxes(operationsCollection);
  }
});


// event handlers
submitButton.addEventListener('click', function() {
  var responseParsed;
  if (isDefined(bcToken.value) &amp;&amp; isDefined(accountIds.value)) {
    requestBody.name = (isDefined(credentialsName.value)) ? credentialsName.value : defaultName;
    selectedOperations = getCheckedBoxValues(operationsCollection);
    if (selectedOperations.length === 0) {
      alert('You must select at least one API operation to enable');
      return;
    }
    accountsStr      = removeSpaces(accountIds.value);
    accounts         = accountsStr.split(',');
    if (accounts.length === 0) {
      alert('You must enter at least one account id');
      return;
    } else {
      iMax = accounts.length;
      for (i = 0; i &lt; iMax; i++) {
        var
          maximum_scope_template = {};
          maximum_scope_template.identity = {};
          maximum_scope_template.identity.type = getSelectedValue(accountTypeSelector).value;
          maximum_scope_template.identity['account-id'] = parseInt(accounts[i], 10);
          maximum_scope_template.operations = selectedOperations;
          requestBody.maximum_scope.push(maximum_scope_template);
      }
    }
    options.url = 'https://oauth.brightcove.com/v4/client_credentials';
    options.requestType = "POST";
    options.requestBody = JSON.stringify(requestBody);
    apiRequest.textContent = JSON.stringify(requestBody, null, '  ');
    options.bc_token = bcToken.value;
    makeRequest(options, function(response) {
      if (isJson(response)) {
        responseParsed          = JSON.parse(response);
        client_id               = responseParsed.client_id;
        client_secret           = responseParsed.client_secret;
        apiResponse.textContent = JSON.stringify(responseParsed, null, '  ');
        clientId.textContent = client_id;
        clientSecret.textContent = client_secret;
      } else {
        // didn't get JSON back, just dump responseRaw
        apiResponse.textContent = response;
      }
    });
  } else {
    alert('A BC_TOKEN and at least one account id are required.');
  }
});

clientId.addEventListener('click', function() {
  this.select();
});

clientSecret.addEventListener('click', function() {
  this.select();
});

/**
 * tests for all the ways a variable might be undefined or not have a value
 * @param {*} x the variable to test
 * @return {Boolean} true if variable is defined and has a value
 */
function isDefined(x) {
    if ( x === '' || x === null || x === undefined) {
        return false;
    }
    return true;
}

/*
 * tests to see if a string is json
 * @param {String} str string to test
 * @return {Boolean}
 */
function isJson(str) {
    try {
        JSON.parse(str);
    } catch (e) {
        return false;
    }
    return true;
}

/**
 * remove spaces from a string
 * @param {String} str string to process
 * @return {String} trimmed string
 */
function removeSpaces(str) {
    str= str.replace(/\s/g, '');
    return str;
}

/**
 * get array of values for checked boxes in a collection
 * @param {htmlElementCollection} checkBoxCollection collection of checkbox elements
 * @return {Array} array of the values of the checked boxes
 */
function getCheckedBoxValues(checkBoxCollection) {
  var checkedValues = [],
    i,
    iMax;
  if (checkBoxCollection) {
    iMax = checkBoxCollection.length;
    for (i = 0; i &lt; iMax; i++) {
      if (checkBoxCollection[i].checked === true) {
        checkedValues.push(checkBoxCollection[i].value);
      }
    }
    return checkedValues;
  } else {
    console.log('Error: no input received');
    return null;
  }
}

/**
 * selects all checkboxes in a collection
 * @param {htmlElementCollection} checkboxCollection a collection of the checkbox elements, usually gotten by document.getElementsByName()
 */
function selectAllCheckboxes(checkboxCollection) {
  var i,
    iMax = checkboxCollection.length;
  for (i = 0; i &lt; iMax; i += 1) {
    checkboxCollection[i].setAttribute('checked', 'checked');
  }
}

/**
 * deselects all checkboxes in a collection
 * @param {htmlElementCollection} checkboxCollection a collection of the checkbox elements, usually gotten by document.getElementsByName()
 */
function deselectAllCheckboxes(checkboxCollection) {
  var i,
    iMax = checkboxCollection.length;
  for (i = 0; i &lt; iMax; i += 1) {
    checkboxCollection[i].removeAttribute('checked');
  }
}

/**
 * get selected value for single select element
 * @param {htmlElement} e the select element
 * @return {Object} object containing the `value`, text, and selected `index`
 */
function getSelectedValue(e) {
    var selected = e.options[e.selectedIndex],
        val = selected.value,
        txt = selected.textContent,
        idx = e.selectedIndex;
    return {
        value: val,
        text: txt,
        index: idx
    };
}

/**
 * send API request to the proxy
 * @param  {Object} options options for the request
 * @param  {String} requestID the type of request = id of the button
 * @param  {Function} [callback] callback function
 */
function makeRequest(options, callback) {
  var httpRequest = new XMLHttpRequest(),
    responseRaw,
    requestParams,
    // response handler
    getResponse = function() {
      try {
        if (httpRequest.readyState === 4) {
          if (httpRequest.status &gt;= 200 &amp;&amp; httpRequest.status &lt; 300) {
            // check for completion
            responseRaw = httpRequest.responseText;
            callback(responseRaw);
          }
        }
      } catch (e) {
        alert('Caught Exception: ' + e);
      }
    };
  // set up request data
  requestParams = 'url=' + encodeURIComponent(options.url) + '&amp;bc_token=' + options.bc_token + '&amp;requestType=' + options.requestType + '&amp;requestBody=' + options.requestBody;
  // set response handler
  httpRequest.onreadystatechange = getResponse;
  // open the request
  httpRequest.open('POST', proxyURL);
  // set headers
  httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
  // open and send request
  httpRequest.send(requestParams);
}

})(window, document);
</code></pre>
  <h3>Proxy (PHP)</h3>
<pre class="line-numbers"><code class="language-php">&lt;?php
/**
 * client-credentials-proxy.php - proxy for Brightcove RESTful APIs
 * gets a client id and client secret and returns the whole response
 * Accessing:
 *         (note you should *always* access the proxy via HTTPS)
 *     Method: POST
 *
 * @post {string} bc_token - BC_TOKEN with admin permissions on all accounts that credentials are requested for
 * @post {JSONstring} requestBody - the full request body as a JSON string
 *
 * @returns {string} $response - JSON response received from the OAuth API
 */

// security checks
if (strpos($_SERVER['HTTP_REFERER'], 'solutions.brightcove.com') == false &amp;&amp; strpos($_SERVER['HTTP_REFERER'], 'ondemand.brightcovelearning.com') == false &amp;&amp; strpos($_SERVER['HTTP_REFERER'], 'video.brightcovelearning.com') == false &amp;&amp; strpos($_SERVER['HTTP_REFERER'], 's.codepen.io') == false &amp;&amp; strpos($_SERVER['HTTP_REFERER'], 'fiddle.jshell.net') == false &amp;&amp; strpos($_SERVER['HTTP_REFERER'], 'players.brightcove.net') == false &amp;&amp; strpos($_SERVER['HTTP_REFERER'], 'support.brightcove.com') == false &amp;&amp; strpos($_SERVER['HTTP_REFERER'], 'master-7rqtwti-6sglloa4yrkti.us.platform.sh') == false) {
    exit('{"ERROR":"Only requests from http://docs.brightcove.com or http:solutions.brightcove.com are accepted by this proxy"}');
}

// CORS enablement and other headers
header("Access-Control-Allow-Origin: *");
header("Content-type: application/json");
header("X-Content-Type-Options: nosniff");
header("X-XSS-Protection");

// get data or die
if ($_POST["requestBody"]) {
    $data = json_decode($_POST["requestBody"]);
} else {
  exit("request body missing");
}
// get request type or default to POST
if ($_POST["requestType"]) {
    $method = $_POST["requestType"];
} else {
  $method = 'POST';
}
// get bc_token or die
if ($_POST["bc_token"]) {
    $bc_token = $_POST["bc_token"];
} else {
  exit("bc_token missing");
}

$request  = "https://oauth.brightcove.com/v4/client_credentials";
$ch       = curl_init($request);
curl_setopt_array($ch, array(
    CURLOPT_CUSTOMREQUEST  =&gt; $method,
    CURLOPT_RETURNTRANSFER =&gt; TRUE,
    CURLOPT_SSL_VERIFYPEER =&gt; FALSE,
    CURLOPT_HTTPHEADER     =&gt; array(
        'Content-type: application/json',
        "Authorization: BC_TOKEN {$bc_token}"
    ),
    CURLOPT_POSTFIELDS =&gt; json_encode($data)
));
$response = curl_exec($ch);
curl_close($ch);

// Check for errors
if ($response === FALSE) {
    die(curl_error($ch));
    exit('An error occurred on making the request');
} else {
  echo $response;
}

?&gt;
</code></pre>
</section>
</article>
<script src="//learning-services-media.brightcove.com/doc-assets/node/18521-oauth-api-sample-create-client-credentials/get-credentials.js"></script>
