<article class="bcls-article">
<section class="bcls-section">
<h2 id="Overview">Overview</h2>

<p>Definitions for clips are created using the <code>/vods</code> endpoint.</p>

<p>Clips can be created in four ways:</p>

<ul>
	<li>With <code>start_time</code> and/or <code>end_time</code> defined relative to the start time (<code>stream_start_time</code>) of the whole live stream event</li>
	<li>With <code>start_time</code> and/or <code>end_time</code> defined in Epoch (Unix) time (in seconds)</li>
	<li>With duration and either a <code>start_time</code> or <code>end_time</code></li>
	<li>With duration and no start or end time, in which case the clip is taken from the end of the stream</li>
	<li>
	<aside class="bcls-aside bcls-aside--warning">The clipping API <strong>cannot</strong> be used with <strong>encrypted</strong> jobs.</aside>
	</li>
</ul>

<h3>Notes</h3>

<ol>
	<li>If you specify <code>duration</code> without a start or end time, the resulting clip will be as follows:

	<ul>
		<li>If the job is active and still live: (request time - duration) to (request time)</li>
		<li>If the job is finished: (finished_at - duration) to (finished_at)</li>
	</ul>
	</li>
	<li>If you specify both "start_time" AND "end_time":
	<ul>
		<li>If the job is active and still live: as long as the Epoch time window falls entirely within "created_at" and the request time, the clip will be made</li>
		<li>If the job is finished: as long as the Epoch time window falls entirely within "created_at" and "finished_at", the clip will be made</li>
	</ul>
	</li>
	<li>Clips can be created up to 24 hours after an event. For <a href="/node/18443">SEP</a>, they can be created up until the next activation or 24 hours (whichever is shorter).</li>
</ol>

<p>Clips can also be sent to multiple destinations:</p>

<ul>
	<li>A Video Cloud account</li>
	<li>An FTP server</li>
	<li>An S3 bucket</li>
</ul>

<aside class="bcls-aside bcls-aside--information">Note: clips can be created while the live stream is running. To do this, you will need to define the start and end times of the clip in Epoch time or relative to <strong>start</strong> time of the live stream.</aside>
</section>

<section class="bcls-section">
<h2 id="Endpoint">Endpoint</h2>

<p>Clips are created by sending a <code>POST</code> request to:</p>

<pre class="line-numbers">
<code class="language-http">https://api.bcovlive.io/v1/vods</code></pre>
</section>

<section class="bcls-section">
<h2 id="Request_body_video_cloud">Request body - Video Cloud</h2>
<h3>Example 1: start/end times relative to stream start</h3>
<p>The request body includes start and end times, and details about where to send the clip. Here is a sample request body that creates a clip of the third minute of a stream and sends it to a Video Cloud account:</p>

<pre class="line-numbers">
<code class="language-json">{
    "live_job_id":"<span class="bcls-input">PUT-LIVE-JOB-ID-HERE</span>",
    "outputs":[
        {
            "label": "60 secs by stream from min 2 to min 3",
            "stream_start_time": 120,
            "stream_end_time": 180,
            "credentials": "<span class="bcls-input">VC_CREDENTIALS</span>",
            "videocloud": {
                "video": {
                    "name": "One Minute Clip",
                    "tags": ["live", "clip"]
                },
                "ingest": {
                    "profile": "high-resolution",
                    "capture-images": true
                }
            }
        }
    ]
}</code></pre>

<p>In this example, we are creating a clip of one-minute duration and sending it to Video Cloud. We're giving the clip a name and a couple of tags, specifying a "high-resolution" <a href="/node/18045">ingest profile</a> for retranscoding, and instructing Video Cloud to capture thumbnail and poster images from the clip during transcoding.</p>

<h3>Example 2: start/end times in Epoch time</h3>
<p>The request body includes start and end times in Epoch time, and details about where to send the clip. Here is a sample request body that creates a clip of the third minute of a stream and sends it to a Video Cloud account:</p>

<pre class="line-numbers">
<code class="language-json">{
    "live_job_id":"<span class="bcls-input">PUT-LIVE-JOB-ID-HERE</span>",
    "outputs":[
        {
            "label": "60 secs - epoch time",
            "start_time": 1516652694,
            "end_time": 1516652754,
            "credentials": "<span class="bcls-input">VC_CREDENTIALS</span>",
            "videocloud": {
                "video": {
                    "name": "One Minute Clip",
                    "tags": ["live", "clip"]
                },
                "ingest": {
                    "profile": "high-resolution",
                    "capture-images": true
                }
            }
        }
    ]
}</code></pre>

<p>In this example, we are creating a clip of one-minute duration at a specific Epoch time (in this case 22 Jan 2018 at 08:24:54 GMT).</p>

<h3>Example 3: duration with start time relative to stream start</h3>
<p>The request body includes the duration and stream_start_time, and details about where to send the clip. Here is a sample request body that creates a clip of the third minute of a stream and sends it to a Video Cloud account:</p>

<pre class="line-numbers">
<code class="language-json">{
    "live_job_id":"<span class="bcls-input">PUT-LIVE-JOB-ID-HERE</span>",
    "outputs":[
        {
            "label": "60 secs - epoch time",
            "start_time": 300,
            "duration": 60,
            "credentials": "<span class="bcls-input">VC_CREDENTIALS</span>",
            "videocloud": {
                "video": {
                    "name": "One Minute Clip",
                    "tags": ["live", "clip"]
                },
                "ingest": {
                    "profile": "high-resolution",
                    "capture-images": true
                }
            }
        }
    ]
}</code></pre>

<p>In this example, we are creating a clip of one-minute duration starting 5 minutes after the start of the live stream.</p>

<h3>Example 4: duration with no start or end time</h3>
<p>The request body includes start and end times in Epoch time, and details about where to send the clip. Here is a sample request body that creates a clip of the third minute of a stream and sends it to a Video Cloud account:</p>

<pre class="line-numbers">
<code class="language-json">{
    "live_job_id":"<span class="bcls-input">PUT-LIVE-JOB-ID-HERE</span>",
    "outputs":[
        {
            "label": "60 secs - epoch time",
            "duration": 60,
            "credentials": "<span class="bcls-input">VC_CREDENTIALS</span>",
            "videocloud": {
                "video": {
                    "name": "One Minute Clip",
                    "tags": ["live", "clip"]
                },
                "ingest": {
                    "profile": "high-resolution",
                    "capture-images": true
                }
            }
        }
    ]
}</code></pre>

<p>In this example, we are creating a clip of one-minute duration. Since we are not specifying a start or end time, the clip will be taken from the last 60 seconds of the live stream.</p>

<h3>General information about sending clips to Video Cloud</h3>

<p>To see what fields can be included in the <code>video</code> and <code>ingest</code> objects, see the <a href="https://brightcovelearning.github.io/Brightcove-API-References/dynamic-ingest-api/v1/doc/index.html">Dynamic Ingest API Reference</a>.</p>

<aside class="bcls-aside bcls-aside--warning">Do <strong>not</strong> include the <code>master</code> field in the <code>ingest</code> object, as that information will be provided by the Live API.</aside>

<p>The <code>VC_CREDENTIALS</code> here is a reference to a set of client credentials for the Dynamic Ingest system, which are set up in your Live account by the Live team.</p>
</section>

<section class="bcls-section">
<h2 id="Request_body_s3">Request body - S3</h2>

<p>The request body includes start and end times, and details about where to send the clip. Here is a sample request body that creates a clip of the third minute of a stream and sends it to an S3 bucket:</p>

<pre class="line-numbers">
<code class="language-json">{
    "live_job_id":"{{job_id}}",
    "outputs":[
        {
            "label": "last_30",
            "duration": 30,
            "url": "s3://<span class="bcls-input">YOUR_BUCKET_NAME</span>/<span class="bcls-input">file_name.mp4</span>",
            "credentials": "<span class="bcls-input">s3-credentials</span>"
        }
    ],
    "notifications": ["<span class="bcls-input">http://myserver.com/api/notification_listener?type=jvod</span>"]
}</code></pre>

<p>In this example, we are creating a clip of 30 second duration and sending it to an S3 bucket. We provide the bucket URL including the file name for clip, and a string that is the name of saved S3 bucket credentials - the credentials can be set up for your account by Brightcove Support.</p>
</section>

<section class="bcls-section">
<h2 id="Request_body_fields">Request body fields</h2>

<p>Here is a full table of the request body fields.</p>

<table class="bcls-table">
	<caption class="bcls-caption--table">Request Body Fields</caption>
	<thead class="bcls-table__head">
		<tr>
			<th style="width: 30%">Field</th>
			<th style="width: 10%">Type</th>
			<th style="width: 70%">Description</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td class="code">live_job_id</td>
			<td>String</td>
			<td>
			<p>The id of Live Stream job to create the VOD clip from.</p>
			</td>
		</tr>
		<tr>
			<td class="code">outputs</td>
			<td>Object[]</td>
			<td>
			<p>Array of VOD outputs</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;label</td>
			<td>String</td>
			<td>
			<p>Label for the output</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;duration</td>
			<td>Number</td>
			<td>
			<p>Duration of the clip in seconds</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;stream_start_time</td>
			<td>Number</td>
			<td>
			<p>Start time in seconds for the clip relative to the start time of the live stream</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;stream_end_time</td>
			<td>Number</td>
			<td>
			<p>End time in seconds for the clip relative to the start time of the live stream</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;start_time</td>
			<td>Number</td>
			<td>
			<p>Start time for the clip in Epoch (Unix) time (seconds)</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;end_time</td>
			<td>Number</td>
			<td>
			<p>End time for the clip in Epoch (Unix) time (seconds)</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;url</td>
			<td>String</td>
			<td>
			<p>URL for the clip</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;credentials</td>
			<td>String</td>
			<td>
			<p>The name of the credentials configured in your account for this address</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;videocloud</td>
			<td>Object</td>
			<td>
			<p>An object containing inputs for Video Cloud ingestion</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;&nbsp;&nbsp;video</td>
			<td>Object</td>
			<td>
			<p>An object containing inputs for Video Cloud video object creation - see the <a href="https://brightcovelearning.github.io/Brightcove-API-References/cms-api/v1/doc/index.html#api-videoGroup-Create_Video">CMS API Reference for creating a video</a></p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;&nbsp;&nbsp;ingest</td>
			<td>Object</td>
			<td>
			<p>An object containing inputs for Video Cloud video ingestion - see the <a href="https://brightcovelearning.github.io/Brightcove-API-References/dynamic-ingest-api/v1/doc/index.html#api-Ingest-Ingest_Media_Asset">Dynamic Ingest Reference</a> - do <strong>not</strong> include the <code>master</code> field, as that information will be provided by the Live API</p>
			</td>
		</tr>
	</tbody>
</table>
</section>

<section class="bcls-section">
<h2 id="API_response">API response</h2>

<p>The response to a create clip request includes an id for the job and the label you set in the request body, as well as the live job id:</p>

<pre class="line-numbers">
<code class="language-json">{
  "vod_jobs": [
    {
      "jvod_id": "9582606c50d84be5ad4bc104f2aa3360",
      "label": "last 60 secs of live job"
    }
  ],
  "live_job_id": "88ba5d87b61a4ef3a6dddabd0c38d319"
}</code></pre>

<h3>Response fields</h3>

<table class="bcls-table">
	<caption class="bcls-caption--table">Response Body Fields</caption>
	<thead class="bcls-table__head">
		<tr>
			<th style="width: 30%">Field</th>
			<th style="width: 10%">Type</th>
			<th style="width: 70%">Description</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td class="code">vod_jobs</td>
			<td>Object</td>
			<td>
			<p>The clip response object</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;jvod_id</td>
			<td>String</td>
			<td>
			<p>The clip job id</p>
			</td>
		</tr>
		<tr>
			<td class="code">&nbsp;&nbsp;label</td>
			<td>String</td>
			<td>
			<p>The clip label (from the input)</p>
			</td>
		</tr>
		<tr>
			<td class="code">live_job_id</td>
			<td>String</td>
			<td>
			<p>The clip label (from the input)</p>
			</td>
		</tr>
	</tbody>
</table>
</section>
</article>
