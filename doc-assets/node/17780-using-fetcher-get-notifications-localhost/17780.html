<article class="bcls-article">
<section id="Overview" class="bcls-section">
<h2>Overview</h2>

<p>Zencoder posts a notification to your application when a file is finished encoding. When developing locally Zencoder may be unable to notify your application because your server is not accessible over the internet. To solve this, we recommend using the <a href="http://rubygems.org/gems/zencoder-fetcher">Zencoder Fetcher</a>.</p>

<p>Fetcher acts as an intermediary between your local application and Zencoder. It can be run once or set to loop at a given interval, gathering any notifications on Zencoder for your account and then posting them to your application.</p>
</section>

<section id="Installing_Fetcher" class="bcls-section">
<h2>Installing Fetcher</h2>

<p>First, install Ruby and RubyGems.</p>

<p>Then, install Zencoder Fetcher.</p>

<pre class="line-numbers">
<code class="language-ruby">gem install zencoder-fetcher</code></pre>
</section>

<section id="Running_Fetcher" class="bcls-section">
<h2>Running Fetcher</h2>

<p>Grab your <a href="http://app.zencoder.com/api/">API key</a> so you can access your jobs.</p>

<pre class="line-numbers">
<code class="language-ruby">zencoder_fetcher YOUR_API_KEY</code></pre>

<p>This is the most basic request you can make, which will retrieve the 50 most recent notifications generated by Zencoder, then post them to http://localhost:3000.</p>
</section>

<section id="Test_URLs" class="bcls-section">
<h2>Test URLs</h2>

<p>If you don't have a server to post notifications to, you can use <code>http://zencoderfetcher/</code> for your <a href="/node/17881#notification-url">notification URL</a>.</p>

<p>This will create a successful notification for Fetcher to grab and post to your application.</p>
</section>

<section id="Other_Parameters" class="bcls-section">
<h2>Other Parameters</h2>

<p>Optional parameters include:</p>

<ul>
	<li><code>--url (-u)</code> specifies the URL to post the notifications</li>
	<li><code>--loop (-l)</code> indicates that the notifier should be run in a loop.</li>
	<li><code>--interval (-i)</code> specifies the number of seconds to wait between checks for new notifications if looping. The default is 60.</li>
	<li><code>--count (-c)</code> specifies the number of notifications to retrieve. The default is 50.</li>
	<li><code>--page (-p)</code> specifies the page to load. The default is 1.</li>
</ul>

<p>The notification sent is JSON, containing the follow information:</p>

<pre class="line-numbers">
<code class="language-json">{
"outputs": [
{
    "height": 120,
    "audio_sample_rate": 8000,
    "frame_rate": 8,
    "channels": "1",
    "duration_in_ms": 1920,
    "video_bitrate_in_kbps": 70,
    "video_codec": "h264",
    "format": "mpeg4",
    "audio_codec": "aac",
    "label": null,
    "file_size_in_bytes": 17938,
    "width": 160,
    "audio_bitrate_in_kbps": 9,
    "id": 235314,
    "total_bitrate_in_kbps": 79,
    "state": "finished",
    "url": "ftp://example.com/file.mp4",
    "md5_checksum": "7f106918e02a69466afa0ee014172496",
    "thumbnails": [
    {
        "label": "poster",
        "images": [{
            "url": "ftp://example.com/images/123.png",
            "format": "PNG",
            "file_size_bytes": 1273573,
            "dimensions": "1280x720"
        }]
    }
    ]
},
{
    "height": 120,
    "audio_sample_rate": 8000,
    "frame_rate": 8,
    "channels": "1",
    "duration_in_ms": 1920,
    "video_bitrate_in_kbps": 70,
    "video_codec": "h264",
    "format": "mpeg4",
    "audio_codec": "aac",
    "label": null,
    "file_size_in_bytes": 17938,
    "width": 160,
    "audio_bitrate_in_kbps": 9,
    "id": 235314,
    "total_bitrate_in_kbps": 79,
    "state": "finished",
    "url": "ftp://example.com/file.mp4",
    "md5_checksum": "7f106918e02a69466afa0ee014172496",
    "thumbnails": [
    {
        "label": "poster",
        "images": [{
            "url": "ftp://example.com/images/123.png",
            "format": "PNG",
            "file_size_bytes": 1273573,
            "dimensions": "1280x720"
        }]
    }
    ]
}
],
"job": {
    "created_at": "2011-09-27T04:20:10Z",
    "pass_through": null,
    "updated_at": "2011-09-27T04:21:18Z",
    "submitted_at": "2011-09-27T04:20:10Z",
    "id": 172151,
    "state": "finished"
},
"input": {
    "height": 120,
    "audio_sample_rate": 8000,
    "frame_rate": 8,
    "channels": "1",
    "duration_in_ms": 1552,
    "video_bitrate_in_kbps": 32,
    "video_codec": "mpeg4",
    "format": "mpeg4",
    "audio_codec": "aac",
    "file_size_in_bytes": 13960,
    "width": 160,
    "audio_bitrate_in_kbps": 9,
    "id": 172149,
    "state": "finished",
    "total_bitrate_in_kbps": 41,
    "md5_checksum": "7f106918e02a69466afa0ee014174143"
}
}</code></pre>
</section>

<section id="Be_Aware" class="bcls-section">
<h2>Be Aware</h2>

<p>Notifications via the fetcher are not filtered to notifications that haven't been sent before. If you have created 1 new job since your last request, and request 10, you'll get the last 10 jobs. Be sure to handle this in your application. You can also use this to your advantage when developing as you will not have to create a new job every time changes are made to your code.</p>
</section>
</article>
